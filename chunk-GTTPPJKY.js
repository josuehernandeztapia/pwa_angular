import{a as te}from"./chunk-PH3HD2HQ.js";import{a as Z}from"./chunk-O54BG3VU.js";import{k as A,m as $}from"./chunk-SCHFUJ5K.js";import{a as ee}from"./chunk-ULB2DFX5.js";import{b as O,c as s,d as H,e as R,h as B,i as U,l as Q,m as J,q as X,r as K,t as W,v as Y}from"./chunk-S2UEMBMO.js";import{Ea as l,Fa as f,R as k,Sa as c,Ua as m,Xb as z,Ya as i,Yb as N,Za as e,_a as u,bb as G,bc as L,cb as v,db as g,ea as T,f as D,ib as t,jb as p,kb as V,ma as C,na as y,oa as h,pa as I,sb as j}from"./chunk-5IDTUAMZ.js";import{g as q}from"./chunk-DM275RSA.js";function ie(r,d){r&1&&(i(0,"div",28),t(1,"El n\xFAmero de miembros es obligatorio"),e())}function ne(r,d){r&1&&(i(0,"div",28),t(1,"M\xEDnimo 5 miembros"),e())}function re(r,d){r&1&&(i(0,"div",28),t(1,"M\xE1ximo 50 miembros"),e())}function oe(r,d){r&1&&(i(0,"div",28),t(1,"El precio de unidad es obligatorio"),e())}function le(r,d){r&1&&(i(0,"div",28),t(1,"El m\xEDnimo es $500,000"),e())}function ae(r,d){r&1&&(i(0,"div",28),t(1,"El consumo promedio es obligatorio"),e())}function me(r,d){r&1&&(i(0,"div",28),t(1,"El m\xEDnimo es 200 litros/mes"),e())}function de(r,d){r&1&&(i(0,"div",28),t(1,"El sobreprecio es obligatorio"),e())}function se(r,d){r&1&&(i(0,"div",28),t(1,"El m\xEDnimo es $1.00/litro"),e())}function ce(r,d){r&1&&(i(0,"span"),t(1,"Generar Cotizaci\xF3n"),e())}function ue(r,d){r&1&&(i(0,"div",29),h(),i(1,"svg",30),u(2,"circle",31)(3,"path",32),e(),t(4," Generando... "),e())}function pe(r,d){if(r&1&&(i(0,"div",62)(1,"div")(2,"span",63),t(3),e(),i(4,"p",64),t(5),e()(),i(6,"span",65),t(7),e()()),r&2){let n=d.$implicit;l(3),p(n.title),l(2),p(n.description),l(2),V(" ",n.timeframe," ")}}function xe(r,d){if(r&1&&(i(0,"div",59)(1,"h3",41),t(2,"Cronograma de Financiamiento:"),e(),i(3,"div",60),c(4,pe,8,3,"div",61),e()()),r&2){let n=g(2);l(4),m("ngForOf",n.quotation.timeline.slice(0,6))}}function fe(r,d){if(r&1){let n=G();i(0,"div",5)(1,"h2",6)(2,"span",7),t(3,"2"),e(),t(4," Cotizaci\xF3n del Grupo "),e(),i(5,"div",33)(6,"div",34)(7,"div",35),t(8,"Miembros del Grupo"),e(),i(9,"div",36),t(10),e()(),i(11,"div",37)(12,"div",38),t(13,"Inversi\xF3n Total"),e(),i(14,"div",39),t(15),e()()(),i(16,"div",40)(17,"h3",41),t(18,"Por Miembro:"),e(),i(19,"div",42)(20,"div",43)(21,"span",44),t(22,"Precio de unidad:"),e(),i(23,"span",45),t(24),e()(),i(25,"div",43)(26,"span",44),t(27,"Enganche requerido:"),e(),i(28,"span",45),t(29),e()(),i(30,"div",43)(31,"span",44),t(32,"Financiamiento:"),e(),i(33,"span",45),t(34),e()(),i(35,"div",43)(36,"span",44),t(37,"Pago mensual est.:"),e(),i(38,"span",45),t(39),e()()()(),i(40,"div",46)(41,"h3",47)(42,"span",48),t(43,"\u{1F3AF}"),e(),t(44," Beneficios del Grupo: "),e(),i(45,"ul",49)(46,"li",29)(47,"span",50),t(48,"\u2713"),e(),t(49," Enganche reducido al 15% (vs 25% individual) "),e(),i(50,"li",29)(51,"span",50),t(52,"\u2713"),e(),t(53," Mejor tasa de inter\xE9s por volumen "),e(),i(54,"li",29)(55,"span",50),t(56,"\u2713"),e(),t(57," Gesti\xF3n centralizada de tr\xE1mites "),e(),i(58,"li",29)(59,"span",50),t(60,"\u2713"),e(),t(61," Descuentos por compra en volumen "),e()()(),c(62,xe,5,1,"div",51),i(63,"div",52)(64,"button",53),v("click",function(){C(n);let o=g();return y(o.proceedToClientCreation())}),h(),i(65,"svg",54),u(66,"path",55),e(),t(67," Crear Grupo de Clientes "),e(),I(),i(68,"button",56),v("click",function(){C(n);let o=g();return y(o.generatePDF())}),h(),i(69,"svg",54),u(70,"path",57),e(),t(71," Descargar PDF "),e(),I(),i(72,"button",58),v("click",function(){C(n);let o=g();return y(o.recalculate())}),t(73," Recalcular "),e()()()}if(r&2){let n=g();l(10),p(n.quotation.memberCount),l(5),p(n.formatCurrency(n.quotation.totalInvestment)),l(9),p(n.formatCurrency(n.quotation.unitPrice)),l(5),p(n.formatCurrency(n.quotation.downPaymentPerMember)),l(5),p(n.formatCurrency(n.quotation.financingPerMember)),l(5),p(n.formatCurrency(n.quotation.monthlyPaymentPerMember)),l(23),m("ngIf",n.quotation.timeline&&n.quotation.timeline.length>0)}}function ve(r,d){r&1&&(i(0,"div",5)(1,"h2",66)(2,"span",67),t(3,"\u{1F4A1}"),e(),t(4," Cotizaci\xF3n Colectiva EdoMex "),e(),i(5,"div",68)(6,"div",69)(7,"span",70),t(8,"\u{1F465}"),e(),i(9,"div")(10,"h3",63),t(11,"Grupos de 5-50 miembros"),e(),i(12,"p",71),t(13,"Mejor aprovechamiento con grupos de 10-20 transportistas"),e()()(),i(14,"div",69)(15,"span",70),t(16,"\u{1F4B0}"),e(),i(17,"div")(18,"h3",63),t(19,"Enganche reducido al 15%"),e(),i(20,"p",71),t(21,"Significativamente menor que la modalidad individual (25%)"),e()()(),i(22,"div",69)(23,"span",70),t(24,"\u{1F4C8}"),e(),i(25,"div")(26,"h3",63),t(27,"Mejores condiciones"),e(),i(28,"p",71),t(29,"Tasas de inter\xE9s preferenciales y descuentos por volumen"),e()()(),i(30,"div",69)(31,"span",70),t(32,"\u26A1"),e(),i(33,"div")(34,"h3",63),t(35,"Gesti\xF3n centralizada"),e(),i(36,"p",71),t(37,"Un solo punto de contacto para todo el grupo"),e()()()()())}var Me=(()=>{class r{constructor(n,a,o,x,b,E){this.fb=n,this.simuladorEngine=a,this.loadingService=o,this.financialCalc=x,this.router=b,this.route=E,this.destroy$=new D,this.quotation=null,this.isCalculating=!1,this.configForm=this.fb.group({memberCount:[10,[s.required,s.min(5),s.max(50)]],unitPrice:[749e3,[s.required,s.min(5e5)]],avgConsumption:[400,[s.required,s.min(200)]],overpricePerLiter:[3,[s.required,s.min(1)]],voluntaryMonthly:[0,[s.min(0)]]})}ngOnInit(){this.route.queryParams.pipe(k(this.destroy$)).subscribe(n=>{n.memberCount&&this.configForm.patchValue({memberCount:parseInt(n.memberCount)}),n.preCalculate==="true"&&setTimeout(()=>this.generateQuotation(),500)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}generateQuotation(){return q(this,null,function*(){if(!this.configForm.valid)return;let n=this.configForm.value;this.isCalculating=!0,this.loadingService.show("Generando cotizaci\xF3n colectiva...");try{let a={memberCount:n.memberCount,unitPrice:n.unitPrice,avgConsumption:n.avgConsumption,overpricePerLiter:n.overpricePerLiter,voluntaryMonthly:n.voluntaryMonthly||0},o=yield this.simuladorEngine.generateEdoMexCollectiveScenario(a);this.quotation={memberCount:a.memberCount,unitPrice:a.unitPrice,totalInvestment:a.unitPrice*a.memberCount,downPaymentPerMember:a.unitPrice*.15,financingPerMember:a.unitPrice*.85,monthlyPaymentPerMember:a.unitPrice*.85/60,scenario:o,timeline:[{title:"Constituci\xF3n del Grupo",description:"Reuni\xF3n inicial y firma de acuerdos",timeframe:"Semana 1"},{title:"Evaluaci\xF3n Crediticia",description:"An\xE1lisis de cada miembro del grupo",timeframe:"Semana 2-3"},{title:"Aprobaci\xF3n de Cr\xE9dito",description:"Resoluci\xF3n del financiamiento grupal",timeframe:"Semana 4"},{title:"Selecci\xF3n de Unidades",description:"Elecci\xF3n y reserva de veh\xEDculos",timeframe:"Semana 5-6"},{title:"Entrega Escalonada",description:"Entrega por fases seg\xFAn disponibilidad",timeframe:"Semana 7-10"}]},this.isCalculating=!1,this.loadingService.hide()}catch(a){console.error("Error generating quotation:",a),this.isCalculating=!1,this.loadingService.hide()}})}resetForm(){this.configForm.reset({memberCount:10,unitPrice:749e3,avgConsumption:400,overpricePerLiter:3,voluntaryMonthly:0}),this.quotation=null}recalculate(){this.quotation=null}proceedToClientCreation(){if(!this.quotation)return;let n={quotationData:{type:"EDOMEX_COLECTIVO",quotation:this.quotation,configParams:this.configForm.value}};sessionStorage.setItem("pendingClientData",JSON.stringify(n)),this.router.navigate(["/clientes/nuevo"],{queryParams:{fromCotizador:"edomex-colectivo",hasQuotation:"true",groupSize:this.quotation.memberCount}})}generatePDF(){if(!this.quotation)return;console.log("Generating PDF for collective quotation...");let n=`https://documents.conductores.mx/quotations/edomex-colectivo-${Date.now()}.pdf`,a=document.createElement("a");a.href=n,a.download=`cotizacion-edomex-colectivo-${this.quotation.memberCount}-miembros.pdf`,a.click()}formatCurrency(n){return this.financialCalc.formatCurrency(n)}static{this.\u0275fac=function(a){return new(a||r)(f(W),f(te),f(Z),f(ee),f($),f(A))}}static{this.\u0275cmp=T({type:r,selectors:[["app-edomex-colectivo"]],standalone:!0,features:[j],decls:75,vars:15,consts:[[1,"container","mx-auto","p-6","space-y-6"],[1,"bg-gradient-to-r","from-emerald-600","to-emerald-800","text-white","rounded-xl","p-6","shadow-lg"],[1,"text-3xl","font-bold","mb-2"],[1,"text-emerald-100","text-lg"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"bg-white","rounded-xl","shadow-lg","p-6"],[1,"text-xl","font-semibold","text-gray-800","mb-6","flex","items-center"],[1,"bg-emerald-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"space-y-6",3,"formGroup"],[1,"space-y-2"],[1,"block","text-sm","font-medium","text-gray-700"],["type","number","formControlName","memberCount","placeholder","10","min","5","max","50","step","1",1,"w-full","py-3","px-4","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-emerald-500","focus:border-transparent"],[1,"flex","justify-between","text-xs","text-gray-500"],["class","text-red-500 text-sm",4,"ngIf"],[1,"relative"],[1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-500"],["type","number","formControlName","unitPrice","placeholder","749000","min","500000","step","1000",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-emerald-500","focus:border-transparent"],[1,"text-xs","text-gray-500"],["type","number","formControlName","avgConsumption","placeholder","400","min","200","step","50",1,"w-full","pr-16","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-emerald-500","focus:border-transparent"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-500"],["type","number","formControlName","overpricePerLiter","placeholder","3.00","min","1.0","step","0.1",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-emerald-500","focus:border-transparent"],["type","number","formControlName","voluntaryMonthly","placeholder","0","min","0","step","100",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-emerald-500","focus:border-transparent"],[1,"flex","gap-4","pt-4"],["type","button",1,"flex-1","bg-emerald-600","hover:bg-emerald-700","disabled:bg-gray-400","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center",3,"click","disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],["type","button",1,"px-6","py-3","border","border-gray-300","text-gray-700","font-medium","rounded-lg","hover:bg-gray-50","transition-colors","duration-200",3,"click"],["class","bg-white rounded-xl shadow-lg p-6",4,"ngIf"],[1,"text-red-500","text-sm"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-4","mb-6"],[1,"bg-gradient-to-br","from-emerald-50","to-emerald-100","p-4","rounded-lg","border","border-emerald-200"],[1,"text-emerald-600","text-sm","font-medium"],[1,"text-2xl","font-bold","text-emerald-800"],[1,"bg-gradient-to-br","from-blue-50","to-blue-100","p-4","rounded-lg","border","border-blue-200"],[1,"text-blue-600","text-sm","font-medium"],[1,"text-2xl","font-bold","text-blue-800"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"font-semibold","text-gray-800","mb-3"],[1,"grid","grid-cols-2","gap-4","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"bg-amber-50","rounded-lg","p-4","mb-6","border","border-amber-200"],[1,"font-semibold","text-amber-800","mb-3","flex","items-center"],[1,"text-amber-600","mr-2"],[1,"space-y-2","text-sm","text-amber-700"],[1,"text-emerald-500","mr-2"],["class","mb-6",4,"ngIf"],[1,"flex","gap-4"],[1,"flex-1","bg-emerald-600","hover:bg-emerald-700","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"px-6","py-3","border","border-emerald-600","text-emerald-600","font-medium","rounded-lg","hover:bg-emerald-50","transition-colors","duration-200","flex","items-center",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"px-6","py-3","border","border-gray-300","text-gray-700","font-medium","rounded-lg","hover:bg-gray-50","transition-colors","duration-200",3,"click"],[1,"mb-6"],[1,"bg-gray-50","rounded-lg","p-4","max-h-48","overflow-y-auto"],["class","flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","py-2","border-b","border-gray-200","last:border-b-0"],[1,"font-medium","text-gray-800"],[1,"text-sm","text-gray-600"],[1,"text-sm","font-medium","text-emerald-600"],[1,"text-xl","font-semibold","text-gray-800","mb-4","flex","items-center"],[1,"bg-amber-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"space-y-4","text-gray-600"],[1,"flex","items-start","space-x-3"],[1,"bg-emerald-100","text-emerald-600","rounded-full","w-6","h-6","flex","items-center","justify-center","text-sm","font-bold","flex-shrink-0"],[1,"text-sm"]],template:function(a,o){if(a&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),t(3,"Cotizador EdoMex Colectivo"),e(),i(4,"p",3),t(5,"Genera cotizaciones para grupos de transportistas"),e()(),i(6,"div",4)(7,"div",5)(8,"h2",6)(9,"span",7),t(10,"1"),e(),t(11," Configuraci\xF3n del Grupo "),e(),i(12,"form",8)(13,"div",9)(14,"label",10),t(15," N\xFAmero de Miembros del Grupo * "),e(),u(16,"input",11),i(17,"div",12)(18,"span"),t(19,"M\xEDnimo: 5 miembros"),e(),i(20,"span"),t(21,"M\xE1ximo: 50 miembros"),e()(),c(22,ie,2,0,"div",13)(23,ne,2,0,"div",13)(24,re,2,0,"div",13),e(),i(25,"div",9)(26,"label",10),t(27," Precio de Unidad por Miembro * "),e(),i(28,"div",14)(29,"span",15),t(30,"$"),e(),u(31,"input",16),e(),i(32,"p",17),t(33,"Precio promedio de unidad que cada miembro desea adquirir"),e(),c(34,oe,2,0,"div",13)(35,le,2,0,"div",13),e(),i(36,"div",9)(37,"label",10),t(38," Consumo Promedio por Miembro * "),e(),i(39,"div",14),u(40,"input",18),i(41,"span",19),t(42,"litros/mes"),e()(),i(43,"p",17),t(44,"Consumo mensual promedio de combustible por miembro"),e(),c(45,ae,2,0,"div",13)(46,me,2,0,"div",13),e(),i(47,"div",9)(48,"label",10),t(49," Sobreprecio por Litro * "),e(),i(50,"div",14)(51,"span",15),t(52,"$"),e(),u(53,"input",20),e(),i(54,"p",17),t(55,"Sobreprecio aplicado para generar el ahorro colectivo"),e(),c(56,de,2,0,"div",13)(57,se,2,0,"div",13),e(),i(58,"div",9)(59,"label",10),t(60," Aportaci\xF3n Voluntaria Mensual por Miembro (Opcional) "),e(),i(61,"div",14)(62,"span",15),t(63,"$"),e(),u(64,"input",21),e(),i(65,"p",17),t(66,"Dinero adicional mensual que cada miembro puede aportar"),e()(),i(67,"div",22)(68,"button",23),v("click",function(){return o.generateQuotation()}),c(69,ce,2,0,"span",24)(70,ue,5,0,"div",25),e(),i(71,"button",26),v("click",function(){return o.resetForm()}),t(72," Limpiar "),e()()()(),c(73,fe,74,7,"div",27)(74,ve,38,0,"div",27),e()()),a&2){let x,b,E,_,S,w,F,M,P;l(12),m("formGroup",o.configForm),l(10),m("ngIf",(x=o.configForm.get("memberCount"))==null||x.errors==null?null:x.errors.required),l(),m("ngIf",(b=o.configForm.get("memberCount"))==null||b.errors==null?null:b.errors.min),l(),m("ngIf",(E=o.configForm.get("memberCount"))==null||E.errors==null?null:E.errors.max),l(10),m("ngIf",(_=o.configForm.get("unitPrice"))==null||_.errors==null?null:_.errors.required),l(),m("ngIf",(S=o.configForm.get("unitPrice"))==null||S.errors==null?null:S.errors.min),l(10),m("ngIf",(w=o.configForm.get("avgConsumption"))==null||w.errors==null?null:w.errors.required),l(),m("ngIf",(F=o.configForm.get("avgConsumption"))==null||F.errors==null?null:F.errors.min),l(10),m("ngIf",(M=o.configForm.get("overpricePerLiter"))==null||M.errors==null?null:M.errors.required),l(),m("ngIf",(P=o.configForm.get("overpricePerLiter"))==null||P.errors==null?null:P.errors.min),l(11),m("disabled",!o.configForm.valid||o.isCalculating),l(),m("ngIf",!o.isCalculating),l(),m("ngIf",o.isCalculating),l(3),m("ngIf",o.quotation),l(),m("ngIf",!o.quotation)}},dependencies:[L,z,N,Y,B,O,U,H,R,K,X,Q,J],encapsulation:2})}}return r})();export{Me as EdomexColectivoComponent};
