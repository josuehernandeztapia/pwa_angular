import{b as ie}from"./chunk-DYOXCRTF.js";import"./chunk-O54BG3VU.js";import{a as k}from"./chunk-X4AKXSKX.js";import"./chunk-NH6JDP7H.js";import"./chunk-XIPGL6BB.js";import{k as Z,m as R,p as G}from"./chunk-SCHFUJ5K.js";import"./chunk-YYSQDTD3.js";import"./chunk-QCEAPM7G.js";import{b as U,c as y,d as $,e as K,h as J,l as Y,m as W,n as H,o as Q,p as X,s as ee,t as te,v as ne}from"./chunk-S2UEMBMO.js";import{$b as L,C as P,Ea as l,Fa as S,H as T,Q as D,Sa as d,Ua as c,Va as w,Wa as x,Xb as q,Ya as n,Yb as B,Za as t,_a as b,bb as C,bc as j,cb as u,db as p,ea as F,ib as i,j as I,jb as f,kb as g,lb as N,ma as h,na as _,sb as V,vb as z,xb as A}from"./chunk-5IDTUAMZ.js";import{a as E,b as M}from"./chunk-DM275RSA.js";function oe(a,s){if(a&1&&(n(0,"span",50),i(1),t()),a&2){let e=p(2);l(),g(" \u{1F4CD} ",e.getMarketName(e.smartContext.market)," ")}}function ae(a,s){if(a&1&&(n(0,"span",50),i(1),t()),a&2){let e=p(2);l(),g(" \u{1F3AF} ",e.smartContext.suggestedFlow==="COTIZACION"?"Sugerido: Cotizador":"Sugerido: Simulador"," ")}}function re(a,s){if(a&1&&(n(0,"div",48),d(1,oe,2,1,"span",49)(2,ae,2,1,"span",49),t()),a&2){let e=p();l(),c("ngIf",e.smartContext.market),l(),c("ngIf",e.smartContext.suggestedFlow)}}function le(a,s){if(a&1&&(n(0,"span",55),i(1),z(2,"number"),t()),a&2){let e=p(2);l(),g(" (",A(2,1,e.currentStepProgress*100,"1.0-0"),"%) ")}}function se(a,s){if(a&1&&(n(0,"span",51)(1,"span",52),i(2),t(),n(3,"span",53),i(4),t(),d(5,le,3,4,"span",54),t()),a&2){let e=s.$implicit,o=s.index,r=p();x("active",r.getStepStatus(o)==="current")("completed",r.getStepStatus(o)==="completed")("pending",r.getStepStatus(o)==="pending"),l(2),f(r.getStepIcon(o)),l(2),f(e.label),l(),c("ngIf",r.getStepStatus(o)==="current"&&r.currentStepProgress>0)}}function ce(a,s){if(a&1){let e=C();n(0,"div",56)(1,"div",57)(2,"span",58),i(3,"\u{1F4BE}"),t(),n(4,"div",59)(5,"strong"),i(6,"Borrador encontrado"),t(),n(7,"p"),i(8),t()(),n(9,"div",60)(10,"button",61),u("click",function(){h(e);let r=p();return _(r.recoverDraft())}),i(11,"Continuar"),t(),n(12,"button",62),u("click",function(){h(e);let r=p();return _(r.discardDraft())}),i(13,"Descartar"),t()()()()}if(a&2){let e=p();l(8),g("Tienes una oportunidad sin terminar del ",e.formatDraftDate(e.draftData.timestamp),"")}}function pe(a,s){a&1&&(n(0,"div",63)(1,"span",64),i(2,"\u{1F50D}"),t()())}function de(a,s){if(a&1&&(n(0,"span",78),i(1),t()),a&2){let e=p().$implicit;l(),g("\u{1F4DE} ",e.phone,"")}}function me(a,s){if(a&1&&(n(0,"span",78),i(1),t()),a&2){let e=p().$implicit;l(),g("\u{1F3E2} ",e.market,"")}}function ue(a,s){if(a&1){let e=C();n(0,"div",71),u("click",function(){let r=h(e).$implicit,m=p(2);return _(m.selectSuggestion(r))})("mouseenter",function(){let r=h(e).index,m=p(2);return _(m.selectedSuggestionIndex=r)}),n(1,"div",72)(2,"div",73),i(3),t(),n(4,"div",74),d(5,de,2,1,"span",75)(6,me,2,1,"span",75),n(7,"span",76),i(8),t()()(),n(9,"span",77),i(10,"\u2192"),t()()}if(a&2){let e=s.$implicit,o=s.index,r=p(2);x("highlighted",o===r.selectedSuggestionIndex),l(3),f(e.name),l(2),c("ngIf",e.phone),l(),c("ngIf",e.market),l(2),f(e.type)}}function ge(a,s){a&1&&(n(0,"div",79)(1,"span",80),i(2,"Use \u2191\u2193 para navegar, Enter para seleccionar"),t()())}function fe(a,s){if(a&1&&(n(0,"div",65)(1,"div",66)(2,"span",67),i(3,"\u{1F4A1}"),t(),n(4,"strong"),i(5,"Sugerencias inteligentes"),t()(),n(6,"div",68),d(7,ue,11,6,"div",69),t(),d(8,ge,3,0,"div",70),t()),a&2){let e=p();l(7),c("ngForOf",e.clientSuggestions)("ngForTrackBy",e.trackBySuggestion),l(),c("ngIf",!e.isCheckingDuplicates)}}function ve(a,s){if(a&1){let e=C();n(0,"div",88),u("click",function(){let r=h(e).$implicit,m=p(2);return _(m.selectSimilarClient(r))}),n(1,"div",89),i(2),t(),n(3,"div",90)(4,"div",91),i(5),t(),n(6,"div",92),i(7),t()(),n(8,"button",93),i(9,"Usar este cliente"),t()()}if(a&2){let e=s.$implicit,o=p(2);l(2),f(o.getClientInitials(e.name)),l(3),f(e.name),l(2),N("",e.phone||"Sin tel\xE9fono"," \u2022 ",e.market||"Sin mercado","")}}function xe(a,s){if(a&1){let e=C();n(0,"div",81)(1,"div",82)(2,"span",83),i(3,"\u26A0\uFE0F"),t(),n(4,"strong"),i(5,"Clientes similares encontrados"),t()(),n(6,"div",84),d(7,ve,10,4,"div",85),t(),n(8,"div",86)(9,"button",87),u("click",function(){h(e);let r=p();return _(r.clearSimilarClients())}),i(10," Continuar con cliente nuevo "),t()()()}if(a&2){let e=p();l(7),c("ngForOf",e.similarClients)}}function he(a,s){a&1&&(n(0,"span"),i(1," El nombre del cliente es requerido "),t())}function _e(a,s){if(a&1&&(n(0,"span"),i(1),t()),a&2){let e,o=p(2);l(),g(" ",(e=o.opportunityForm.get("clientName"))==null||e.errors==null||e.errors.clientName==null?null:e.errors.clientName.message," ")}}function Ce(a,s){if(a&1&&(n(0,"div",94),d(1,he,2,0,"span",95)(2,_e,2,1,"span",95),t()),a&2){let e,o,r=p();l(),c("ngIf",(e=r.opportunityForm.get("clientName"))==null||e.errors==null?null:e.errors.required),l(),c("ngIf",(o=r.opportunityForm.get("clientName"))==null||o.errors==null?null:o.errors.clientName)}}function ye(a,s){a&1&&(n(0,"span"),i(1," El n\xFAmero de WhatsApp es requerido para contacto "),t())}function Se(a,s){a&1&&(n(0,"span"),i(1," Formato inv\xE1lido. Ej: 55 1234 5678 "),t())}function be(a,s){if(a&1&&(n(0,"div",94),d(1,ye,2,0,"span",95)(2,Se,2,0,"span",95),t()),a&2){let e,o,r=p();l(),c("ngIf",(e=r.opportunityForm.get("phone"))==null||e.errors==null?null:e.errors.required),l(),c("ngIf",(o=r.opportunityForm.get("phone"))==null||o.errors==null?null:o.errors.mexicanPhone)}}function Ee(a,s){a&1&&(n(0,"span"),i(1," Formato de email inv\xE1lido "),t())}function Oe(a,s){if(a&1&&(n(0,"div",94),d(1,Ee,2,0,"span",95),t()),a&2){let e,o=p();l(),c("ngIf",(e=o.opportunityForm.get("email"))==null||e.errors==null?null:e.errors.email)}}function ke(a,s){a&1&&(n(0,"div",94),i(1," Debe seleccionar un tipo de oportunidad "),t())}function Me(a,s){a&1&&(n(0,"span"),i(1," El mercado es requerido "),t())}function Ie(a,s){if(a&1&&(n(0,"div",94),d(1,Me,2,0,"span",95),t()),a&2){let e,o=p(2);l(),c("ngIf",(e=o.opportunityForm.get("market"))==null||e.errors==null?null:e.errors.required)}}function Pe(a,s){a&1&&(n(0,"span"),i(1," El municipio es requerido para Estado de M\xE9xico "),t())}function Te(a,s){if(a&1&&(n(0,"div",94),d(1,Pe,2,0,"span",95),t()),a&2){let e,o=p(3);l(),c("ngIf",(e=o.opportunityForm.get("municipality"))==null||e.errors==null?null:e.errors.required)}}function De(a,s){if(a&1&&(n(0,"div",15)(1,"label",108),i(2,"Municipio *"),t(),n(3,"select",109)(4,"option",99),i(5,"Seleccionar municipio..."),t(),n(6,"optgroup",110)(7,"option",111),i(8,"Ecatepec de Morelos"),t(),n(9,"option",112),i(10,"Ciudad Nezahualc\xF3yotl"),t(),n(11,"option",113),i(12,"Naucalpan de Ju\xE1rez"),t(),n(13,"option",114),i(14,"Tlalnepantla de Baz"),t(),n(15,"option",115),i(16,"Chimalhuac\xE1n"),t(),n(17,"option",116),i(18,"Valle de Chalco Solidaridad"),t(),n(19,"option",117),i(20,"La Paz"),t(),n(21,"option",118),i(22,"Ixtapaluca"),t(),n(23,"option",119),i(24,"Coacalco de Berrioz\xE1bal"),t(),n(25,"option",120),i(26,"Tultitl\xE1n"),t(),n(27,"option",121),i(28,"Cuautitl\xE1n Izcalli"),t(),n(29,"option",122),i(30,"Atizap\xE1n de Zaragoza"),t()(),n(31,"optgroup",123)(32,"option",124),i(33,"Toluca de Lerdo"),t(),n(34,"option",125),i(35,"Metepec"),t(),n(36,"option",126),i(37,"Lerma"),t(),n(38,"option",127),i(39,"Zinacantepec"),t(),n(40,"option",128),i(41,"Almoloya de Ju\xE1rez"),t()(),n(42,"optgroup",129)(43,"option",130),i(44,"Texcoco"),t(),n(45,"option",131),i(46,"Chalco"),t(),n(47,"option",132),i(48,"Chicoloapan"),t()(),n(49,"optgroup",133)(50,"option",134),i(51,"Tepotzotl\xE1n"),t(),n(52,"option",135),i(53,"Villa Nicol\xE1s Romero"),t(),n(54,"option",136),i(55,"Isidro Fabela"),t()(),n(56,"optgroup",137)(57,"option",138),i(58,"Valle de Bravo"),t(),n(59,"option",139),i(60,"Temascaltepec"),t(),n(61,"option",140),i(62,"Tejupilco"),t()()(),d(63,Te,2,1,"div",22),t()),a&2){let e=p(2);l(3),x("error",e.isFieldInvalid("municipality")),l(60),c("ngIf",e.isFieldInvalid("municipality"))}}function Fe(a,s){a&1&&(n(0,"span"),i(1," El tipo de cliente es requerido "),t())}function we(a,s){if(a&1&&(n(0,"div",94),d(1,Fe,2,0,"span",95),t()),a&2){let e,o=p(2);l(),c("ngIf",(e=o.opportunityForm.get("clientType"))==null||e.errors==null?null:e.errors.required)}}function Ne(a,s){if(a&1&&(n(0,"div",141)(1,"div",142),i(2,"\u2139\uFE0F"),t(),n(3,"div",143)(4,"h4"),i(5,"Flujo de Negocio Sugerido"),t(),n(6,"p")(7,"strong"),i(8),t(),i(9),t()()()),a&2){let e=p(2);l(8),f(e.getBusinessFlowLabel()),l(),g(" - ",e.getBusinessFlowDescription()," ")}}function Ve(a,s){if(a&1){let e=C();n(0,"div",14)(1,"h2"),i(2),t(),n(3,"p",35),i(4),t(),n(5,"div",96)(6,"div",15)(7,"label",97),i(8,"Mercado *"),t(),n(9,"select",98),u("change",function(){h(e);let r=p();return _(r.onMarketChange())}),n(10,"option",99),i(11,"Seleccionar mercado..."),t(),n(12,"option",100),i(13,"\u{1F335} Aguascalientes"),t(),n(14,"option",101),i(15,"\u{1F3D4}\uFE0F Estado de M\xE9xico"),t()(),d(16,Ie,2,1,"div",22),t(),d(17,De,64,3,"div",102),n(18,"div",15)(19,"label",103),i(20,"Tipo de Cliente *"),t(),n(21,"select",104)(22,"option",99),i(23,"Seleccionar tipo..."),t(),n(24,"option",105),i(25,"\u{1F464} Individual"),t(),n(26,"option",106),i(27,"\u{1F465} Colectivo (Tanda)"),t()(),d(28,we,2,1,"div",22),t()(),d(29,Ne,10,2,"div",107),t()}if(a&2){let e=p();l(2),f(e.getMarketStepTitle()),l(2),f(e.getMarketStepDescription()),l(5),x("error",e.isFieldInvalid("market")),l(7),c("ngIf",e.isFieldInvalid("market")),l(),c("ngIf",e.marketValue==="edomex"),l(4),x("error",e.isFieldInvalid("clientType")),l(7),c("ngIf",e.isFieldInvalid("clientType")),l(),c("ngIf",e.marketValue&&e.clientTypeValue)}}function ze(a,s){if(a&1){let e=C();n(0,"div",146),u("click",function(){let r=h(e).$implicit,m=p(2);return _(m.selectEcosystem(r.id))}),n(1,"div",147),i(2),t(),n(3,"div",148)(4,"h3"),i(5),t(),n(6,"p"),i(7),t(),n(8,"div",149)(9,"span",150),i(10),t(),n(11,"span",150),i(12),t()()()()}if(a&2){let e=s.$implicit,o=p(2);x("selected",o.selectedEcosystem===e.id),l(2),f(e.icon),l(3),f(e.name),l(2),f(e.description),l(3),g("",e.activeClients," activos"),l(2),g("",e.avgSavings,"% ahorro promedio")}}function Ae(a,s){if(a&1&&(n(0,"div",14)(1,"h2"),i(2,"\u{1F3EA} Selecci\xF3n de Ecosistema"),t(),n(3,"p",35),i(4," En Estado de M\xE9xico, los clientes se organizan por ecosistemas territoriales "),t(),n(5,"div",144),d(6,ze,13,7,"div",145),t()()),a&2){let e=p();l(6),c("ngForOf",e.getAvailableEcosystems())}}function qe(a,s){a&1&&(n(0,"div",14)(1,"h2"),i(2,"\u{1F4DD} Notas Adicionales"),t(),n(3,"div",15)(4,"label",151),i(5,"Observaciones"),t(),b(6,"textarea",152),t()())}function Be(a,s){if(a&1&&(n(0,"span"),i(1),t()),a&2){let e=p(2);l(),g(" ",e.opportunityType==="COTIZACION"?"\u{1F4B0} Continuar a Cotizador":"\u{1F3AF} Continuar a Simulador"," ")}}function Le(a,s){a&1&&(n(0,"span",157),i(1," \u23F3 Procesando... "),t())}function je(a,s){if(a&1){let e=C();n(0,"div",153)(1,"button",154),u("click",function(){h(e);let r=p();return _(r.saveDraft())}),i(2," \u{1F4C4} Guardar Borrador "),t(),n(3,"button",155),d(4,Be,2,1,"span",95)(5,Le,2,0,"span",156),t()()}if(a&2){let e=p();l(),c("disabled",e.isLoading),l(2),c("disabled",e.opportunityForm.invalid||e.isLoading),l(),c("ngIf",!e.isLoading),l(),c("ngIf",e.isLoading)}}var Xe=(()=>{class a{constructor(e,o,r,m){this.fb=e,this.router=o,this.route=r,this.apiService=m,this.opportunityType=null,this.opportunityTypeError=!1,this.isLoading=!1,this.smartContext={market:void 0,suggestedFlow:void 0,timestamp:void 0,returnContext:void 0},this.currentStep=1,this.totalSteps=4,this.visibleSteps=[],this.hasDraftAvailable=!1,this.draftRecovered=!1,this.draftData=null,this.draftKey="nueva-oportunidad-draft",this.isCheckingDuplicates=!1,this.similarClients=[],this.clientSuggestions=[],this.showSuggestions=!1,this.selectedSuggestionIndex=-1,this.selectedEcosystem="",this.availableEcosystems=[]}ngOnInit(){this.loadSmartContext(),this.checkForDrafts(),this.initializeForm(),this.setupDuplicateDetection(),this.initializeDynamicSteps(),this.startAutoSave()}ngOnDestroy(){this.autoSaveInterval&&clearInterval(this.autoSaveInterval)}loadSmartContext(){this.route.queryParams.subscribe(e=>{this.smartContext={market:e.market,suggestedFlow:e.suggestedFlow,timestamp:e.timestamp,returnContext:e.returnContext},this.smartContext.suggestedFlow&&!this.opportunityType&&(this.opportunityType=this.smartContext.suggestedFlow,this.updateCurrentStep())})}checkForDrafts(){let e=localStorage.getItem(this.draftKey);if(e)try{this.draftData=JSON.parse(e),Date.now()-this.draftData.timestamp<24*60*60*1e3?this.hasDraftAvailable=!0:localStorage.removeItem(this.draftKey)}catch(o){console.error("Error parsing draft:",o),localStorage.removeItem(this.draftKey)}}initializeForm(){this.opportunityForm=this.fb.group({clientName:["",[y.required,k.clientName]],phone:["",[y.required,k.mexicanPhone]],email:["",[y.email]],market:[this.smartContext.market||"",[y.required]],municipality:[""],clientType:["",[y.required]],ecosystem:[""],notes:[""]}),this.opportunityForm.valueChanges.subscribe(()=>{this.recalculateSteps(),this.updateCurrentStep()})}initializeDynamicSteps(){this.recalculateSteps()}recalculateSteps(){let e=this.marketValue,o=this.clientTypeValue,r=this.opportunityType,m=[{id:"client-info",label:"Cliente",required:!0,visible:!0,completed:this.isStepCompleted("client-info"),validationFields:["clientName","phone"]},{id:"opportunity-type",label:"Tipo",required:!0,visible:!0,completed:this.isStepCompleted("opportunity-type"),validationFields:[]}],v=[];e==="aguascalientes"&&o==="Individual"?v.push({id:"market-simple",label:"Configuraci\xF3n",required:!0,visible:!0,completed:this.isStepCompleted("market-simple"),validationFields:["market","clientType"]}):e==="edomex"?(v.push({id:"market-full",label:"Mercado",required:!0,visible:!0,completed:this.isStepCompleted("market-full"),validationFields:["market","clientType"]}),o&&v.push({id:"ecosystem",label:"Ecosistema",required:!0,visible:!0,completed:this.isStepCompleted("ecosystem"),validationFields:["ecosystem"]})):v.push({id:"market-default",label:"Mercado",required:!0,visible:!0,completed:this.isStepCompleted("market-default"),validationFields:["market","clientType"]});let O=[{id:"confirmation",label:"Confirmar",required:!0,visible:!0,completed:this.isStepCompleted("confirmation"),validationFields:[]}];this.visibleSteps=[...m,...v,...O],this.totalSteps=this.visibleSteps.length}isStepCompleted(e){switch(e){case"client-info":return this.validateClientInfo();case"opportunity-type":return this.validateOpportunityType();case"market-simple":case"market-full":case"market-default":return this.validateMarketConfiguration();case"ecosystem":return this.validateEcosystemSelection();case"confirmation":return this.opportunityForm.valid&&!!this.opportunityType;default:return!1}}validateClientInfo(){let e=this.opportunityForm.get("clientName"),o=this.opportunityForm.get("phone");return!(!e?.value||!e.valid||!o?.value||!o.valid)}validateOpportunityType(){return this.opportunityType?(this.marketValue==="edomex"&&this.clientTypeValue==="Individual"&&this.opportunityType==="COTIZACION"&&console.warn("EdoMex Individual clients typically use Simulacion flow"),this.marketValue==="aguascalientes"&&this.opportunityType==="SIMULACION"&&console.info("AGS clients often prefer Cotizacion for faster processing"),!0):!1}validateMarketConfiguration(){let e=this.marketValue,o=this.clientTypeValue;return!e||!o?!1:e==="aguascalientes"?["Individual","Colectivo"].includes(o):e==="edomex"?["Individual","Colectivo"].includes(o):!1}validateEcosystemSelection(){if(this.marketValue!=="edomex")return!0;let e=this.opportunityForm.get("ecosystem")?.value;return e?["comercial","industrial","residencial"].includes(e):!1}setupDuplicateDetection(){this.opportunityForm.get("clientName")?.valueChanges.pipe(P(500),T(),D(e=>e&&e.length>=3?(this.isCheckingDuplicates=!0,this.apiService.searchClients(e)):I([]))).subscribe({next:e=>{this.similarClients=e.slice(0,3),this.isCheckingDuplicates=!1},error:e=>{console.error("Error searching clients:",e),this.isCheckingDuplicates=!1,this.similarClients=[]}})}startAutoSave(){this.autoSaveInterval=setInterval(()=>{this.opportunityForm.dirty&&!this.draftRecovered&&this.saveDraftToStorage()},1e4)}saveDraftToStorage(){let e={formData:this.opportunityForm.value,opportunityType:this.opportunityType,smartContext:this.smartContext,timestamp:Date.now(),currentStep:this.currentStep};localStorage.setItem(this.draftKey,JSON.stringify(e))}isFieldInvalid(e){let o=this.opportunityForm.get(e);return!!(o&&o.invalid&&(o.dirty||o.touched))}selectOpportunityType(e){this.opportunityType=e,this.opportunityTypeError=!1}getBusinessFlowLabel(){let e=this.marketValue,o=this.clientTypeValue;return this.opportunityType==="COTIZACION"?"Venta a Plazo":o==="Individual"?"Plan de Ahorro":"Cr\xE9dito Colectivo"}getBusinessFlowDescription(){let e=this.marketValue,o=this.clientTypeValue;return this.opportunityType==="COTIZACION"?`Cotizaci\xF3n para financiamiento en ${e==="aguascalientes"?"Aguascalientes":"Estado de M\xE9xico"}`:o==="Individual"?"Simulaci\xF3n de ahorro individual para alcanzar enganche necesario":"Simulaci\xF3n de tanda colectiva con efecto bola de nieve"}get clientNameValue(){return this.opportunityForm.get("clientName")?.value||""}get marketValue(){return this.opportunityForm.get("market")?.value||""}get clientTypeValue(){return this.opportunityForm.get("clientType")?.value||""}get municipalityValue(){return this.opportunityForm.get("municipality")?.value||""}getMarketName(e){return{aguascalientes:"Aguascalientes",edomex:"Estado de M\xE9xico"}[e]||e}onMarketChange(){let e=this.marketValue;this.opportunityForm.get("municipality")?.setValue(""),e==="edomex"?this.opportunityForm.get("municipality")?.setValidators([y.required]):this.opportunityForm.get("municipality")?.clearValidators(),this.opportunityForm.get("municipality")?.updateValueAndValidity()}shouldShowStep(e){let o=this.marketValue,r=this.clientTypeValue,m=this.opportunityType;switch(e){case"market":return!!m;case"ecosystem":return o==="edomex"&&!!r;default:return!0}}getMarketStepTitle(){let e=this.marketValue,o=this.clientTypeValue;return e==="aguascalientes"&&o==="Individual"?"\u26A1 Configuraci\xF3n R\xE1pida":e==="edomex"?"\u{1F3D4}\uFE0F Configuraci\xF3n Estado de M\xE9xico":"\u{1F4CD} Configuraci\xF3n del Mercado"}getMarketStepDescription(){let e=this.marketValue,o=this.clientTypeValue;return e==="aguascalientes"&&o==="Individual"?"Configuraci\xF3n simplificada para Aguascalientes Individual":e==="edomex"?"Configuraci\xF3n completa requerida para Estado de M\xE9xico":"Selecciona el mercado y tipo de cliente para continuar"}getAvailableEcosystems(){return[{id:"centro",name:"Centro Hist\xF3rico",description:"Zona c\xE9ntrica con alta actividad comercial",icon:"\u{1F3DB}\uFE0F",activeClients:45,avgSavings:85},{id:"industrial",name:"Zona Industrial",description:"\xC1rea industrial con empresas manufactureras",icon:"\u{1F3ED}",activeClients:32,avgSavings:78},{id:"residencial",name:"Zona Residencial",description:"\xC1rea residencial con familias trabajadoras",icon:"\u{1F3D8}\uFE0F",activeClients:28,avgSavings:92}]}selectEcosystem(e){this.selectedEcosystem=e,this.opportunityForm.patchValue({ecosystem:e}),this.recalculateSteps()}getProgressPercentage(){return this.calculateDynamicProgress()}calculateDynamicProgress(){let e=this.visibleSteps.filter(O=>O.completed).length,o=this.visibleSteps.length;if(o===0)return 0;let r=this.getCurrentStepProgress(),m=e/o*100,v=r*(100/o);return Math.min(m+v,100)}get currentStepProgress(){return this.getCurrentStepProgress()}getCurrentStepProgress(){let e=this.visibleSteps[this.currentStep-1];if(!e||e.completed)return 0;let o=e.validationFields||[];return o.length===0?0:o.filter(m=>{let v=this.opportunityForm.get(m);return v?.value&&v.valid}).length/o.length}updateCurrentStep(){let e=this.visibleSteps.findIndex(o=>!o.completed);e===-1?this.currentStep=this.visibleSteps.length:this.currentStep=e+1,this.totalSteps=this.visibleSteps.length}getStepStatus(e){let o=this.visibleSteps[e];return o?o.completed?"completed":e+1===this.currentStep?"current":e+1<this.currentStep?"completed":"pending":"pending"}getStepIcon(e){let o=this.getStepStatus(e),r=this.visibleSteps[e];switch(o){case"completed":return"\u2705";case"current":return r?.icon||"\u23F3";default:return r?.icon||"\u2B55"}}formatDraftDate(e){return new Date(e).toLocaleDateString("es-MX",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}recoverDraft(){this.draftData&&(this.opportunityForm.patchValue(this.draftData.formData),this.opportunityType=this.draftData.opportunityType,this.currentStep=this.draftData.currentStep,this.draftRecovered=!0,this.hasDraftAvailable=!1,this.smartContext=E(E({},this.draftData.smartContext),this.smartContext))}discardDraft(){localStorage.removeItem(this.draftKey),this.hasDraftAvailable=!1,this.draftData=null}getClientInitials(e){return e.split(" ").map(o=>o.charAt(0)).slice(0,2).join("").toUpperCase()}selectSimilarClient(e){this.opportunityForm.patchValue({clientName:e.name,phone:e.phone||"",email:e.email||"",market:e.market||this.smartContext.market||""}),this.similarClients=[],this.currentStep=2}clearSimilarClients(){this.similarClients=[]}saveDraft(){this.saveDraftToStorage(),console.log("Draft saved locally and will sync with backend")}onSubmit(){if(!this.opportunityType){this.opportunityTypeError=!0;return}if(this.opportunityForm.valid){this.isLoading=!0,this.currentStep=4;let e=M(E({},this.opportunityForm.value),{opportunityType:this.opportunityType,businessFlow:this.getBusinessFlowLabel(),smartContext:this.smartContext,createdAt:new Date,source:"nueva-oportunidad-wizard",advisorContext:{dashboardFilter:this.smartContext.market,suggestedFlow:this.smartContext.suggestedFlow,createdFromContext:this.smartContext.returnContext}});this.apiService.createClient(e).subscribe({next:o=>{console.log("Client created successfully:",o),localStorage.removeItem(this.draftKey),this.navigateToNextStep(o)},error:o=>{console.error("Error creating client:",o),this.isLoading=!1}})}else{Object.keys(this.opportunityForm.controls).forEach(o=>{this.opportunityForm.get(o)?.markAsTouched()});let e=Object.keys(this.opportunityForm.controls).find(o=>this.opportunityForm.get(o)?.invalid);if(e){let o=document.getElementById(e);o?.focus(),o?.scrollIntoView({behavior:"smooth",block:"center"})}}}navigateToNextStep(e){let o={clientId:e?.id,clientName:this.clientNameValue,source:"nueva-oportunidad",smartContext:this.smartContext};this.opportunityType==="COTIZACION"?this.marketValue==="aguascalientes"&&this.clientTypeValue==="Individual"?this.router.navigate(["/cotizador/ags-individual"],{queryParams:o}):this.marketValue==="edomex"&&this.clientTypeValue==="Colectivo"?this.router.navigate(["/cotizador/edomex-colectivo"],{queryParams:o}):this.router.navigate(["/cotizador"],{queryParams:o}):this.marketValue==="aguascalientes"?this.router.navigate(["/simulador/ags-ahorro"],{queryParams:o}):this.clientTypeValue==="Individual"?this.router.navigate(["/simulador/edomex-individual"],{queryParams:o}):this.router.navigate(["/simulador/tanda-colectiva"],{queryParams:o}),this.isLoading=!1}onClientNameFocus(){this.generateClientSuggestions(),this.showSuggestions=!0,this.selectedSuggestionIndex=-1}onClientNameBlur(){this.suggestionTimeout=setTimeout(()=>{this.showSuggestions=!1,this.selectedSuggestionIndex=-1},150)}handleClientNameKeydown(e){if(!(!this.showSuggestions||this.clientSuggestions.length===0))switch(e.key){case"ArrowDown":e.preventDefault(),this.selectedSuggestionIndex=Math.min(this.selectedSuggestionIndex+1,this.clientSuggestions.length-1);break;case"ArrowUp":e.preventDefault(),this.selectedSuggestionIndex=Math.max(this.selectedSuggestionIndex-1,0);break;case"Enter":e.preventDefault(),this.selectedSuggestionIndex>=0&&this.selectedSuggestionIndex<this.clientSuggestions.length&&this.selectSuggestion(this.clientSuggestions[this.selectedSuggestionIndex]);break;case"Escape":this.showSuggestions=!1,this.selectedSuggestionIndex=-1;break}}generateClientSuggestions(){let e=this.clientNameValue.toLowerCase().trim();this.clientSuggestions=[],this.smartContext.market==="aguascalientes"?this.clientSuggestions.push({name:"Mar\xEDa Gonz\xE1lez Hern\xE1ndez",phone:"449-123-4567",market:"AGS",type:"\u{1F4CA} Cotizaci\xF3n recurrente"},{name:"Carlos L\xF3pez Torres",phone:"449-234-5678",market:"AGS",type:"\u{1F4B0} Cliente premium"},{name:"Ana Patricia Morales",phone:"449-345-6789",market:"AGS",type:"\u{1F3AF} Simulaci\xF3n activa"}):this.smartContext.market==="edomex"&&this.clientSuggestions.push({name:"Roberto S\xE1nchez Mart\xEDnez",phone:"55-9876-5432",market:"EdoMex",type:"\u{1F3E2} Cliente corporativo"},{name:"Laura Jim\xE9nez Ruiz",phone:"55-8765-4321",market:"EdoMex",type:"\u{1F465} Cliente familiar"},{name:"Miguel \xC1ngel Torres",phone:"55-7654-3210",market:"EdoMex",type:"\u{1F697} Renovaci\xF3n pendiente"}),e.length>=2&&(this.clientSuggestions=this.clientSuggestions.filter(o=>o.name.toLowerCase().includes(e)||o.name.toLowerCase().split(" ").some(r=>r.startsWith(e)))),e.length>=3&&this.clientSuggestions.unshift({name:this.formatSuggestionName(e),type:"\u2728 Completar autom\xE1ticamente"}),this.clientSuggestions=this.clientSuggestions.slice(0,5)}formatSuggestionName(e){return e.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" ")}selectSuggestion(e){this.suggestionTimeout&&clearTimeout(this.suggestionTimeout),this.opportunityForm.patchValue({clientName:e.name,phone:e.phone||"",market:e.market||this.smartContext.market||this.opportunityForm.get("market")?.value}),this.showSuggestions=!1,this.selectedSuggestionIndex=-1,this.recalculateSteps()}trackBySuggestion(e,o){return o.name+o.type}goBack(){this.router.navigate(["/dashboard"])}static{this.\u0275fac=function(o){return new(o||a)(S(te),S(R),S(Z),S(ie))}}static{this.\u0275cmp=F({type:a,selectors:[["app-nueva-oportunidad"]],standalone:!0,features:[V],decls:125,vars:37,consts:[[1,"nueva-oportunidad-container"],[1,"header-section"],[1,"breadcrumb"],[1,"back-btn",3,"click"],["class","smart-context",4,"ngIf"],[1,"subtitle"],[1,"progress-indicator"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-steps"],["class","step",3,"active","completed","pending",4,"ngFor","ngForOf"],["class","draft-banner",4,"ngIf"],[1,"form-container"],[1,"opportunity-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"form-group"],["for","clientName"],[1,"smart-input-container"],["id","clientName","type","text","formControlName","clientName","placeholder","Ej: Juan P\xE9rez Garc\xEDa","autocomplete","off",1,"form-input",3,"focus","blur","keydown"],["class","input-status",4,"ngIf"],["class","autocomplete-dropdown",4,"ngIf"],["class","similar-clients-warning",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"form-row","priority-contact"],[1,"form-group","primary-contact"],["for","phone",1,"primary-label"],[1,"contact-priority"],[1,"whatsapp-input"],[1,"country-prefix"],["id","phone","type","tel","formControlName","phone","placeholder","55 1234 5678","maxlength","12",1,"form-input","whatsapp-field"],[1,"whatsapp-icon"],[1,"form-group","secondary-contact"],["for","email",1,"secondary-label"],[1,"contact-optional"],["id","email","type","email","formControlName","email","placeholder","cliente@correo.com",1,"form-input","email-field"],[1,"section-description"],[1,"opportunity-cards"],[1,"opportunity-card",3,"click"],[1,"card-icon"],[1,"card-content"],[1,"card-tag"],["class","form-section",4,"ngIf"],["class","form-actions",4,"ngIf"],[1,"helper-sidebar"],[1,"helper-card"],[1,"helper-section"],[1,"market-comparison"],[1,"market-item"],[1,"smart-context"],["class","context-tag",4,"ngIf"],[1,"context-tag"],[1,"step"],[1,"step-icon"],[1,"step-label"],["class","step-progress",4,"ngIf"],[1,"step-progress"],[1,"draft-banner"],[1,"banner-content"],[1,"banner-icon"],[1,"banner-text"],[1,"banner-actions"],[1,"btn-link",3,"click"],[1,"btn-link","secondary",3,"click"],[1,"input-status"],[1,"checking-icon"],[1,"autocomplete-dropdown"],[1,"suggestion-header"],[1,"suggestion-icon"],[1,"suggestions-list"],["class","suggestion-item",3,"highlighted","click","mouseenter",4,"ngFor","ngForOf","ngForTrackBy"],["class","suggestion-footer",4,"ngIf"],[1,"suggestion-item",3,"click","mouseenter"],[1,"suggestion-content"],[1,"suggestion-name"],[1,"suggestion-details"],["class","detail-item",4,"ngIf"],[1,"detail-item","suggestion-type"],[1,"select-arrow"],[1,"detail-item"],[1,"suggestion-footer"],[1,"suggestion-hint"],[1,"similar-clients-warning"],[1,"warning-header"],[1,"warning-icon"],[1,"similar-clients-list"],["class","similar-client-item",3,"click",4,"ngFor","ngForOf"],[1,"continue-anyway"],["type","button",1,"btn-link",3,"click"],[1,"similar-client-item",3,"click"],[1,"client-avatar"],[1,"client-info"],[1,"client-name"],[1,"client-details"],["type","button",1,"btn-use-client"],[1,"error-message"],[4,"ngIf"],[1,"form-row"],["for","market"],["id","market","formControlName","market",1,"form-select",3,"change"],["value",""],["value","aguascalientes"],["value","edomex"],["class","form-group",4,"ngIf"],["for","clientType"],["id","clientType","formControlName","clientType",1,"form-select"],["value","Individual"],["value","Colectivo"],["class","info-card",4,"ngIf"],["for","municipality"],["id","municipality","formControlName","municipality",1,"form-select"],["label","Zona Metropolitana"],["value","ecatepec"],["value","nezahualcoyotl"],["value","naucalpan"],["value","tlalnepantla"],["value","chimalhuacan"],["value","valle_chalco"],["value","la_paz"],["value","ixtapaluca"],["value","coacalco"],["value","tultitlan"],["value","cuautitlan_izcalli"],["value","atizapan"],["label","Zona Central"],["value","toluca"],["value","metepec"],["value","lerma"],["value","zinacantepec"],["value","almoloya_juarez"],["label","Zona Oriente"],["value","texcoco"],["value","chalco"],["value","chicoloapan"],["label","Zona Norte"],["value","tepotzotlan"],["value","villa_nicolas_romero"],["value","isidro_fabela"],["label","Zona Sur"],["value","valle_bravo"],["value","temascaltepec"],["value","tejupilco"],[1,"info-card"],[1,"info-icon"],[1,"info-content"],[1,"ecosystem-cards"],["class","ecosystem-card",3,"selected","click",4,"ngFor","ngForOf"],[1,"ecosystem-card",3,"click"],[1,"ecosystem-icon"],[1,"ecosystem-content"],[1,"ecosystem-stats"],[1,"stat"],["for","notes"],["id","notes","formControlName","notes","rows","4","placeholder","Informaci\xF3n adicional sobre el cliente o la oportunidad...",1,"form-textarea"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click","disabled"],["type","submit",1,"btn-primary",3,"disabled"],["class","loading",4,"ngIf"],[1,"loading"]],template:function(o,r){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),u("click",function(){return r.goBack()}),i(4," \u2B05\uFE0F Regresar "),t(),n(5,"h1"),i(6,"\u2795 Nueva Oportunidad"),t(),d(7,re,3,2,"div",4),t(),n(8,"p",5),i(9),t(),n(10,"div",6)(11,"div",7),b(12,"div",8),t(),n(13,"div",9),d(14,se,6,9,"span",10),t()(),d(15,ce,14,1,"div",11),t(),n(16,"div",12)(17,"form",13),u("ngSubmit",function(){return r.onSubmit()}),n(18,"div",14)(19,"h2"),i(20,"\u{1F464} Informaci\xF3n del Cliente"),t(),n(21,"div",15)(22,"label",16),i(23,"Nombre Completo *"),t(),n(24,"div",17)(25,"input",18),u("focus",function(){return r.onClientNameFocus()})("blur",function(){return r.onClientNameBlur()})("keydown",function(v){return r.handleClientNameKeydown(v)}),t(),d(26,pe,3,0,"div",19)(27,fe,9,3,"div",20),t(),d(28,xe,11,1,"div",21)(29,Ce,3,2,"div",22),t(),n(30,"div",23)(31,"div",24)(32,"label",25),i(33," \u{1F4F1} WhatsApp * "),n(34,"span",26),i(35,"Principal v\xEDa de contacto"),t()(),n(36,"div",27)(37,"span",28),i(38,"\u{1F1F2}\u{1F1FD} +52"),t(),b(39,"input",29),n(40,"span",30),i(41,"\u{1F4AC}"),t()(),d(42,be,3,2,"div",22),t(),n(43,"div",31)(44,"label",32),i(45," \u{1F4E7} Email "),n(46,"span",33),i(47,"Opcional"),t()(),b(48,"input",34),d(49,Oe,2,1,"div",22),t()()(),n(50,"div",14)(51,"h2"),i(52),t(),n(53,"p",35),i(54," Selecciona el tipo de oportunidad que mejor se adapte a las necesidades del cliente "),t(),n(55,"div",36)(56,"div",37),u("click",function(){return r.selectOpportunityType("COTIZACION")}),n(57,"div",38),i(58,"\u{1F4B0}"),t(),n(59,"div",39)(60,"h3"),i(61,"Adquisici\xF3n de Unidad"),t(),n(62,"p"),i(63,"Cliente listo para comprar. Generar cotizaci\xF3n r\xE1pida y transparente."),t(),n(64,"div",40),i(65,"Modo Cotizador"),t()()(),n(66,"div",37),u("click",function(){return r.selectOpportunityType("SIMULACION")}),n(67,"div",38),i(68,"\u{1F3AF}"),t(),n(69,"div",39)(70,"h3"),i(71,"Plan de Ahorro"),t(),n(72,"p"),i(73,"Modelar capacidad de ahorro y proyecciones financieras."),t(),n(74,"div",40),i(75,"Modo Simulador"),t()()()(),d(76,ke,2,0,"div",22),t(),d(77,Ve,30,10,"div",41)(78,Ae,7,1,"div",41)(79,qe,7,0,"div",41)(80,je,6,4,"div",42),t(),n(81,"div",43)(82,"div",44)(83,"h3"),i(84,"\u{1F4A1} Gu\xEDa R\xE1pida"),t(),n(85,"div",45)(86,"h4"),i(87,"\u{1F3AF} \xBFCu\xE1ndo usar Cotizador?"),t(),n(88,"ul")(89,"li"),i(90,"Cliente con decisi\xF3n de compra"),t(),n(91,"li"),i(92,"Tiene claridad sobre enganche"),t(),n(93,"li"),i(94,"Necesita informaci\xF3n de pagos"),t()()(),n(95,"div",45)(96,"h4"),i(97,"\u{1F4CA} \xBFCu\xE1ndo usar Simulador?"),t(),n(98,"ul")(99,"li"),i(100,"Cliente explora opciones"),t(),n(101,"li"),i(102,"Necesita planear ahorro"),t(),n(103,"li"),i(104,"Quiere ver proyecciones"),t()()(),n(105,"div",45)(106,"h4"),i(107,"\u{1F3EA} Diferencias por Mercado"),t(),n(108,"div",46)(109,"div",47)(110,"strong"),i(111,"Aguascalientes:"),t(),n(112,"span"),i(113,"Plazos: 12-24 meses"),t(),n(114,"span"),i(115,"Enganche: 20% m\xEDn."),t()(),n(116,"div",47)(117,"strong"),i(118,"Estado de M\xE9xico:"),t(),n(119,"span"),i(120,"Plazos: 48-60 meses"),t(),n(121,"span"),i(122,"Individual: 25% m\xEDn."),t(),n(123,"span"),i(124,"Colectivo: 15% m\xEDn."),t()()()()()()()()),o&2&&(l(7),c("ngIf",r.smartContext.market||r.smartContext.suggestedFlow),l(2),g(" ",r.smartContext.market?"Creando oportunidad para "+r.getMarketName(r.smartContext.market)+" con contexto inteligente del Dashboard":"El primer paso para ayudar a un transportista a obtener su unidad"," "),l(3),w("width",r.getProgressPercentage(),"%"),l(2),c("ngForOf",r.visibleSteps),l(),c("ngIf",r.hasDraftAvailable&&!r.draftRecovered),l(2),c("formGroup",r.opportunityForm),l(8),x("error",r.isFieldInvalid("clientName"))("checking",r.isCheckingDuplicates)("has-suggestions",r.clientSuggestions.length>0),l(),c("ngIf",r.isCheckingDuplicates),l(),c("ngIf",r.showSuggestions&&r.clientSuggestions.length>0),l(),c("ngIf",r.similarClients.length>0),l(),c("ngIf",r.isFieldInvalid("clientName")),l(10),x("error",r.isFieldInvalid("phone")),l(3),c("ngIf",r.isFieldInvalid("phone")),l(6),x("error",r.isFieldInvalid("email")),l(),c("ngIf",r.isFieldInvalid("email")),l(3),g("\u{1F3AF} \xBFQu\xE9 quieres modelar para ",r.clientNameValue||"este cliente","?"),l(4),x("selected",r.opportunityType==="COTIZACION")("suggested",r.smartContext.suggestedFlow==="COTIZACION"),l(10),x("selected",r.opportunityType==="SIMULACION")("suggested",r.smartContext.suggestedFlow==="SIMULACION"),l(10),c("ngIf",r.opportunityTypeError),l(),c("ngIf",r.opportunityType&&r.shouldShowStep("market")),l(),c("ngIf",r.shouldShowStep("ecosystem")),l(),c("ngIf",r.opportunityType&&r.marketValue),l(),c("ngIf",r.opportunityType))},dependencies:[j,q,B,L,ne,J,Q,X,U,H,$,K,ee,Y,W,G],styles:['@charset "UTF-8";.nueva-oportunidad-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f7fafc,#edf2f7);padding:20px}.header-section[_ngcontent-%COMP%]{margin-bottom:32px}.breadcrumb[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:12px}.back-btn[_ngcontent-%COMP%]{background:#ffffffe6;border:1px solid #e2e8f0;padding:8px 16px;border-radius:8px;cursor:pointer;font-size:.9rem;color:#4a5568;transition:all .2s}.back-btn[_ngcontent-%COMP%]:hover{background:#fff;box-shadow:0 2px 8px #0000001a}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#2d3748;font-size:2.5rem;font-weight:700}.subtitle[_ngcontent-%COMP%]{color:#718096;font-size:1.1rem;margin:0}.form-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 300px;gap:32px;max-width:1200px;margin:0 auto}.opportunity-form[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:32px;box-shadow:0 4px 20px #00000014}.form-section[_ngcontent-%COMP%]{margin-bottom:40px;padding-bottom:32px;border-bottom:1px solid #e2e8f0}.form-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2d3748;font-size:1.5rem;font-weight:600;margin:0 0 16px}.section-description[_ngcontent-%COMP%]{color:#718096;margin:0 0 24px;font-size:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:24px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#2d3748;font-size:.95rem}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:8px;font-size:1rem;transition:all .2s;background:#f7fafc}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4299e1;background:#fff;box-shadow:0 0 0 3px #4299e11a}.form-input.error[_ngcontent-%COMP%], .form-select.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%]{border-color:#e53e3e;background:#fed7d7}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.error-message[_ngcontent-%COMP%]{color:#e53e3e;font-size:.85rem;margin-top:6px;display:flex;align-items:center;gap:4px}.opportunity-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px}.opportunity-card[_ngcontent-%COMP%]{border:2px solid #e2e8f0;border-radius:12px;padding:24px;cursor:pointer;transition:all .3s;background:#fff;position:relative;overflow:hidden}.opportunity-card[_ngcontent-%COMP%]:hover{border-color:#4299e1;transform:translateY(-2px);box-shadow:0 8px 25px #4299e126}.opportunity-card.selected[_ngcontent-%COMP%]{border-color:#4299e1;background:linear-gradient(135deg,#ebf8ff,#f0f9ff);box-shadow:0 8px 25px #4299e133}.card-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:16px}.card-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;color:#2d3748;font-size:1.3rem;font-weight:600}.card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 16px;color:#718096;line-height:1.5}.card-tag[_ngcontent-%COMP%]{background:#4299e1;color:#fff;padding:6px 12px;border-radius:16px;font-size:.8rem;font-weight:600;display:inline-block}.info-card[_ngcontent-%COMP%]{display:flex;gap:16px;background:#f0f9ff;border:1px solid #bee3f8;border-radius:12px;padding:20px;margin-top:16px}.info-icon[_ngcontent-%COMP%]{font-size:1.5rem;flex-shrink:0}.info-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#2b6cb0;font-size:1rem;font-weight:600}.info-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#2c5282;line-height:1.5}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;margin-top:32px;padding-top:24px;border-top:1px solid #e2e8f0}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:14px 28px;border:none;border-radius:10px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4299e1,#3182ce);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#3182ce,#2c5282);transform:translateY(-2px);box-shadow:0 8px 25px #4299e14d}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn-secondary[_ngcontent-%COMP%]{background:#f7fafc;color:#4a5568;border:2px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#edf2f7;border-color:#cbd5e0}.loading[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.helper-sidebar[_ngcontent-%COMP%]{position:sticky;top:20px;height:fit-content}.helper-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;box-shadow:0 4px 20px #00000014}.helper-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 24px;color:#2d3748;font-size:1.3rem;font-weight:600}.helper-section[_ngcontent-%COMP%]{margin-bottom:24px}.helper-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#4a5568;font-size:1rem;font-weight:600}.helper-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding:0 0 0 20px;color:#718096;font-size:.9rem}.helper-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:6px}.market-comparison[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.market-item[_ngcontent-%COMP%]{background:#f7fafc;padding:12px;border-radius:8px;border-left:4px solid #4299e1}.market-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#2d3748;margin-bottom:6px}.market-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;color:#718096;font-size:.85rem;margin-bottom:2px}.smart-context[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:12px}.context-tag[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4299e1,#3182ce);color:#fff;padding:6px 14px;border-radius:20px;font-size:.85rem;font-weight:500;display:inline-flex;align-items:center;gap:6px}.progress-indicator[_ngcontent-%COMP%]{background:#fffffff2;border-radius:12px;padding:16px;margin:20px 0;box-shadow:0 2px 8px #0000001a}.progress-bar[_ngcontent-%COMP%]{width:100%;height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden;margin-bottom:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#4299e1,#3182ce);border-radius:3px;transition:width .5s ease}.progress-steps[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.85rem}.step[_ngcontent-%COMP%]{color:#718096;font-weight:500;transition:color .3s}.step.completed[_ngcontent-%COMP%]{color:#48bb78;font-weight:600}.step.active[_ngcontent-%COMP%]{color:#4299e1;font-weight:600}.draft-banner[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fef5e7,#fed7aa);border:1px solid #f6ad55;border-radius:12px;padding:16px;margin:16px 0}.banner-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.banner-icon[_ngcontent-%COMP%]{font-size:1.5rem;flex-shrink:0}.banner-text[_ngcontent-%COMP%]{flex:1}.banner-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#c05621;font-size:1rem}.banner-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#9c4221;margin:4px 0 0;font-size:.9rem}.banner-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#4299e1;text-decoration:underline;cursor:pointer;font-size:.9rem;font-weight:600}.btn-link.secondary[_ngcontent-%COMP%]{color:#718096}.smart-input-container[_ngcontent-%COMP%]{position:relative}.form-input.checking[_ngcontent-%COMP%]{border-color:#f6ad55;background:#fef5e7}.input-status[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%)}.checking-icon[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.similar-clients-warning[_ngcontent-%COMP%]{background:#fef5e7;border:1px solid #f6ad55;border-radius:12px;padding:16px;margin-top:12px}.warning-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:16px}.warning-icon[_ngcontent-%COMP%]{font-size:1.2rem}.warning-header[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#c05621;font-size:1rem}.similar-clients-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.similar-client-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:#fff;border:1px solid #fed7aa;border-radius:8px;padding:12px;cursor:pointer;transition:all .2s}.similar-client-item[_ngcontent-%COMP%]:hover{border-color:#f6ad55;transform:translateY(-1px);box-shadow:0 4px 12px #f6ad5533}.client-avatar[_ngcontent-%COMP%]{width:40px;height:40px;background:linear-gradient(135deg,#4299e1,#3182ce);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px;flex-shrink:0}.client-info[_ngcontent-%COMP%]{flex:1}.client-name[_ngcontent-%COMP%]{font-weight:600;color:#2d3748;margin-bottom:2px}.client-details[_ngcontent-%COMP%]{font-size:.85rem;color:#718096}.btn-use-client[_ngcontent-%COMP%]{background:#4299e1;color:#fff;border:none;border-radius:6px;padding:8px 16px;font-size:.85rem;font-weight:500;cursor:pointer;transition:background .2s}.btn-use-client[_ngcontent-%COMP%]:hover{background:#3182ce}.continue-anyway[_ngcontent-%COMP%]{text-align:center;padding-top:12px;border-top:1px solid #fed7aa}.opportunity-card.selected[_ngcontent-%COMP%]:before{content:"\\2713";position:absolute;top:16px;right:16px;width:24px;height:24px;background:#48bb78;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:14px}.opportunity-card.suggested[_ngcontent-%COMP%]:after{content:"\\1f3af  Sugerido";position:absolute;top:-8px;left:16px;background:linear-gradient(135deg,#f6ad55,#ed8936);color:#fff;padding:4px 12px;border-radius:12px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}@media (max-width: 1024px){.form-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.helper-sidebar[_ngcontent-%COMP%]{position:static;order:-1}.progress-steps[_ngcontent-%COMP%]{font-size:.75rem}.similar-clients-list[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto}}@media (max-width: 768px){.nueva-oportunidad-container[_ngcontent-%COMP%]{padding:16px}.opportunity-form[_ngcontent-%COMP%]{padding:24px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.opportunity-cards[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{width:100%;justify-content:center}}']})}}return a})();export{Xe as NuevaOportunidadComponent};
