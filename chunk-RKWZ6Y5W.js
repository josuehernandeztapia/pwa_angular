import{b as j}from"./chunk-DYOXCRTF.js";import"./chunk-O54BG3VU.js";import{a as b}from"./chunk-X4AKXSKX.js";import"./chunk-NH6JDP7H.js";import"./chunk-XIPGL6BB.js";import{k as P,m as I}from"./chunk-SCHFUJ5K.js";import{a as A}from"./chunk-YYSQDTD3.js";import"./chunk-QCEAPM7G.js";import{b as y,c,d as O,e as k,h as w,l as N,m as T,n as D,o as z,p as V,t as L,v as q}from"./chunk-S2UEMBMO.js";import{Ea as l,Fa as u,Sa as m,Ua as d,Wa as p,Ya as t,Yb as S,Za as e,_a as g,bc as M,cb as v,db as _,ea as x,ib as n,jb as E,kb as h,sb as F}from"./chunk-5IDTUAMZ.js";import"./chunk-DM275RSA.js";function G(r,s){r&1&&(t(0,"div",37),n(1," Nombre completo es requerido "),e())}function R(r,s){r&1&&(t(0,"span"),n(1," Correo es requerido "),e())}function B(r,s){r&1&&(t(0,"span"),n(1," Formato de correo inv\xE1lido "),e())}function X(r,s){if(r&1&&(t(0,"div",37),m(1,R,2,0,"span",38)(2,B,2,0,"span",38),e()),r&2){let a,i,o=_();l(),d("ngIf",(a=o.clienteForm.get("email"))==null||a.errors==null?null:a.errors.required),l(),d("ngIf",(i=o.clienteForm.get("email"))==null||i.errors==null?null:i.errors.email)}}function J(r,s){r&1&&(t(0,"div",37),n(1," Tel\xE9fono es requerido "),e())}function U(r,s){r&1&&(t(0,"div",37),n(1," RFC inv\xE1lido "),e())}function H(r,s){r&1&&(t(0,"div",37),n(1," Mercado es requerido "),e())}function K(r,s){r&1&&(t(0,"div",37),n(1," Tipo de producto es requerido "),e())}var oe=(()=>{class r{constructor(a,i,o,f,C){this.fb=a,this.router=i,this.route=o,this.apiService=f,this.toast=C,this.isEditMode=!1,this.isLoading=!1}ngOnInit(){this.createForm(),this.checkEditMode()}createForm(){this.clienteForm=this.fb.group({name:["",[c.required,c.minLength(2)]],email:["",[c.required,c.email]],phone:["",[c.required,b.mexicanPhone]],rfc:["",[b.rfc]],market:["",[c.required]],flow:["",[c.required]],notes:[""]})}checkEditMode(){this.clientId=this.route.snapshot.params.id,this.clientId&&(this.isEditMode=!0,this.loadClient(this.clientId))}loadClient(a){this.isLoading=!0,this.apiService.getClientById(a).subscribe({next:i=>{i&&this.clienteForm.patchValue({name:i.name,email:i.email,phone:i.phone,rfc:i.rfc||"",market:i.market,flow:i.flow,notes:""}),this.isLoading=!1},error:i=>{this.toast.error("Error al cargar el cliente"),this.isLoading=!1,this.router.navigate(["/clientes"])}})}onSubmit(){if(this.clienteForm.invalid){this.markFormGroupTouched(),this.toast.error("Por favor, corrige los errores en el formulario");return}this.isLoading=!0;let a=this.clienteForm.value;this.isEditMode&&this.clientId?this.apiService.updateClient(this.clientId,a).subscribe({next:i=>{this.toast.success("Cliente actualizado correctamente"),this.isLoading=!1,this.router.navigate(["/clientes"])},error:i=>{this.toast.error("Error al actualizar el cliente"),this.isLoading=!1}}):this.apiService.createClient(a).subscribe({next:i=>{this.toast.success("Cliente creado correctamente"),this.isLoading=!1,this.router.navigate(["/clientes"])},error:i=>{this.toast.error("Error al crear el cliente"),this.isLoading=!1}})}createClient(){this.isEditMode=!1,this.onSubmit()}updateClient(){this.isEditMode=!0,this.onSubmit()}onMarketChange(a){this.clienteForm.patchValue({market:a})}onRfcInput(a){let i=a.target.value.toUpperCase();this.clienteForm.patchValue({rfc:i})}isFieldInvalid(a){let i=this.clienteForm.get(a);return!!(i&&i.invalid&&(i.dirty||i.touched))}markFormGroupTouched(){Object.keys(this.clienteForm.controls).forEach(a=>{this.clienteForm.get(a)?.markAsTouched()})}goBack(){this.router.navigate(["/clientes"])}static{this.\u0275fac=function(i){return new(i||r)(u(L),u(I),u(P),u(j),u(A))}}static{this.\u0275cmp=x({type:r,selectors:[["app-cliente-form"]],standalone:!0,features:[F],decls:76,vars:23,consts:[[1,"cliente-form-container"],[1,"form-header"],[1,"breadcrumb"],[1,"back-button",3,"click"],[1,"separator"],[1,"current"],[1,"page-title"],[1,"cliente-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-row"],[1,"form-group"],["for","name"],["id","name","type","text","formControlName","name","placeholder","Ej. Juan P\xE9rez Garc\xEDa",1,"form-input"],["class","error-message",4,"ngIf"],["for","email"],["id","email","type","email","formControlName","email","placeholder","juan@ejemplo.com",1,"form-input"],["for","phone"],["id","phone","type","tel","formControlName","phone","placeholder","5555555555",1,"form-input"],["for","rfc"],["id","rfc","type","text","formControlName","rfc","placeholder","XAXX010101000",1,"form-input",3,"input"],["for","market"],["id","market","formControlName","market",1,"form-select"],["value",""],["value","aguascalientes"],["value","edomex"],["for","flow"],["id","flow","formControlName","flow",1,"form-select"],["value","Venta a Plazo"],["value","Plan de Ahorro"],["value","Cr\xE9dito Colectivo"],["value","Venta Directa"],["for","notes"],["id","notes","formControlName","notes","rows","3","placeholder","Informaci\xF3n adicional sobre el cliente...",1,"form-textarea"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"error-message"],[4,"ngIf"]],template:function(i,o){i&1&&(t(0,"div",0)(1,"header",1)(2,"div",2)(3,"button",3),v("click",function(){return o.goBack()}),n(4,"\u2190 Volver"),e(),t(5,"span",4),n(6,"/"),e(),t(7,"span",5),n(8),e()(),t(9,"h1",6),n(10),e()(),t(11,"form",7),v("ngSubmit",function(){return o.onSubmit()}),t(12,"section",8)(13,"h2",9),n(14,"\u{1F464} Informaci\xF3n Personal"),e(),t(15,"div",10)(16,"div",11)(17,"label",12),n(18,"Nombre Completo *"),e(),g(19,"input",13),m(20,G,2,0,"div",14),e(),t(21,"div",11)(22,"label",15),n(23,"Correo Electr\xF3nico *"),e(),g(24,"input",16),m(25,X,3,2,"div",14),e()(),t(26,"div",10)(27,"div",11)(28,"label",17),n(29,"Tel\xE9fono *"),e(),g(30,"input",18),m(31,J,2,0,"div",14),e(),t(32,"div",11)(33,"label",19),n(34,"RFC"),e(),t(35,"input",20),v("input",function(C){return o.onRfcInput(C)}),e(),m(36,U,2,0,"div",14),e()()(),t(37,"section",8)(38,"h2",9),n(39,"\u{1F690} Informaci\xF3n de Negocio"),e(),t(40,"div",10)(41,"div",11)(42,"label",21),n(43,"Mercado *"),e(),t(44,"select",22)(45,"option",23),n(46,"Seleccionar mercado"),e(),t(47,"option",24),n(48,"Aguascalientes"),e(),t(49,"option",25),n(50,"Estado de M\xE9xico"),e()(),m(51,H,2,0,"div",14),e(),t(52,"div",11)(53,"label",26),n(54,"Tipo de Producto *"),e(),t(55,"select",27)(56,"option",23),n(57,"Seleccionar producto"),e(),t(58,"option",28),n(59,"Venta a Plazo"),e(),t(60,"option",29),n(61,"Plan de Ahorro"),e(),t(62,"option",30),n(63,"Cr\xE9dito Colectivo"),e(),t(64,"option",31),n(65,"Venta Directa"),e()(),m(66,K,2,0,"div",14),e()(),t(67,"div",11)(68,"label",32),n(69,"Notas Adicionales"),e(),g(70,"textarea",33),e()(),t(71,"div",34)(72,"button",35),v("click",function(){return o.goBack()}),n(73," Cancelar "),e(),t(74,"button",36),n(75),e()()()()),i&2&&(l(8),E(o.isEditMode?"Editar Cliente":"Nuevo Cliente"),l(2),h(" ",o.isEditMode?"\u270F\uFE0F Editar Cliente":"\u2795 Nuevo Cliente"," "),l(),d("formGroup",o.clienteForm),l(8),p("error",o.isFieldInvalid("name")),l(),d("ngIf",o.isFieldInvalid("name")),l(4),p("error",o.isFieldInvalid("email")),l(),d("ngIf",o.isFieldInvalid("email")),l(5),p("error",o.isFieldInvalid("phone")),l(),d("ngIf",o.isFieldInvalid("phone")),l(4),p("error",o.isFieldInvalid("rfc")),l(),d("ngIf",o.isFieldInvalid("rfc")),l(8),p("error",o.isFieldInvalid("market")),l(7),d("ngIf",o.isFieldInvalid("market")),l(4),p("error",o.isFieldInvalid("flow")),l(11),d("ngIf",o.isFieldInvalid("flow")),l(8),d("disabled",o.isLoading||o.clienteForm.invalid),l(),h(" ",o.isLoading?"Guardando...":o.isEditMode?"Actualizar":"Crear Cliente"," "))},dependencies:[M,S,q,w,z,V,y,D,O,k,N,T],styles:[".cliente-form-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:24px}.form-header[_ngcontent-%COMP%]{margin-bottom:32px}.breadcrumb[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:16px;font-size:14px;color:#6b7280}.back-button[_ngcontent-%COMP%]{color:#3b82f6;text-decoration:none;padding:4px 8px;border-radius:4px;border:none;background:none;cursor:pointer;transition:background-color .2s}.back-button[_ngcontent-%COMP%]:hover{background:#f3f4f6}.separator[_ngcontent-%COMP%]{color:#9ca3af}.page-title[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#111827;margin:0}.cliente-form[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;padding:32px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.section-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#374151;margin-bottom:16px;padding-bottom:8px;border-bottom:2px solid #f3f4f6}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}label[_ngcontent-%COMP%]{font-weight:500;color:#374151;font-size:14px}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:16px;transition:border-color .2s,box-shadow .2s}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-input.error[_ngcontent-%COMP%], .form-select.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%]{border-color:#ef4444}.error-message[_ngcontent-%COMP%]{color:#ef4444;font-size:12px;margin-top:4px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:16px;justify-content:flex-end;padding-top:24px;border-top:1px solid #e5e7eb;margin-top:32px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:12px 24px;border-radius:8px;font-weight:600;font-size:14px;cursor:pointer;transition:all .2s;border:none}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return r})();export{oe as ClienteFormComponent};
