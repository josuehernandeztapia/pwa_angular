import{a as xe,b as he}from"./chunk-DFQSZCRA.js";import{a as Se,b as Ce}from"./chunk-AU7HQ5J5.js";import"./chunk-XIPGL6BB.js";import{m as fe}from"./chunk-SCHFUJ5K.js";import{a as x,b as u}from"./chunk-QCEAPM7G.js";import{t as ge,v as ve}from"./chunk-S2UEMBMO.js";import{Ea as l,Fa as V,G as T,R as H,Sa as C,Ua as p,V as U,Va as J,Wa as b,Xa as le,Xb as ue,Ya as r,Yb as me,Za as a,_ as re,_a as k,bb as N,bc as pe,cb as I,db as v,ea as se,f as oe,g as ae,ib as c,j as O,jb as M,kb as F,lb as X,ma as y,na as E,oa as ce,sb as de,va as K}from"./chunk-5IDTUAMZ.js";import{a as R,b as ne,f as Ae,g as w}from"./chunk-DM275RSA.js";var Re=[{id:"1",name:"INE Vigente",status:u.Pendiente},{id:"2",name:"Comprobante de domicilio",status:u.Pendiente},{id:"3",name:"Constancia de situaci\xF3n fiscal",status:u.Pendiente}],be=[{id:"1",name:"INE Vigente",status:u.Pendiente},{id:"2",name:"Comprobante de domicilio",status:u.Pendiente},{id:"3",name:"Tarjeta de circulaci\xF3n",status:u.Pendiente},{id:"4",name:"Copia de la concesi\xF3n",status:u.Pendiente},{id:"5",name:"Constancia de situaci\xF3n fiscal",status:u.Pendiente},{id:"6",name:"Verificaci\xF3n Biom\xE9trica (Metamap)",status:u.Pendiente}],_e=[...be,{id:"7",name:"Carta Aval de Ruta",status:u.Pendiente,tooltip:"Documento emitido y validado por el Ecosistema/Ruta."},{id:"8",name:"Convenio de Daci\xF3n en Pago",status:u.Pendiente,tooltip:"Convenio que formaliza el colateral social."}],Pe=[{id:"1",name:"INE Vigente",status:u.Pendiente},{id:"2",name:"Comprobante de domicilio",status:u.Pendiente},{id:"3",name:"Tarjeta de circulaci\xF3n",status:u.Pendiente,tooltip:"Requerida para identificar la unidad que se dar\xE1 de alta en el programa de ahorro"},{id:"4",name:"Copia de la factura (Opcional)",status:u.Pendiente,tooltip:"Documento adicional para validar la propiedad del veh\xEDculo"}],Oe=[{id:"contract1",name:"Contrato Venta a Plazo",status:u.Pendiente}],Te=[{id:"contract2",name:"Contrato Promesa de Compraventa",status:u.Pendiente}],Fe=[{id:"contract3",name:"Contrato Venta a Plazo",status:u.Pendiente},{id:"contract4",name:"Convenio de Daci\xF3n en Pago",status:u.Pendiente}],we=(()=>{class o{constructor(){}getDocumentRequirements(e){let i=[];return e.saleType==="contado"||e.businessFlow===x.VentaDirecta?i=Re.map(t=>R({},t)):e.saleType==="financiero"&&(e.market==="aguascalientes"?i=be.map(t=>R({},t)):i=_e.map(t=>R({},t))),e.businessFlow===x.AhorroProgramado&&(e.market==="aguascalientes"?i=Pe.map(t=>R({},t)):i=[..._e.map(t=>R({},t)),{id:"9",name:"Copia de la factura (Opcional)",status:u.Pendiente,tooltip:"Documento adicional para validar la propiedad del veh\xEDculo"}]),O(i).pipe(T(100))}getContractDocuments(e){let i=[];return e.businessFlow===x.VentaPlazo?e.market==="edomex"&&e.hasEcosystem?i=Fe.map(t=>R({},t)):i=Oe.map(t=>R({},t)):i=Te.map(t=>R({},t)),O(i).pipe(T(200))}validateKycPrerequisites(e){let i=e.find(g=>g.name==="INE Vigente"),t=e.find(g=>g.name==="Comprobante de domicilio"),n=e.find(g=>g.name.includes("Verificaci\xF3n Biom\xE9trica")),s=i?.status===u.Aprobado&&t?.status===u.Aprobado,d=n?.status===u.Aprobado,m=[];return i?.status!==u.Aprobado&&m.push("INE Vigente"),t?.status!==u.Aprobado&&m.push("Comprobante de domicilio"),{canStartKyc:s&&!d,missingDocs:m,isKycComplete:d}}updateDocumentStatus(e,i,t){let n=e.map(s=>s.id===i?ne(R({},s),{status:t}):s);return O(n).pipe(T(300))}getDocumentCompletionStatus(e){let i=e.length,t=e.filter(m=>m.status===u.Aprobado).length,n=i-t,s=i>0?t/i*100:0,d=t===i;return{totalDocs:i,completedDocs:t,pendingDocs:n,completionPercentage:Math.round(s),allComplete:d}}getRequirementsMessage(e){return e.saleType==="contado"||e.businessFlow===x.VentaDirecta?"Documentos requeridos para venta directa/contado - proceso simplificado":e.businessFlow===x.AhorroProgramado?`Documentos requeridos para programa de ahorro en ${e.market==="aguascalientes"?"Aguascalientes":"Estado de M\xE9xico"} - incluye identificaci\xF3n de unidad`:e.market==="aguascalientes"?"Documentos requeridos para financiamiento en Aguascalientes":e.businessFlow===x.CreditoColectivo?"Documentos requeridos para cr\xE9dito colectivo en EdoMex":"Documentos requeridos para financiamiento en Estado de M\xE9xico"}getDocumentTooltip(e){switch(e){case"Carta Aval de Ruta":return"Documento emitido y validado por el Ecosistema/Ruta.";case"Convenio de Daci\xF3n en Pago":return"Convenio que formaliza el colateral social.";case"Verificaci\xF3n Biom\xE9trica (Metamap)":return"Verificaci\xF3n de identidad mediante biometr\xEDa facial.";case"Tarjeta de circulaci\xF3n":return"Requerida para identificar la unidad que se dar\xE1 de alta en el programa de ahorro.";case"Copia de la factura (Opcional)":return"Documento adicional para validar la propiedad del veh\xEDculo.";default:return}}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=U({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var De=(()=>{class o{constructor(){this.documentRequirements=[],this.validationRules=[],this.initializeDocumentRequirements(),this.initializeValidationRules()}validateDocument(e,i){let n=this.getApplicableRules(e,i).map(d=>d.validator(e,i)),s=this.consolidateValidationResults(n);return s.autoCorrections=this.generateAutoCorrections(e,s.issues),O(s).pipe(T(300))}generateComplianceReport(e){let i=this.getRequiredDocuments(e.market||"all",e.flow,e),t=e.documents||[],n=i.filter(A=>!t.some(S=>S.name.toLowerCase().includes(A.name.toLowerCase())||A.name.toLowerCase().includes(S.name.toLowerCase()))),s=[],d=[],m=[];t.forEach(A=>{let S=this.validateDocumentSync(A,e);S.valid?s.push(A):S.issues.some(j=>j.type==="error")?d.push(A):m.push(A)});let g=i.length,D=s.length,_=g>0?D/g*100:100,P="non-compliant";_>=100?P="complete":_>=80?P="partial":_>=50&&(P="insufficient");let L=this.identifyBlockingIssues(e,n,d),z=this.generateComplianceRecommendations(e,n,d),Q=this.generateNextSteps(e,n,d,P),ee={clientId:e.id,market:e.market||"all",flow:e.flow,overallScore:_,requiredDocuments:i,submittedDocuments:t,missingDocuments:n,validDocuments:s,invalidDocuments:d,warningDocuments:m,complianceLevel:P,blockingIssues:L,recommendations:z,nextSteps:Q};return O(ee).pipe(T(600))}validateEcosystemDocuments(e,i){let t=i.find(h=>h.name.includes("Acta Constitutiva")),n=i.find(h=>h.name.includes("Poderes")),s=i.find(h=>h.name.includes("INE Representante")),d=i.find(h=>h.name.includes("Constancia Situaci\xF3n Fiscal")&&h.name.includes("Ruta")),m=i.find(h=>h.name.includes("Carta Aval de Ruta")),g=i.find(h=>h.name.includes("Carta de Antig\xFCedad")),D={},_=t?this.validateConstitutiveAct(t):!1,P=n?this.validatePoderes(n):!1,L=s?this.validateINERepresentante(s):!1,z=d?this.validateRFCRuta(d):!1,Q=m?this.validateCartaAvalRuta(m):!1,ee=g?this.validateCartaAntiguedad(g):!1;t&&(D.constitutive_act=this.validateDocumentSync(t));let A=d;A&&(D.rfc=this.validateDocumentSync(A));let S=z,W=i.find(h=>h.name.includes("Padr\xF3n")||h.name.includes("Registro de Socios")),j=i.find(h=>h.name.includes("Poder del Representante Legal")),te=i.find(h=>h.name.includes("Estado de Cuenta")||h.name.includes("Estados de Cuenta")),q=W?this.validateDocumentSync(W).valid:!1,B=j?this.validatePoderes(j):!1,$=te?this.validateDocumentSync(te).valid:!1,Ee=_&&S&&$&&q&&B,Z="high",ie=[_,S,$,q,B].filter(Boolean).length;ie>=5?Z="low":ie>=3&&(Z="medium");let Ie=this.generateEcosystemValidationNotes(e,{constitutiveActValid:_,rfcValid:S,bankStatementsValid:$,memberRegistryValid:q,boardResolutionValid:B});return O({ecosystemId:e,constitutiveActValid:_,rfcValid:S,bankStatementsValid:$,memberRegistryValid:q,boardResolutionValid:B,overallValid:Ee,validationDetails:D,ecosystemRiskLevel:Z,validationNotes:Ie}).pipe(T(800))}getRequiredDocuments(e,i,t){return this.documentRequirements.filter(n=>n.market&&n.market!==e||n.flow&&n.flow!==i||n.condition&&t&&!n.condition(t)?!1:n.required)}detectDocumentType(e,i){let t=e.toLowerCase(),n="unknown",s=0,d=[];return t.includes("ine")?(n="INE",s=90):t.includes("constancia")&&t.includes("fiscal")?(n="Constancia de Situaci\xF3n Fiscal",s=85):t.includes("concesion")?(n="Copia Concesi\xF3n",s=85):t.includes("tarjeta")&&t.includes("circulacion")?(n="Tarjeta de Circulaci\xF3n",s=85):t.includes("comprobante")&&t.includes("domicilio")?(n="Comprobante de Domicilio",s=80):t.includes("acta")&&t.includes("constitutiva")?(n="Acta Constitutiva de la Ruta",s=85):t.includes("poderes")?(n="Poderes",s=90):t.includes("carta")&&t.includes("aval")?(n="Carta Aval de Ruta",s=95):t.includes("carta")&&t.includes("antiguedad")?(n="Carta de Antig\xFCedad de la Ruta",s=90):t.includes("factura")&&(n="Copia Factura de Unidad",s=85),s<70&&(d.push("Considere renombrar el archivo con un nombre m\xE1s descriptivo"),d.push("Incluya el tipo de documento en el nombre del archivo")),O({detectedType:n,confidence:s,suggestions:d}).pipe(T(150))}initializeDocumentRequirements(){this.documentRequirements=[{id:"ine",name:"INE",description:"Identificaci\xF3n oficial vigente",required:!0,validationRules:[],expirationMonths:120,maxFileSize:5,allowedFormats:["pdf","jpg","png"]},{id:"curp",name:"CURP",description:"Clave \xDAnica de Registro de Poblaci\xF3n",required:!0,validationRules:[],maxFileSize:2,allowedFormats:["pdf","jpg","png"]},{id:"rfc",name:"RFC",description:"Registro Federal de Contribuyentes",required:!0,validationRules:[],maxFileSize:2,allowedFormats:["pdf"]},{id:"comprobante-ingresos-ags",name:"Comprobante de Ingresos",description:"Comprobante de ingresos \xFAltimos 3 meses",required:!0,market:"aguascalientes",validationRules:[],maxFileSize:10,allowedFormats:["pdf"]},{id:"acta-constitutiva-ecosistema",name:"Acta Constitutiva del Ecosistema",description:"Acta constitutiva del ecosistema validada",required:!0,market:"edomex",validationRules:[],maxFileSize:15,allowedFormats:["pdf"]},{id:"padron-socios",name:"Padr\xF3n de Socios Actualizado",description:"Lista actualizada de socios del ecosistema",required:!0,market:"edomex",flow:x.CreditoColectivo,validationRules:[],maxFileSize:5,allowedFormats:["pdf","xlsx"]}]}initializeValidationRules(){this.validationRules=[{id:"file-format",name:"Formato de Archivo",description:"Validar formato de archivo permitido",type:"format",severity:"error",validator:e=>this.validateFileFormat(e)},{id:"file-size",name:"Tama\xF1o de Archivo",description:"Validar tama\xF1o m\xE1ximo de archivo",type:"format",severity:"warning",validator:e=>this.validateFileSize(e)},{id:"document-expiration",name:"Vigencia del Documento",description:"Verificar que el documento est\xE9 vigente",type:"expiration",severity:"error",validator:e=>this.validateExpiration(e)},{id:"content-legibility",name:"Legibilidad del Contenido",description:"Verificar que el contenido sea legible",type:"content",severity:"warning",validator:e=>this.validateLegibility(e)}]}getApplicableRules(e,i){return this.validationRules}validateDocumentSync(e,i){let n=this.getApplicableRules(e,i).map(s=>s.validator(e,i));return this.consolidateValidationResults(n)}consolidateValidationResults(e){let i=e.flatMap(s=>s.issues),t=i.some(s=>s.type==="error"),n=e.length>0?e.reduce((s,d)=>s+d.score,0)/e.length:0;return{valid:!t&&i.every(s=>s.type!=="error"),score:n,issues:i,suggestions:e.flatMap(s=>s.suggestions),autoCorrections:e.flatMap(s=>s.autoCorrections)}}generateAutoCorrections(e,i){let t=[];return i.forEach(n=>{if(n.fixable)switch(n.code){case"FILENAME_FORMAT":t.push({type:"format",description:"Renombrar archivo con formato est\xE1ndar",originalValue:e.name,correctedValue:this.generateStandardFilename(e),confidence:85});break;case"DATE_FORMAT":t.push({type:"data",description:"Corregir formato de fecha",originalValue:e.uploadedAt,correctedValue:new Date().toISOString(),confidence:70});break}}),t}validateConstitutiveAct(e){return e.status==="Aprobado"&&e.name.includes("Acta Constitutiva")}validatePoderes(e){return e.status==="Aprobado"&&e.name.includes("Poderes")}validateINERepresentante(e){return e.status==="Aprobado"&&e.name.includes("INE Representante")&&this.isDocumentRecent(e,3650)}validateRFCRuta(e){return e.status==="Aprobado"&&e.name.includes("Constancia Situaci\xF3n Fiscal")}validateCartaAvalRuta(e){return e.status==="Aprobado"&&e.name.includes("Carta Aval de Ruta")&&this.isDocumentRecent(e,180)}validateCartaAntiguedad(e){return e.status==="Aprobado"&&e.name.includes("Carta de Antig\xFCedad")&&this.isDocumentRecent(e,90)}validateFileFormat(e){let i=["pdf","jpg","jpeg","png"],t=e.name.split(".").pop()?.toLowerCase(),n=t?i.includes(t):!1;return{valid:n,score:n?100:0,issues:n?[]:[{type:"error",code:"INVALID_FORMAT",message:`Formato no permitido: ${t}. Use: ${i.join(", ")}`,severity:8,fixable:!1}],suggestions:n?[]:["Convierta el archivo a PDF antes de subirlo"],autoCorrections:[]}}validateFileSize(e){let t=e.name.length*.1,n=t<=10;return{valid:!0,score:n?100:70,issues:n?[]:[{type:"warning",code:"FILE_TOO_LARGE",message:`Archivo muy grande (${t.toFixed(1)}MB). M\xE1ximo: 10MB`,severity:5,fixable:!0}],suggestions:n?[]:["Comprima el archivo o use menor resoluci\xF3n"],autoCorrections:[]}}validateExpiration(e){if(!e.expirationDate)return{valid:!0,score:90,issues:[{type:"info",code:"NO_EXPIRATION",message:"Documento sin fecha de expiraci\xF3n definida",severity:2,fixable:!1}],suggestions:[],autoCorrections:[]};let t=!(new Date(e.expirationDate)<new Date);return{valid:t,score:t?100:0,issues:t?[]:[{type:"error",code:"DOCUMENT_EXPIRED",message:"Documento vencido",severity:9,fixable:!1}],suggestions:t?[]:["Solicite documento actualizado al cliente"],autoCorrections:[]}}validateLegibility(e){let i=85+Math.random()*15,t=i>=80;return{valid:t,score:i,issues:t?[]:[{type:"warning",code:"LOW_LEGIBILITY",message:"Documento con baja legibilidad",severity:6,fixable:!0}],suggestions:t?[]:["Solicite nueva foto con mejor calidad"],autoCorrections:[]}}isDocumentRecent(e,i){let t=new Date(e.uploadedAt),n=new Date;return n.setDate(n.getDate()-i),t>=n}generateStandardFilename(e){let i=e.name.includes("INE")?"INE":"DOCUMENTO",t=new Date().toISOString().slice(0,10);return`${i}_${t}.pdf`}identifyBlockingIssues(e,i,t){let n=[];e.market==="edomex"&&i.some(g=>g.name.includes("Acta Constitutiva"))&&n.push("Falta Acta Constitutiva del Ecosistema (OBLIGATORIO para EdoMex)"),i.some(m=>m.name==="INE")&&n.push("Falta identificaci\xF3n oficial (INE)");let d=t.filter(m=>m.expirationDate&&new Date(m.expirationDate)<new Date);return d.length>0&&n.push(`${d.length} documento(s) vencido(s)`),n}generateComplianceRecommendations(e,i,t){let n=[];return i.length>0&&n.push(`Solicitar ${i.length} documento(s) faltante(s) al cliente`),t.length>0&&n.push(`Revisar y corregir ${t.length} documento(s) rechazado(s)`),e.market==="edomex"&&!e.ecosystemId&&n.push("Asignar cliente a ecosistema antes de continuar"),n}generateNextSteps(e,i,t,n){let s=[];return n==="complete"?(s.push("Proceder con validaci\xF3n financiera"),s.push("Programar entrega de unidad")):(i.length>0&&s.push("1. Contactar cliente para documentos faltantes"),t.length>0&&s.push("2. Solicitar correcci\xF3n de documentos rechazados"),s.push("3. Re-evaluar completitud documental")),s}generateEcosystemValidationNotes(e,i){let t=[];t.push(`Ecosistema ID: ${e}`);let n=Object.values(i).filter(Boolean).length,s=Object.keys(i).length;return t.push(`Documentos v\xE1lidos: ${n}/${s}`),i.constitutiveActValid&&t.push("\u2713 Acta Constitutiva aprobada"),i.rfcValid||t.push("\u26A0 RFC del ecosistema pendiente"),t}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275prov=U({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var G=Ae(Se());var ye=(()=>{class o{constructor(e){this.worker=null,this.isInitialized=!1,this.progressSubject=new ae({status:"idle",progress:0,message:""}),this.progress$=this.progressSubject.asObservable(),this.createWorkerFn=e??G.createWorker}initializeWorker(){return w(this,null,function*(){if(!(this.isInitialized&&this.worker))try{this.progressSubject.next({status:"initializing",progress:0,message:"Inicializando OCR..."}),this.worker=yield this.createWorkerFn("spa+eng",1,{logger:e=>{console.log("OCR Logger:",e),this.progressSubject.next({status:e.status,progress:e.progress||0,message:this.getSpanishMessage(e.status)})}}),yield this.worker.setParameters({tessedit_pageseg_mode:G.default.PSM.SINGLE_BLOCK,tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\xC1\xC9\xCD\xD3\xDA\xE1\xE9\xED\xF3\xFA\xD1\xF10123456789-/.,: "}),this.isInitialized=!0,this.progressSubject.next({status:"ready",progress:100,message:"OCR listo"})}catch(e){throw console.error("Error initializing OCR worker:",e),this.progressSubject.next({status:"error",progress:0,message:"Error inicializando OCR"}),e}})}extractTextFromImage(e,i){return w(this,null,function*(){this.worker||(yield this.initializeWorker());try{this.progressSubject.next({status:"recognizing",progress:0,message:"Procesando imagen..."});let t=yield this.worker.recognize(e),n=t?.data?.words||[],s={text:t.data.text,confidence:t.data.confidence,words:n.map(d=>({text:d.text,confidence:d.confidence,bbox:d.bbox}))};return i&&(s.extractedData=this.extractStructuredData(s.text,i)),this.progressSubject.next({status:"completed",progress:100,message:"Texto extra\xEDdo"}),s}catch(t){throw console.error("Error during OCR processing:",t),this.progressSubject.next({status:"error",progress:0,message:"Error procesando imagen"}),t}})}extractTextFromBase64(e,i){return w(this,null,function*(){this.worker||(yield this.initializeWorker());try{let t=yield this.worker.recognize(e),n=t?.data?.words||[],s={text:t.data.text,confidence:t.data.confidence,words:n.map(d=>({text:d.text,confidence:d.confidence,bbox:d.bbox}))};return i&&(s.extractedData=this.extractStructuredData(s.text,i)),s}catch(t){throw console.error("Error during OCR processing:",t),t}})}extractStructuredData(e,i){let t=e.replace(/\n/g," ").replace(/\s+/g," ").toUpperCase();switch(i.toUpperCase()){case"INE":case"INE VIGENTE":return this.extractINEData(t);case"TARJETA DE CIRCULACION":case"TARJETA DE CIRCULACI\xD3N":return this.extractTarjetaCirculacionData(t);case"COMPROBANTE DE DOMICILIO":return this.extractComprobanteData(t);case"CONSTANCIA DE SITUACION FISCAL":case"CONSTANCIA DE SITUACI\xD3N FISCAL":return this.extractRFCData(t);default:return{documentType:i,fields:{text:t},confidence:.5}}}extractINEData(e){let i={},t=.3,n=e.match(/[A-Z]{4}\d{6}[HM][A-Z]{5}[A-Z0-9]{2}/);n&&(i.curp=n[0],t+=.2),[/NOMBRE\s*:?\s*([A-ZÁÉÍÓÚÑ\s]+)/,/APELLIDOS?\s*:?\s*([A-ZÁÉÍÓÚÑ\s]+)/].forEach(m=>{let g=e.match(m);if(g){let D=m.toString().includes("APELLIDO")?"apellidos":"nombre";i[D]=g[1].trim(),t+=.15}});let d=e.match(/(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/);return d&&(i.fechaNacimiento=d[1],t+=.1),(e.includes("INSTITUTO NACIONAL")||e.includes("ELECTORAL")||i.curp)&&(t+=.2),{documentType:"INE",fields:i,confidence:Math.min(t,1)}}extractTarjetaCirculacionData(e){let i={},t=.3,n=e.match(/([A-Z]{3}[-\s]?\d{2}[-\s]?\d{2})|(\d{3}[-\s]?[A-Z]{3})/);n&&(i.placas=n[0].replace(/\s/g,""),t+=.25),["NISSAN","FORD","CHEVROLET","TOYOTA","VOLKSWAGEN","HYUNDAI","KIA"].forEach(g=>{e.includes(g)&&(i.marca=g,t+=.15)});let d=e.match(/MODELO\s*:?\s*([A-ZÁÉÍÓÚÑ0-9\s]+)/);d&&(i.modelo=d[1].trim(),t+=.1);let m=e.match(/(19|20)\d{2}/);return m&&(i.a\u00F1o=m[0],t+=.1),(e.includes("CIRCULACION")||e.includes("VEHICULO")||i.placas)&&(t+=.1),{documentType:"TARJETA_CIRCULACION",fields:i,confidence:Math.min(t,1)}}extractComprobanteData(e){let i={},t=.3;[/CALLE\s+([A-ZÁÉÍÓÚÑ0-9\s,]+)/,/DIRECCION\s*:?\s*([A-ZÁÉÍÓÚÑ0-9\s,]+)/,/DOMICILIO\s*:?\s*([A-ZÁÉÍÓÚÑ0-9\s,]+)/].forEach(m=>{let g=e.match(m);g&&(i.direccion=g[1].trim(),t+=.2)});let s=e.match(/(\d{1,2}[\/\-]\d{1,2}[\/\-]\d{4})/);return s&&(i.fecha=s[1],t+=.1),["CFE","TELMEX","IZZI","TOTALPLAY","GAS NATURAL"].forEach(m=>{e.includes(m)&&(i.proveedor=m,t+=.2)}),{documentType:"COMPROBANTE_DOMICILIO",fields:i,confidence:Math.min(t,1)}}extractRFCData(e){let i={},t=.3,n=e.match(/[A-Z]{3,4}\d{6}[A-Z0-9]{3}/);n&&(i.rfc=n[0],t+=.3);let s=e.match(/NOMBRE\s*:?\s*([A-ZÁÉÍÓÚÑ\s,]+)/);return s&&(i.nombre=s[1].trim(),t+=.2),(e.includes("SAT")||e.includes("SITUACION FISCAL")||i.rfc)&&(t+=.2),{documentType:"RFC",fields:i,confidence:Math.min(t,1)}}terminateWorker(){return w(this,null,function*(){this.worker&&(yield this.worker.terminate(),this.worker=null,this.isInitialized=!1)})}getSpanishMessage(e){return{"initializing api":"Inicializando API...","loading language traineddata":"Cargando idioma...","initializing tesseract":"Inicializando Tesseract...","loading core":"Cargando datos de entrenamiento...","recognizing text":"Reconociendo texto...",done:"Completado",ready:"Listo"}[e]||e}validateDocumentType(e,i){let t=e.toUpperCase(),n={INE:["INSTITUTO NACIONAL","ELECTORAL","CURP","CREDENCIAL"],"TARJETA DE CIRCULACION":["CIRCULACION","VEHICULO","PLACAS","MODELO"],"COMPROBANTE DE DOMICILIO":["CFE","TELMEX","DOMICILIO","DIRECCION"],"CONSTANCIA DE SITUACION FISCAL":["SAT","RFC","SITUACION FISCAL","HACIENDA"]},s="",d=0;Object.entries(n).forEach(([D,_])=>{let P=_.reduce((L,z)=>L+(t.includes(z)?1:0),0)/_.length;P>d&&(d=P,s=D)});let m=n[i.toUpperCase()]||[],g=m.reduce((D,_)=>D+(t.includes(_)?1:0),0)/m.length;return{valid:g>=.3,confidence:g,suggestedType:d>g?s:void 0}}static{this.\u0275fac=function(i){return new(i||o)(re(Ce,8))}}static{this.\u0275prov=U({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();function Ne(o,f){if(o&1&&(r(0,"span",45),c(1,"\u2139\uFE0F"),a()),o&2){let e=v().$implicit,i=v(2);p("title",i.getDocumentTooltip(e.name))}}function Ue(o,f){if(o&1){let e=N();r(0,"button",46),I("click",function(){y(e);let t=v().$implicit,n=v(2);return E(n.uploadDocument(t))}),c(1," \u{1F4E4} Subir "),a()}}function ze(o,f){o&1&&(r(0,"span",47),c(1,"\u2705"),a())}function Le(o,f){o&1&&(r(0,"span",48),c(1,"\u23F3"),a())}function je(o,f){o&1&&(r(0,"span",49),c(1,"\u274C"),a())}function qe(o,f){o&1&&k(0,"div",50)}function Be(o,f){if(o&1&&(r(0,"div",33)(1,"div",34)(2,"div",35)(3,"div",26)(4,"span",36),c(5),a(),C(6,Ne,2,1,"span",37),a(),r(7,"div",38),c(8),a()(),r(9,"div",39),C(10,Ue,2,0,"button",40),r(11,"div",26),C(12,ze,2,0,"span",41)(13,Le,2,0,"span",42)(14,je,2,0,"span",43)(15,qe,1,0,"div",44),a()()()()),o&2){let e=f.$implicit,i=v(2);b("border-green-300",e.status===i.DocumentStatus.Aprobado)("bg-green-50",e.status===i.DocumentStatus.Aprobado)("border-yellow-300",e.status===i.DocumentStatus.Pendiente)("bg-yellow-50",e.status===i.DocumentStatus.Pendiente)("border-red-300",e.status===i.DocumentStatus.Rechazado)("bg-red-50",e.status===i.DocumentStatus.Rechazado),l(5),M(e.name),l(),p("ngIf",i.getDocumentTooltip(e.name)),l(2),F(" ",i.getStatusText(e.status)," "),l(2),p("ngIf",e.status===i.DocumentStatus.Pendiente),l(2),p("ngIf",e.status===i.DocumentStatus.Aprobado),l(),p("ngIf",e.status===i.DocumentStatus.Pendiente),l(),p("ngIf",e.status===i.DocumentStatus.Rechazado),l(),p("ngIf",e.status===i.DocumentStatus.EnRevision)}}function $e(o,f){o&1&&(r(0,"span"),c(1,"\u{1F3A4} Iniciar Grabaci\xF3n"),a())}function Ge(o,f){o&1&&(r(0,"span",26),k(1,"div",59),c(2," Grabando... "),a())}function We(o,f){o&1&&(r(0,"span"),c(1,"\u2705 Verificado"),a())}function Ze(o,f){o&1&&(r(0,"div",60),c(1," Identidad verificada correctamente "),a())}function He(o,f){if(o&1){let e=N();r(0,"div",13)(1,"h2",14)(2,"span",51),c(3,"\u{1F3A4}"),a(),c(4," Verificaci\xF3n de Identidad por Voz "),a(),r(5,"div",52)(6,"p",53)(7,"strong"),c(8,"Patr\xF3n de Voz:"),a(),c(9),a(),r(10,"p",54),c(11," Repite exactamente esta frase para verificar tu identidad "),a()(),r(12,"div",55)(13,"button",56),I("click",function(){y(e);let t=v(2);return E(t.startVoiceRecording())}),C(14,$e,2,0,"span",28)(15,Ge,3,0,"span",57)(16,We,2,0,"span",28),a(),C(17,Ze,2,0,"div",58),a()()}if(o&2){let e=v(2);l(9),F(' "',e.voicePattern,'" '),l(4),p("disabled",e.isRecording||e.voiceVerified),l(),p("ngIf",!e.isRecording&&!e.voiceVerified),l(),p("ngIf",e.isRecording),l(),p("ngIf",e.voiceVerified),l(),p("ngIf",e.voiceVerified)}}function Ke(o,f){if(o&1&&(r(0,"div",67)(1,"div",22)(2,"span",68),c(3,"Confiabilidad:"),a(),r(4,"span",24),c(5),a()(),r(6,"div",22)(7,"span",68),c(8,"Riesgo de Fraude:"),a(),r(9,"span",24),c(10),a()()()),o&2){let e=v(3);l(5),F("",e.aviAnalysis.confidence,"%"),l(4),b("text-green-600",e.aviAnalysis.fraudRisk==="LOW")("text-yellow-600",e.aviAnalysis.fraudRisk==="MEDIUM")("text-red-600",e.aviAnalysis.fraudRisk==="HIGH"),l(),F(" ",e.getFraudRiskText(e.aviAnalysis.fraudRisk)," ")}}function Je(o,f){o&1&&(r(0,"div",26),k(1,"div",69),r(2,"span",68),c(3,"Analizando patrones de voz..."),a()())}function Xe(o,f){if(o&1&&(r(0,"div",13)(1,"h2",14)(2,"span",61),c(3,"\u{1F916}"),a(),c(4," An\xE1lisis AVI (Automated Voice Intelligence) "),a(),r(5,"div",16)(6,"div",62)(7,"div",63)(8,"span",64),c(9,"Estado del An\xE1lisis:"),a(),r(10,"span",65),c(11),a()(),C(12,Ke,11,8,"div",66)(13,Je,4,0,"div",57),a()()()),o&2){let e=v(2);l(10),b("bg-green-100",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="completed")("text-green-800",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="completed")("bg-yellow-100",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="processing")("text-yellow-800",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="processing"),l(),F(" ",e.getAVIStatusText(e.aviAnalysis==null?null:e.aviAnalysis.status)," "),l(),p("ngIf",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="completed"),l(),p("ngIf",(e.aviAnalysis==null?null:e.aviAnalysis.status)==="processing")}}function Ye(o,f){o&1&&(r(0,"span"),c(1,"\u2713"),a())}function Qe(o,f){o&1&&(r(0,"span"),c(1,"1"),a())}function et(o,f){o&1&&(r(0,"span"),c(1,"\u2713"),a())}function tt(o,f){o&1&&(r(0,"span"),c(1,"2"),a())}function it(o,f){o&1&&(r(0,"span"),c(1,"\u2713"),a())}function nt(o,f){o&1&&(r(0,"span"),c(1,"3"),a())}function ot(o,f){if(o&1){let e=N();r(0,"button",70),I("click",function(){y(e);let t=v(2);return E(t.proceedToContracts())}),ce(),r(1,"svg",71),k(2,"path",72),a(),c(3," Generar Contratos "),a()}}function at(o,f){if(o&1&&(r(0,"div",79)(1,"div",80),k(2,"div",81),a(),r(3,"p",82),c(4),a()()),o&2){let e=v(3);l(2),J("width",e.ocrProgress.progress,"%"),l(2),M(e.ocrProgress.message)}}function rt(o,f){if(o&1&&(r(0,"div",97)(1,"span",98),c(2),a(),r(3,"span",99),c(4),a()()),o&2){let e=f.$implicit;l(2),F("",e.key,":"),l(2),M(e.value)}}function st(o,f){if(o&1&&(r(0,"div",94)(1,"h4"),c(2,"\u{1F4CB} Datos Extra\xEDdos:"),a(),r(3,"div",95),C(4,rt,5,2,"div",96),a()()),o&2){let e=v(4);l(4),p("ngForOf",e.getExtractedDataArray(e.ocrResult.extractedData.fields))}}function ct(o,f){if(o&1){let e=N();r(0,"div",83)(1,"div",84)(2,"span",85),c(3,"Confianza:"),a(),r(4,"span",86),c(5),a()(),C(6,st,5,1,"div",87),r(7,"div",88)(8,"h4"),c(9,"\u{1F4DD} Texto Completo:"),a(),r(10,"div",89),k(11,"textarea",90),a()(),r(12,"div",91)(13,"button",92),I("click",function(){y(e);let t=v(3);return E(t.confirmOCRResult())}),c(14," \u2705 Confirmar y Continuar "),a(),r(15,"button",93),I("click",function(){y(e);let t=v(3);return E(t.reprocessOCR())}),c(16," \u{1F504} Subir Otra Imagen "),a()()()}if(o&2){let e=v(3);l(),le("confidence-"+e.getConfidenceLevel(e.ocrResult.confidence)),l(4),F("",(e.ocrResult.confidence*100).toFixed(1),"%"),l(),p("ngIf",e.ocrResult.extractedData),l(5),p("value",e.ocrResult.text)}}function lt(o,f){if(o&1){let e=N();r(0,"div",73),I("click",function(){y(e);let t=v(2);return E(t.closeOCRPreview())}),r(1,"div",74),I("click",function(t){return y(e),E(t.stopPropagation())}),r(2,"div",75)(3,"h3"),c(4,"\u{1F4C4} Preview de Documento"),a(),r(5,"button",76),I("click",function(){y(e);let t=v(2);return E(t.closeOCRPreview())}),c(6,"\u2715"),a()(),C(7,at,5,3,"div",77)(8,ct,17,5,"div",78),a()()}if(o&2){let e=v(2);l(7),p("ngIf",e.ocrProgress.status!=="idle"&&e.ocrProgress.status!=="completed"),l(),p("ngIf",e.ocrResult)}}function dt(o,f){if(o&1){let e=N();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"h1",4),c(5,"Carga de Documentos"),a(),r(6,"p",5),c(7),a()(),r(8,"div",6)(9,"div",7),c(10),a(),r(11,"div",8),c(12),a()()(),r(13,"div",9),k(14,"div",10),a()(),r(15,"div",11)(16,"div",12)(17,"div",13)(18,"h2",14)(19,"span",15),c(20,"\u{1F4C4}"),a(),c(21," Documentos Requeridos "),a(),r(22,"div",16),C(23,Be,16,20,"div",17),a()(),C(24,He,18,6,"div",18)(25,Xe,14,11,"div",18),a(),r(26,"div",19)(27,"div",13)(28,"h3",20),c(29,"Contexto del Flujo"),a(),r(30,"div",21)(31,"div",22)(32,"span",23),c(33,"Origen:"),a(),r(34,"span",24),c(35),a()(),r(36,"div",22)(37,"span",23),c(38,"Mercado:"),a(),r(39,"span",24),c(40),a()(),r(41,"div",22)(42,"span",23),c(43,"Tipo:"),a(),r(44,"span",24),c(45),a()(),r(46,"div",22)(47,"span",23),c(48,"Flujo:"),a(),r(49,"span",24),c(50),a()()()(),r(51,"div",13)(52,"h3",20),c(53,"Siguientes Pasos"),a(),r(54,"div",25)(55,"div",26)(56,"span",27),C(57,Ye,2,0,"span",28)(58,Qe,2,0,"span",28),a(),r(59,"span"),c(60,"Documentos completos"),a()(),r(61,"div",26)(62,"span",27),C(63,et,2,0,"span",28)(64,tt,2,0,"span",28),a(),r(65,"span"),c(66,"Verificaci\xF3n de voz"),a()(),r(67,"div",26)(68,"span",27),C(69,it,2,0,"span",28)(70,nt,2,0,"span",28),a(),r(71,"span"),c(72,"Listo para contratos"),a()()()(),r(73,"div",25),C(74,ot,4,0,"button",29),r(75,"button",30),I("click",function(){y(e);let t=v();return E(t.goBack())}),c(76," \u2190 Regresar "),a(),r(77,"button",31),I("click",function(){y(e);let t=v();return E(t.saveProgress())}),c(78," \u{1F4BE} Guardar Progreso "),a()()()(),C(79,lt,9,2,"div",32),a()}if(o&2){let e=v();l(7),X(" ",e.getFlowTitle()," - ",e.flowContext.market==="aguascalientes"?"Aguascalientes":"Estado de M\xE9xico"," "),l(3),F("",e.completionStatus.completionPercentage,"%"),l(2),X("",e.completionStatus.completedDocs,"/",e.completionStatus.totalDocs," completos"),l(2),J("width",e.completionStatus.completionPercentage,"%"),l(9),p("ngForOf",e.requiredDocuments),l(),p("ngIf",e.showVoicePattern),l(),p("ngIf",e.showAVI),l(10),M(e.getSourceText(e.flowContext.source)),l(5),M(e.flowContext.market==="aguascalientes"?"Aguascalientes":"EdoMex"),l(5),M(e.flowContext.clientType==="individual"?"Individual":"Colectivo"),l(5),M(e.getBusinessFlowText(e.flowContext.businessFlow)),l(5),b("opacity-50",!e.completionStatus.allComplete),l(),b("bg-green-500",e.completionStatus.allComplete)("border-green-500",e.completionStatus.allComplete)("text-white",e.completionStatus.allComplete)("border-gray-300",!e.completionStatus.allComplete),l(),p("ngIf",e.completionStatus.allComplete),l(),p("ngIf",!e.completionStatus.allComplete),l(),b("font-medium",e.completionStatus.allComplete),l(2),b("opacity-50",!e.voiceVerified),l(),b("bg-green-500",e.voiceVerified)("border-green-500",e.voiceVerified)("text-white",e.voiceVerified)("border-gray-300",!e.voiceVerified),l(),p("ngIf",e.voiceVerified),l(),p("ngIf",!e.voiceVerified),l(),b("font-medium",e.voiceVerified),l(2),b("opacity-50",!e.canProceedToContracts),l(),b("bg-green-500",e.canProceedToContracts)("border-green-500",e.canProceedToContracts)("text-white",e.canProceedToContracts)("border-gray-300",!e.canProceedToContracts),l(),p("ngIf",e.canProceedToContracts),l(),p("ngIf",!e.canProceedToContracts),l(),b("font-medium",e.canProceedToContracts),l(3),p("ngIf",e.canProceedToContracts),l(5),p("ngIf",e.showOCRPreview)}}var kt=(()=>{class o{constructor(e,i,t,n,s,d,m){this.fb=e,this.router=i,this.documentRequirements=t,this.documentValidation=n,this.voiceValidation=s,this.aviConfig=d,this.ocrService=m,this.destroy$=new oe,this.flowComplete=new K,this.goBackRequested=new K,this.requiredDocuments=[],this.completionStatus={totalDocs:0,completedDocs:0,pendingDocs:0,completionPercentage:0,allComplete:!1},this.voicePattern="",this.showVoicePattern=!1,this.isRecording=!1,this.voiceVerified=!1,this.showAVI=!1,this.aviAnalysis=null,this.ocrProgress={status:"idle",progress:0,message:""},this.ocrResult=null,this.showOCRPreview=!1,this.currentUploadingDoc=null,this.DocumentStatus=u}ngOnInit(){this.initializeFlow()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.ocrService.terminateWorker()}initializeFlow(){return w(this,null,function*(){this.flowContext&&(this.documentRequirements.getDocumentRequirements({market:this.flowContext.market,saleType:"financiero",businessFlow:this.flowContext.businessFlow,clientType:this.flowContext.clientType}).pipe(H(this.destroy$)).subscribe(e=>{this.requiredDocuments=e,this.updateCompletionStatus()}),this.shouldUseVoicePattern()&&this.initializeVoicePattern(),this.shouldUseAVI()&&this.initializeAVI())})}shouldUseVoicePattern(){return this.flowContext.businessFlow!==x.VentaDirecta&&(this.flowContext.businessFlow===x.VentaPlazo||this.flowContext.businessFlow===x.CreditoColectivo||this.flowContext.market==="edomex")}initializeVoicePattern(){this.voicePattern=this.voiceValidation.generateVoicePattern(),this.showVoicePattern=!0}shouldUseAVI(){return this.flowContext.businessFlow!==x.VentaDirecta&&(this.flowContext.clientType==="colectivo"||this.flowContext.businessFlow===x.CreditoColectivo||this.flowContext.businessFlow===x.VentaPlazo)}initializeAVI(){this.showAVI=!0,this.aviAnalysis={status:"pending",confidence:0,fraudRisk:"UNKNOWN"}}uploadDocument(e){this.currentUploadingDoc=e,this.showFileUploadDialog(e)}showFileUploadDialog(e){let i=window.document.createElement("input");i.type="file",i.accept="image/*,application/pdf",i.multiple=!1,i.onchange=t=>w(this,null,function*(){let n=t.target.files?.[0];n&&(yield this.processUploadedFile(n,e))}),i.click()}processUploadedFile(e,i){return w(this,null,function*(){try{if(i.status=u.EnRevision,this.updateCompletionStatus(),e.type.startsWith("image/"))yield this.processImageWithOCR(e,i);else if(e.type==="application/pdf")yield this.processPDFUpload(e,i);else throw new Error("Tipo de archivo no soportado")}catch(t){console.error("Error processing file:",t),i.status=u.Rechazado,this.updateCompletionStatus()}})}processImageWithOCR(e,i){return w(this,null,function*(){try{yield this.ocrService.initializeWorker(),this.ocrService.progress$.pipe(H(this.destroy$)).subscribe(t=>this.ocrProgress=t),this.ocrResult=yield this.ocrService.extractTextFromImage(e,i.name),this.showOCRPreview=!0,this.currentUploadingDoc=i,console.log("OCR Result:",this.ocrResult)}catch(t){console.error("OCR processing failed:",t),yield this.finalizeDocumentUpload(i,e)}})}processPDFUpload(e,i){return w(this,null,function*(){yield this.finalizeDocumentUpload(i,e)})}confirmOCRResult(){this.currentUploadingDoc&&this.ocrResult&&(this.finalizeDocumentUpload(this.currentUploadingDoc,null,this.ocrResult),this.closeOCRPreview())}reprocessOCR(){this.currentUploadingDoc&&(this.showFileUploadDialog(this.currentUploadingDoc),this.closeOCRPreview())}closeOCRPreview(){this.showOCRPreview=!1,this.ocrResult=null,this.currentUploadingDoc=null,this.ocrProgress={status:"idle",progress:0,message:""}}finalizeDocumentUpload(e,i,t){return w(this,null,function*(){if(yield new Promise(n=>setTimeout(n,1e3)),t&&t.extractedData){let n=this.ocrService.validateDocumentType(t.text,e.name);n.valid&&n.confidence>.7?(e.status=u.Aprobado,e.extractedData=t.extractedData):(e.status=u.EnRevision,console.log("Document needs review - low confidence or type mismatch"))}else e.status=u.Aprobado;this.updateCompletionStatus(),this.completionStatus.allComplete&&this.showVoicePattern&&!this.voiceVerified&&(this.showVoicePattern=!0)})}startVoiceRecording(){this.isRecording=!0,setTimeout(()=>{this.isRecording=!1,this.voiceVerified=!0,this.showAVI&&this.startAVIAnalysis()},3e3)}startAVIAnalysis(){this.aviAnalysis={status:"processing",confidence:0,fraudRisk:"UNKNOWN"},setTimeout(()=>{this.aviAnalysis={status:"completed",confidence:94,fraudRisk:"LOW"}},4e3)}updateCompletionStatus(){this.completionStatus=this.documentRequirements.getDocumentCompletionStatus(this.requiredDocuments)}get canProceedToContracts(){let e=this.completionStatus.allComplete,i=!this.showVoicePattern||this.voiceVerified,t=!this.showAVI||this.aviAnalysis?.status==="completed"&&this.aviAnalysis?.fraudRisk!=="HIGH";return e&&i&&t}proceedToContracts(){let e={flowContext:this.flowContext,documentsComplete:!0,voiceVerified:this.voiceVerified,aviAnalysis:this.aviAnalysis,contractType:this.getContractType()};this.flowComplete.emit(e),this.router.navigate(["/contratos/generacion"],{queryParams:{clientId:this.flowContext.clientId,source:this.flowContext.source,market:this.flowContext.market,businessFlow:this.flowContext.businessFlow}})}getContractType(){return this.flowContext.businessFlow===x.VentaPlazo?this.flowContext.market==="edomex"?"PAQUETE_DACION_PAGO":"VENTA_PLAZO":"PROMESA_COMPRAVENTA"}saveProgress(){let e={flowContext:this.flowContext,requiredDocuments:this.requiredDocuments,voicePattern:this.voicePattern,voiceVerified:this.voiceVerified,aviAnalysis:this.aviAnalysis,timestamp:new Date().toISOString()};sessionStorage.setItem(`documentProgress_${this.flowContext.clientId}`,JSON.stringify(e)),console.log("Progreso guardado:",e)}goBack(){this.goBackRequested.emit()}getFlowTitle(){switch(this.flowContext.source){case"cotizador":return"Cotizaci\xF3n Generada";case"simulador":return"Simulaci\xF3n Completada";case"nueva-oportunidad":return"Nueva Oportunidad";default:return"Proceso de Documentos"}}getSourceText(e){switch(e){case"cotizador":return"Cotizador";case"simulador":return"Simulador";case"nueva-oportunidad":return"Nueva Oportunidad";default:return e}}getBusinessFlowText(e){switch(e){case x.VentaPlazo:return"Venta a Plazo";case x.VentaDirecta:return"Venta Directa";case x.CreditoColectivo:return"Cr\xE9dito Colectivo";case x.AhorroProgramado:return"Ahorro Programado";default:return e}}getStatusText(e){switch(e){case u.Pendiente:return"Pendiente de subir";case u.EnRevision:return"Procesando...";case u.Aprobado:return"Aprobado";case u.Rechazado:return"Rechazado - Revisar";default:return e}}getAVIStatusText(e){switch(e){case"pending":return"Pendiente";case"processing":return"Procesando";case"completed":return"Completado";default:return e}}getFraudRiskText(e){switch(e){case"LOW":return"Bajo";case"MEDIUM":return"Medio";case"HIGH":return"Alto";default:return"Desconocido"}}getDocumentTooltip(e){return this.documentRequirements.getDocumentTooltip(e)}getConfidenceLevel(e){return e>=.8?"high":e>=.6?"medium":"low"}getExtractedDataArray(e){return Object.entries(e).map(([i,t])=>({key:this.formatFieldName(i),value:t}))}formatFieldName(e){return{curp:"CURP",nombre:"Nombre",apellidos:"Apellidos",fechaNacimiento:"Fecha de Nacimiento",placas:"Placas",marca:"Marca",modelo:"Modelo",a\u00F1o:"A\xF1o",direccion:"Direcci\xF3n",fecha:"Fecha",proveedor:"Proveedor",rfc:"RFC"}[e]||e.charAt(0).toUpperCase()+e.slice(1)}static{this.\u0275fac=function(i){return new(i||o)(V(ge),V(fe),V(we),V(De),V(xe),V(he),V(ye))}}static{this.\u0275cmp=se({type:o,selectors:[["app-document-upload-flow"]],inputs:{flowContext:"flowContext"},outputs:{flowComplete:"flowComplete",goBackRequested:"goBackRequested"},standalone:!0,features:[de],decls:1,vars:1,consts:[["class","document-upload-flow",4,"ngIf"],[1,"document-upload-flow"],[1,"bg-gradient-to-r","from-blue-600","to-blue-800","text-white","rounded-xl","p-6","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold"],[1,"text-blue-100"],[1,"text-right"],[1,"text-3xl","font-bold"],[1,"text-blue-100","text-sm"],[1,"w-full","bg-blue-400","rounded-full","h-3"],[1,"bg-white","rounded-full","h-3","transition-all","duration-500"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-4"],[1,"bg-white","rounded-xl","shadow-lg","p-6"],[1,"text-xl","font-semibold","text-gray-800","mb-4","flex","items-center"],[1,"bg-blue-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"space-y-4"],["class","border rounded-lg p-4 transition-all duration-200",3,"border-green-300","bg-green-50","border-yellow-300","bg-yellow-50","border-red-300","bg-red-50",4,"ngFor","ngForOf"],["class","bg-white rounded-xl shadow-lg p-6",4,"ngIf"],[1,"space-y-6"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],[1,"space-y-3"],[1,"flex","items-center"],[1,"w-6","h-6","rounded-full","border-2","flex","items-center","justify-center","mr-3"],[4,"ngIf"],["class","w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors flex items-center justify-center",3,"click",4,"ngIf"],[1,"w-full","border","border-gray-300","text-gray-700","font-medium","py-3","px-6","rounded-lg","hover:bg-gray-50","transition-colors",3,"click"],[1,"w-full","bg-blue-600","hover:bg-blue-700","text-white","font-medium","py-3","px-6","rounded-lg","transition-colors",3,"click"],["class","ocr-preview-modal",3,"click",4,"ngIf"],[1,"border","rounded-lg","p-4","transition-all","duration-200"],[1,"flex","items-center","justify-between"],[1,"flex-1"],[1,"font-medium","text-gray-800"],["class","ml-2 text-gray-400 cursor-help",3,"title",4,"ngIf"],[1,"text-sm","text-gray-600","mt-1"],[1,"flex","items-center","space-x-2"],["class","bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",3,"click",4,"ngIf"],["class","text-green-500 text-xl",4,"ngIf"],["class","text-yellow-500 text-xl",4,"ngIf"],["class","text-red-500 text-xl",4,"ngIf"],["class","animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600",4,"ngIf"],[1,"ml-2","text-gray-400","cursor-help",3,"title"],[1,"bg-blue-600","hover:bg-blue-700","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click"],[1,"text-green-500","text-xl"],[1,"text-yellow-500","text-xl"],[1,"text-red-500","text-xl"],[1,"animate-spin","rounded-full","h-5","w-5","border-b-2","border-blue-600"],[1,"bg-purple-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"bg-purple-50","border","border-purple-200","rounded-lg","p-4","mb-4"],[1,"text-purple-700","text-sm","mb-2"],[1,"text-purple-600","text-xs"],[1,"flex","items-center","space-x-4"],[1,"bg-purple-600","hover:bg-purple-700","disabled:bg-gray-400","text-white","px-6","py-3","rounded-lg","font-medium","transition-colors","flex","items-center",3,"click","disabled"],["class","flex items-center",4,"ngIf"],["class","text-green-600 font-medium",4,"ngIf"],[1,"animate-pulse","w-3","h-3","bg-red-500","rounded-full","mr-2"],[1,"text-green-600","font-medium"],[1,"bg-indigo-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"bg-indigo-50","border","border-indigo-200","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-3"],[1,"font-medium","text-indigo-800"],[1,"px-3","py-1","rounded-full","text-sm","font-medium"],["class","space-y-2",4,"ngIf"],[1,"space-y-2"],[1,"text-indigo-600"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-indigo-600","mr-2"],[1,"w-full","bg-green-600","hover:bg-green-700","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","flex","items-center","justify-center",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"ocr-preview-modal",3,"click"],[1,"ocr-preview-container",3,"click"],[1,"ocr-preview-header"],[1,"close-btn",3,"click"],["class","ocr-progress-section",4,"ngIf"],["class","ocr-results",4,"ngIf"],[1,"ocr-progress-section"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-message"],[1,"ocr-results"],[1,"confidence-indicator"],[1,"confidence-label"],[1,"confidence-value"],["class","extracted-data",4,"ngIf"],[1,"raw-text-section"],[1,"raw-text-container"],["readonly","","rows","8",3,"value"],[1,"ocr-actions"],[1,"btn-confirm",3,"click"],[1,"btn-reprocess",3,"click"],[1,"extracted-data"],[1,"data-grid"],["class","data-item",4,"ngFor","ngForOf"],[1,"data-item"],[1,"data-label"],[1,"data-value"]],template:function(i,t){i&1&&C(0,dt,80,58,"div",0),i&2&&p("ngIf",t.flowContext)},dependencies:[pe,ue,me,ve],styles:[".document-upload-flow[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f7fafc,#edf2f7);padding:20px}.animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.transition-all[_ngcontent-%COMP%]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.ocr-preview-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.ocr-preview-container[_ngcontent-%COMP%]{width:90%;max-width:800px;max-height:90vh;background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 20px 40px #0000004d;display:flex;flex-direction:column}.ocr-preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:24px 32px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff}.ocr-preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600}.close-btn[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;width:32px;height:32px;border-radius:50%;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:background .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d}.ocr-progress-section[_ngcontent-%COMP%]{padding:24px 32px;border-bottom:1px solid #e5e7eb}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:12px}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#3b82f6,#1d4ed8);transition:width .3s ease;border-radius:4px}.progress-message[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:14px;text-align:center}.ocr-results[_ngcontent-%COMP%]{flex:1;padding:32px;overflow-y:auto;display:flex;flex-direction:column;gap:24px}.confidence-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;border-radius:8px;font-weight:600}.confidence-indicator.confidence-high[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.confidence-indicator.confidence-medium[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e;border:1px solid #fde68a}.confidence-indicator.confidence-low[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.extracted-data[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#374151;font-size:16px;font-weight:600}.data-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px}.data-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;padding:12px;background:#f9fafb;border-radius:8px;border:1px solid #e5e7eb}.data-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.data-value[_ngcontent-%COMP%]{font-size:14px;color:#374151;font-weight:500;word-break:break-word}.raw-text-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#374151;font-size:16px;font-weight:600}.raw-text-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-family:monospace;font-size:12px;color:#374151;background:#f9fafb;resize:vertical}.ocr-actions[_ngcontent-%COMP%]{display:flex;gap:16px;margin-top:auto}.btn-confirm[_ngcontent-%COMP%], .btn-reprocess[_ngcontent-%COMP%]{flex:1;padding:12px 24px;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;font-size:14px;border:none}.btn-confirm[_ngcontent-%COMP%]{background:#10b981;color:#fff}.btn-confirm[_ngcontent-%COMP%]:hover{background:#059669}.btn-reprocess[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-reprocess[_ngcontent-%COMP%]:hover{background:#e5e7eb}@media (max-width: 768px){.ocr-preview-container[_ngcontent-%COMP%]{width:95%;max-height:95vh}.ocr-preview-header[_ngcontent-%COMP%]{padding:16px 20px}.ocr-results[_ngcontent-%COMP%]{padding:20px;gap:20px}.data-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.ocr-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})}}return o})();export{kt as DocumentUploadFlowComponent};
