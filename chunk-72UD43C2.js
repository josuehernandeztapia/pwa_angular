import{a as A}from"./chunk-XIPGL6BB.js";import{b as Q,e as ee,m as te,p as z}from"./chunk-SCHFUJ5K.js";import{$a as W,Ea as o,Fa as N,R as B,Sa as m,Ta as K,Ua as s,V as L,Va as w,Wa as P,Xa as v,Xb as S,Ya as n,Yb as C,Za as t,_ as U,_a as x,ab as X,bb as k,bc as M,cb as u,da as q,db as p,ea as h,f as H,g as j,hb as J,ib as r,j as I,jb as l,kb as f,la as G,ma as b,na as _,sb as y,tb as Y,va as D,zb as Z}from"./chunk-5IDTUAMZ.js";import{a as T,b as R,g as $}from"./chunk-DM275RSA.js";function se(i,d){if(i&1&&(n(0,"div",32)(1,"span",33),r(2),t()()),i&2){let e=p(2);o(2),l(e.actionData.client.route)}}function le(i,d){if(i&1&&(n(0,"div",36)(1,"span",37),r(2,"\u{1F4C5}"),t(),n(3,"span",38),r(4),t(),n(5,"span",39),r(6,"esperando"),t()()),i&2){let e=p(3);o(4),f("",e.actionData.context.daysWaiting," d\xEDas")}}function de(i,d){if(i&1&&(n(0,"div",36)(1,"span",37),r(2,"\u{1F4B0}"),t(),n(3,"span",38),r(4),t(),n(5,"span",39),r(6,"en juego"),t()()),i&2){let e=p(3);o(4),f("$",e.formatCurrency(e.actionData.context.amountInvolved),"")}}function pe(i,d){if(i&1&&(n(0,"div",36)(1,"span",37),r(2,"\u26A0\uFE0F"),t(),n(3,"span",38),r(4),t(),n(5,"span",39),r(6,"vencimiento"),t()()),i&2){let e=p(3);o(4),l(e.formatDate(e.actionData.context.expirationDate))}}function me(i,d){if(i&1&&(n(0,"div",34),m(1,le,7,1,"div",35)(2,de,7,1,"div",35)(3,pe,7,1,"div",35),t()),i&2){let e=p(2);o(),s("ngIf",e.actionData.context.daysWaiting),o(),s("ngIf",e.actionData.context.amountInvolved),o(),s("ngIf",e.actionData.context.expirationDate)}}function ge(i,d){if(i&1){let e=k();n(0,"button",40),u("click",function(){let c=b(e).$implicit,g=p(2);return _(g.executeAction(c))}),n(1,"span",5),r(2),t(),n(3,"span",29),r(4),t()()}if(i&2){let e=d.$implicit;o(2),l(e.icon),o(2),l(e.label)}}function ue(i,d){if(i&1){let e=k();n(0,"div",1)(1,"div",2)(2,"div",3),x(3,"div",4),n(4,"span",5),r(5),t()(),n(6,"div",6)(7,"h2",7),r(8),t(),n(9,"p",8),r(10,"Tu pr\xF3xima mejor acci\xF3n para maximizar el impacto"),t()(),n(11,"div",9)(12,"span",10),r(13,"\u23F1\uFE0F"),t(),n(14,"span",11),r(15),t()()(),n(16,"div",12)(17,"div",13)(18,"div",14)(19,"div",15),r(20),t(),n(21,"div",16),r(22),t()(),n(23,"div",17)(24,"h3",18),r(25),t(),m(26,se,3,1,"div",19),n(27,"p",20),r(28),t()()(),n(29,"div",21)(30,"div",22)(31,"span",23),r(32,"\u{1F9E0}"),t(),n(33,"span",24),r(34,"Inteligencia de Negocio"),t()(),n(35,"p",25),r(36),t(),m(37,me,4,3,"div",26),t()(),n(38,"div",27)(39,"button",28),u("click",function(){b(e);let c=p();return _(c.executeAction(c.actionData.suggestedActions.primary))}),n(40,"span",5),r(41),t(),n(42,"span",29),r(43),t()(),n(44,"div",30),m(45,ge,5,2,"button",31),t()()()}if(i&2){let e=p();o(3),v("priority-"+e.actionData.priority),o(2),l(e.getActionIcon()),o(3),l(e.actionData.action.title),o(7),l(e.actionData.action.timeEstimate),o(4),w("background-image",e.getAvatarUrl()),o(),f(" ",e.actionData.client.avatar?"":e.getInitials()," "),o(),v(e.getHealthScoreClass()),o(),f(" ",e.actionData.client.healthScore," "),o(3),l(e.actionData.client.name),o(),s("ngIf",e.actionData.client.route),o(2),l(e.actionData.action.description),o(8),l(e.actionData.action.reasoning),o(),s("ngIf",e.hasContextMetrics()),o(4),l(e.actionData.suggestedActions.primary.icon),o(2),l(e.actionData.suggestedActions.primary.label),o(2),s("ngForOf",e.actionData.suggestedActions.secondary)}}var ne=(()=>{class i{constructor(){this.actionExecuted=new D}ngOnInit(){}getActionIcon(){return this.actionData&&{contact:"\u{1F4DE}",document:"\u{1F4C4}",renewal:"\u{1F504}",opportunity:"\u{1F4A1}",payment:"\u{1F4B0}"}[this.actionData.type]||"\u{1F3AF}"}getAvatarUrl(){return this.actionData?.client.avatar?`url(${this.actionData.client.avatar})`:""}getInitials(){return this.actionData?.client.name?this.actionData.client.name.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"?"}getHealthScoreClass(){if(!this.actionData?.client.healthScore)return"health-critical";let e=this.actionData.client.healthScore;return e>=80?"health-excellent":e>=65?"health-good":e>=40?"health-warning":"health-critical"}hasContextMetrics(){return this.actionData?.context?!!(this.actionData.context.daysWaiting||this.actionData.context.amountInvolved||this.actionData.context.expirationDate):!1}formatCurrency(e){return new Intl.NumberFormat("es-MX",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}formatDate(e){return new Date(e).toLocaleDateString("es-MX",{month:"short",day:"numeric"})}executeAction(e){this.actionData&&this.actionExecuted.emit({action:e,context:this.actionData})}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-next-best-action-hero"]],inputs:{actionData:[q.None,"data","actionData"]},outputs:{actionExecuted:"actionExecuted"},standalone:!0,features:[y],decls:1,vars:1,consts:[["class","next-best-action-hero",4,"ngIf"],[1,"next-best-action-hero"],[1,"hero-header"],[1,"action-indicator"],[1,"priority-pulse"],[1,"action-icon"],[1,"hero-title-section"],[1,"hero-title"],[1,"hero-subtitle"],[1,"time-indicator"],[1,"time-icon"],[1,"time-text"],[1,"hero-content"],[1,"client-context"],[1,"client-avatar"],[1,"avatar-image"],[1,"health-score"],[1,"client-details"],[1,"client-name"],["class","client-meta",4,"ngIf"],[1,"action-description"],[1,"action-reasoning"],[1,"reasoning-header"],[1,"reasoning-icon"],[1,"reasoning-title"],[1,"reasoning-text"],["class","context-metrics",4,"ngIf"],[1,"hero-actions"],[1,"btn-accent","primary-action",3,"click"],[1,"action-text"],[1,"secondary-actions"],["class","btn-primary secondary-action",3,"click",4,"ngFor","ngForOf"],[1,"client-meta"],[1,"route-badge"],[1,"context-metrics"],["class","metric",4,"ngIf"],[1,"metric"],[1,"metric-icon"],[1,"metric-value"],[1,"metric-label"],[1,"btn-primary","secondary-action",3,"click"]],template:function(a,c){a&1&&m(0,ue,46,19,"div",0),a&2&&s("ngIf",c.actionData)},dependencies:[M,S,C,z],styles:['.next-best-action-hero[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:var(--glass-backdrop);-webkit-backdrop-filter:var(--glass-backdrop);border-radius:20px;padding:32px;margin-bottom:32px;position:relative;overflow:hidden}.next-best-action-hero[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--accent-amber-500),var(--primary-cyan-400));opacity:.8}.hero-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:24px}.action-indicator[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;justify-content:center;width:60px;height:60px;border-radius:50%;background:#f59e0b1a;border:2px solid var(--accent-amber-500)}.priority-pulse[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border-radius:50%;animation:_ngcontent-%COMP%_pulse-priority 2s infinite}.priority-critical[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--error-500) 0%,transparent 70%)}.priority-high[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--accent-amber-500) 0%,transparent 70%)}.priority-medium[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--primary-cyan-400) 0%,transparent 70%)}@keyframes _ngcontent-%COMP%_pulse-priority{0%{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.05)}to{opacity:1;transform:scale(1)}}.action-icon[_ngcontent-%COMP%]{font-size:1.8rem;z-index:2;position:relative}.hero-title-section[_ngcontent-%COMP%]{flex:1}.hero-title[_ngcontent-%COMP%]{color:var(--accent-amber-400);font-size:1.8rem;font-weight:700;margin:0 0 4px;line-height:1.2}.hero-subtitle[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:.95rem;margin:0;opacity:.9}.time-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#22d3ee1a;border:1px solid var(--primary-cyan-400);border-radius:12px;padding:8px 16px}.time-icon[_ngcontent-%COMP%]{font-size:1.1rem}.time-text[_ngcontent-%COMP%]{color:var(--primary-cyan-300);font-weight:600;font-size:.9rem}.hero-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:32px;margin-bottom:32px}.client-context[_ngcontent-%COMP%]{display:flex;gap:16px}.client-avatar[_ngcontent-%COMP%]{position:relative;flex-shrink:0}.avatar-image[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,var(--primary-cyan-400),var(--primary-cyan-600));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1.2rem;background-size:cover;background-position:center;border:3px solid var(--glass-border)}.health-score[_ngcontent-%COMP%]{position:absolute;bottom:-4px;right:-4px;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;border:2px solid var(--bg-gray-950)}.health-excellent[_ngcontent-%COMP%]{background:var(--success-500);color:#fff}.health-good[_ngcontent-%COMP%]{background:var(--primary-cyan-400);color:#fff}.health-warning[_ngcontent-%COMP%]{background:var(--accent-amber-500);color:var(--bg-gray-950)}.health-critical[_ngcontent-%COMP%]{background:var(--error-500);color:#fff}.client-details[_ngcontent-%COMP%]{flex:1}.client-name[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.3rem;font-weight:700;margin:0 0 8px}.client-meta[_ngcontent-%COMP%]{margin-bottom:12px}.route-badge[_ngcontent-%COMP%]{background:#22d3ee33;color:var(--primary-cyan-300);padding:4px 10px;border-radius:8px;font-size:.8rem;font-weight:600}.action-description[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:1rem;line-height:1.5;margin:0}.action-reasoning[_ngcontent-%COMP%]{background:#f59e0b0d;border:1px solid rgba(245,158,11,.2);border-radius:16px;padding:20px}.reasoning-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-bottom:12px}.reasoning-icon[_ngcontent-%COMP%]{font-size:1.2rem}.reasoning-title[_ngcontent-%COMP%]{color:var(--accent-amber-400);font-weight:600;font-size:1rem}.reasoning-text[_ngcontent-%COMP%]{color:var(--bg-gray-200);font-size:.95rem;line-height:1.6;margin:0 0 16px}.context-metrics[_ngcontent-%COMP%]{display:flex;gap:20px;flex-wrap:wrap}.metric[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;background:#f59e0b1a;border-radius:10px;padding:8px 12px}.metric-icon[_ngcontent-%COMP%]{font-size:.9rem}.metric-value[_ngcontent-%COMP%]{color:var(--accent-amber-300);font-weight:700;font-size:.9rem}.metric-label[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.8rem}.hero-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex-wrap:wrap}.primary-action[_ngcontent-%COMP%]{padding:16px 32px;font-size:1.1rem;font-weight:700;border-radius:16px;display:flex;align-items:center;gap:12px;min-width:200px;justify-content:center}.secondary-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.secondary-action[_ngcontent-%COMP%]{padding:12px 20px;font-size:.95rem;font-weight:600;border-radius:12px;display:flex;align-items:center;gap:8px}.action-icon[_ngcontent-%COMP%]{font-size:1.1rem}@media (max-width: 768px){.next-best-action-hero[_ngcontent-%COMP%]{padding:24px}.hero-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.action-indicator[_ngcontent-%COMP%]{width:50px;height:50px}.action-icon[_ngcontent-%COMP%], .hero-title[_ngcontent-%COMP%]{font-size:1.5rem}.hero-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:24px}.context-metrics[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.hero-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.primary-action[_ngcontent-%COMP%]{min-width:auto}.secondary-actions[_ngcontent-%COMP%]{justify-content:center}}']})}}return i})();function fe(i,d){if(i&1&&(n(0,"div",16)(1,"span",17),r(2),t(),n(3,"span",18),r(4),t()()),i&2){let e=p().$implicit,a=p();v("trend-"+e.trend),o(2),l(a.getTrendIcon(e.trend)),o(2),f("",e.trendPercentage,"%")}}function ve(i,d){if(i&1&&(n(0,"div",19),r(1),t()),i&2){let e=p().$implicit;o(),l(e.subtitle)}}function xe(i,d){if(i&1&&(n(0,"div",6)(1,"div",7)(2,"div",8),r(3),t(),m(4,fe,5,4,"div",9),t(),n(5,"div",10)(6,"div",11),r(7),t(),n(8,"div",12),r(9),t(),m(10,ve,2,1,"div",13),t(),n(11,"div",14),x(12,"div",15),t()()),i&2){let e=d.$implicit,a=p();v("kpi-"+e.color),o(3),l(e.icon),o(),s("ngIf",a.showTrends),o(3),l(a.formatValue(e.value,e.format)),o(2),l(e.title),o(),s("ngIf",e.subtitle),o(2),v("trend-fill-"+e.trend),w("width",a.Math.abs(e.trendPercentage),"%")}}var ie=(()=>{class i{constructor(){this.kpis=[],this.showTrends=!1,this.Math=Math}ngOnInit(){}trackByKPI(e,a){return a.id}getTrendIcon(e){return{up:"\u25B2",down:"\u25BC",stable:"\u2192"}[e]}formatValue(e,a){if(typeof e=="string")return e;switch(a){case"currency":return"$"+new Intl.NumberFormat("es-MX",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);case"percentage":return e.toFixed(1)+"%";case"number":default:return new Intl.NumberFormat("es-MX").format(e)}}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-contextual-kpis"]],inputs:{kpis:"kpis",showTrends:"showTrends"},standalone:!0,features:[y],decls:8,vars:2,consts:[[1,"contextual-kpis-container"],[1,"kpis-header"],[1,"kpis-title"],[1,"kpis-subtitle"],[1,"kpis-grid"],["class","kpi-card",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"kpi-card"],[1,"kpi-header"],[1,"kpi-icon"],["class","kpi-trend",3,"class",4,"ngIf"],[1,"kpi-content"],[1,"kpi-value"],[1,"kpi-title-text"],["class","kpi-subtitle",4,"ngIf"],[1,"kpi-trend-bar"],[1,"trend-fill"],[1,"kpi-trend"],[1,"trend-icon"],[1,"trend-percentage"],[1,"kpi-subtitle"]],template:function(a,c){a&1&&(n(0,"div",0)(1,"div",1)(2,"h3",2),r(3,"\u{1F4CA} KPIs Clave"),t(),n(4,"p",3),r(5,"vs. Semana Pasada"),t()(),n(6,"div",4),m(7,xe,13,11,"div",5),t()()),a&2&&(o(7),s("ngForOf",c.kpis)("ngForTrackBy",c.trackByKPI))},dependencies:[M,S,C],styles:['.contextual-kpis-container[_ngcontent-%COMP%]{margin-bottom:32px}.kpis-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.kpis-title[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.5rem;font-weight:700;margin:0}.kpis-subtitle[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.9rem;margin:0;font-weight:500}.kpis-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}.kpi-card[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:var(--glass-backdrop);-webkit-backdrop-filter:var(--glass-backdrop);border-radius:16px;padding:24px;position:relative;transition:all .3s ease;overflow:hidden}.kpi-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:var(--shadow-elevated)}.kpi-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:3px;border-radius:16px 16px 0 0}.kpi-primary[_ngcontent-%COMP%]:before{background:var(--primary-cyan-400)}.kpi-accent[_ngcontent-%COMP%]:before{background:var(--accent-amber-500)}.kpi-success[_ngcontent-%COMP%]:before{background:var(--success-500)}.kpi-warning[_ngcontent-%COMP%]:before{background:var(--warning-500)}.kpi-error[_ngcontent-%COMP%]:before{background:var(--error-500)}.kpi-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.kpi-icon[_ngcontent-%COMP%]{font-size:2rem;opacity:.8}.kpi-trend[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:6px 12px;border-radius:20px;font-size:.8rem;font-weight:600}.trend-up[_ngcontent-%COMP%]{background:#10b9811a;border:1px solid var(--success-500);color:var(--success-500)}.trend-down[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid var(--error-500);color:var(--error-500)}.trend-stable[_ngcontent-%COMP%]{background:#9ca3af1a;border:1px solid var(--bg-gray-500);color:var(--bg-gray-400)}.trend-icon[_ngcontent-%COMP%]{font-size:.9rem}.kpi-content[_ngcontent-%COMP%]{text-align:left}.kpi-value[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:800;line-height:1;margin-bottom:8px;background:linear-gradient(135deg,var(--bg-gray-100),var(--bg-gray-300));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.kpi-primary[_ngcontent-%COMP%]   .kpi-value[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-cyan-300),var(--primary-cyan-500));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.kpi-accent[_ngcontent-%COMP%]   .kpi-value[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-amber-400),var(--accent-amber-600));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.kpi-title-text[_ngcontent-%COMP%]{color:var(--bg-gray-200);font-size:1rem;font-weight:600;margin-bottom:4px}.kpi-subtitle[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.85rem}.kpi-trend-bar[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:4px;background:#ffffff0d;overflow:hidden}.trend-fill[_ngcontent-%COMP%]{height:100%;transition:width .8s ease-out;border-radius:0 4px 4px 0}.trend-fill-up[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--success-500),var(--success-400))}.trend-fill-down[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--error-500),var(--error-400))}.trend-fill-stable[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--bg-gray-500),var(--bg-gray-400))}@media (max-width: 768px){.kpis-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.kpi-card[_ngcontent-%COMP%]{padding:20px}.kpi-value[_ngcontent-%COMP%]{font-size:2rem}.kpis-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}}']})}}return i})();var he=()=>[1,2,3,4];function be(i,d){if(i&1&&(n(0,"div",20),x(1,"div",21),n(2,"span",22),r(3),t()()),i&2){let e=d.$implicit;o(),v("risk-"+e.key),o(2),l(e.label)}}function _e(i,d){if(i&1&&x(0,"div",23),i&2){let e=d.$implicit;w("width",e*25,"%")("height",e*25,"%")}}function ye(i,d){if(i&1){let e=k();n(0,"div",24),u("click",function(){let c=b(e).$implicit,g=p();return _(g.selectClient(c))}),x(1,"div",25),n(2,"div",26),r(3),t()()}if(i&2){let e=d.$implicit,a=p();v("risk-"+e.riskLevel),w("left",e.position.x,"%")("top",e.position.y,"%"),s("title",a.getClientTooltip(e)),o(),v("pulse-"+e.riskLevel),o(2),l(a.getClientInitials(e.name))}}function Ce(i,d){if(i&1&&(n(0,"li"),r(1),t()),i&2){let e=d.$implicit;o(),l(e)}}function Me(i,d){if(i&1&&(n(0,"div",41)(1,"h5",42),r(2,"Issues Identificados:"),t(),n(3,"ul",43),m(4,Ce,2,1,"li",44),t()()),i&2){let e=p(2);o(4),s("ngForOf",e.selectedClient.issues)}}function Pe(i,d){if(i&1){let e=k();n(0,"div",27)(1,"div",28)(2,"h4",29),r(3),t(),n(4,"button",30),u("click",function(){b(e);let c=p();return _(c.selectedClient=void 0)}),r(5,"\xD7"),t()(),n(6,"div",31)(7,"div",32)(8,"span",33),r(9,"Health Score:"),t(),n(10,"span",34),r(11),t()(),n(12,"div",35)(13,"div",36)(14,"span",37),r(15,"\u{1F4B0}"),t(),n(16,"span",38),r(17),t()(),n(18,"div",36)(19,"span",37),r(20,"\u{1F4C5}"),t(),n(21,"span",38),r(22),t()(),n(23,"div",36)(24,"span",37),r(25,"\u26A0\uFE0F"),t(),n(26,"span",38),r(27),t()()(),m(28,Me,5,1,"div",39),n(29,"button",40),u("click",function(){b(e);let c=p();return _(c.takeAction(c.selectedClient))}),n(30,"span"),r(31,"\u{1F3AF}"),t(),r(32," Tomar Acci\xF3n "),t()()()}if(i&2){let e=p();o(3),l(e.selectedClient.name),o(7),v(e.getHealthScoreClass(e.selectedClient.healthScore)),o(),f(" ",e.selectedClient.healthScore," "),o(6),f("$",e.formatCurrency(e.selectedClient.value),""),o(5),l(e.selectedClient.lastContact),o(5),f("Urgencia: ",e.selectedClient.urgency,"/10"),o(),s("ngIf",e.selectedClient.issues.length>0)}}function ke(i,d){if(i&1&&(n(0,"div",45)(1,"div",46),r(2),t(),n(3,"div",47),r(4),t()()),i&2){let e=d.$implicit;o(),w("color",e.color),o(),l(e.value),o(2),l(e.label)}}var ae=(()=>{class i{constructor(){this.clients=[],this.clientSelected=new D,this.actionRequested=new D,this.riskLevels=[{key:"low",label:"Bajo"},{key:"medium",label:"Medio"},{key:"high",label:"Alto"},{key:"critical",label:"Cr\xEDtico"}]}ngOnInit(){}trackByClient(e,a){return a.id}getClientInitials(e){return e.split(" ").map(a=>a[0]).join("").toUpperCase().substring(0,2)}getClientTooltip(e){return`${e.name} - Health Score: ${e.healthScore} - Issues: ${e.issues.length}`}getHealthScoreClass(e){return e>=80?"health-excellent":e>=65?"health-good":e>=40?"health-warning":"health-critical"}formatCurrency(e){return new Intl.NumberFormat("es-MX",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}selectClient(e){this.selectedClient=e,this.clientSelected.emit(e)}takeAction(e){this.actionRequested.emit(e)}getRadarStats(){let e=this.clients.reduce((a,c)=>(a[c.riskLevel]=(a[c.riskLevel]||0)+1,a),{});return[{value:e.critical||0,label:"Cr\xEDticos",color:"var(--error-500)"},{value:e.high||0,label:"Alto Riesgo",color:"var(--warning-500)"},{value:e.medium||0,label:"Atenci\xF3n",color:"var(--accent-amber-500)"},{value:e.low||0,label:"Estables",color:"var(--success-500)"}]}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-risk-radar"]],inputs:{clients:"clients"},outputs:{clientSelected:"clientSelected",actionRequested:"actionRequested"},standalone:!0,features:[y],decls:26,vars:7,consts:[[1,"risk-radar-container"],[1,"radar-header"],[1,"radar-title-section"],[1,"radar-title"],[1,"radar-subtitle"],[1,"radar-legend"],["class","legend-item",4,"ngFor","ngForOf"],[1,"radar-visualization"],[1,"radar-grid"],["class","radar-circle",3,"width","height",4,"ngFor","ngForOf"],[1,"radar-axis","horizontal"],[1,"radar-axis","vertical"],[1,"risk-zone-label","safe"],[1,"risk-zone-label","warning"],[1,"risk-zone-label","danger"],[1,"risk-zone-label","critical"],["class","client-dot",3,"class","left","top","title","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","client-info-panel",4,"ngIf"],[1,"radar-stats"],["class","stat-item",4,"ngFor","ngForOf"],[1,"legend-item"],[1,"legend-dot"],[1,"legend-text"],[1,"radar-circle"],[1,"client-dot",3,"click","title"],[1,"client-pulse"],[1,"client-initials"],[1,"client-info-panel"],[1,"client-info-header"],[1,"client-info-name"],[1,"close-info",3,"click"],[1,"client-info-content"],[1,"health-score-display"],[1,"health-label"],[1,"health-value"],[1,"client-metrics"],[1,"metric"],[1,"metric-icon"],[1,"metric-text"],["class","client-issues",4,"ngIf"],[1,"btn-accent","take-action-btn",3,"click"],[1,"client-issues"],[1,"issues-title"],[1,"issues-list"],[4,"ngFor","ngForOf"],[1,"stat-item"],[1,"stat-value"],[1,"stat-label"]],template:function(a,c){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),r(4,"\u{1F525} Radar de Riesgo"),t(),n(5,"p",4),r(6,"Visualizaci\xF3n proactiva de la salud de tu cartera"),t()(),n(7,"div",5),m(8,be,4,3,"div",6),t()(),n(9,"div",7)(10,"div",8),m(11,_e,1,4,"div",9),x(12,"div",10)(13,"div",11),n(14,"div",12),r(15,"Zona Segura"),t(),n(16,"div",13),r(17,"Atenci\xF3n"),t(),n(18,"div",14),r(19,"Riesgo Alto"),t(),n(20,"div",15),r(21,"Cr\xEDtico"),t(),m(22,ye,4,10,"div",16),t(),m(23,Pe,33,8,"div",17),t(),n(24,"div",18),m(25,ke,5,4,"div",19),t()()),a&2&&(o(8),s("ngForOf",c.riskLevels),o(3),s("ngForOf",Y(6,he)),o(11),s("ngForOf",c.clients)("ngForTrackBy",c.trackByClient),o(),s("ngIf",c.selectedClient),o(2),s("ngForOf",c.getRadarStats()))},dependencies:[M,S,C],styles:['@charset "UTF-8";.risk-radar-container[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:var(--glass-backdrop);-webkit-backdrop-filter:var(--glass-backdrop);border-radius:20px;padding:28px;margin-bottom:32px;position:relative}.radar-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px;gap:20px}.radar-title[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.5rem;font-weight:700;margin:0 0 4px}.radar-subtitle[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.9rem;margin:0}.radar-legend[_ngcontent-%COMP%]{display:flex;gap:16px;flex-wrap:wrap}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.legend-dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.legend-text[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:.85rem;font-weight:500}.risk-low[_ngcontent-%COMP%]{background:var(--success-500)}.risk-medium[_ngcontent-%COMP%]{background:var(--accent-amber-500)}.risk-high[_ngcontent-%COMP%]{background:var(--warning-500)}.risk-critical[_ngcontent-%COMP%]{background:var(--error-500)}.radar-visualization[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:1fr 300px;gap:24px;min-height:400px}.radar-grid[_ngcontent-%COMP%]{position:relative;aspect-ratio:1;background:radial-gradient(circle,#10b9811a,#f59e0b1a 40%,#f973161a,#ef44441a);border-radius:50%;border:1px solid var(--glass-border);overflow:visible}.radar-circle[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border:1px solid rgba(255,255,255,.1);border-radius:50%}.radar-axis[_ngcontent-%COMP%]{position:absolute;background:#ffffff1a}.radar-axis.horizontal[_ngcontent-%COMP%]{top:50%;left:0;right:0;height:1px;transform:translateY(-50%)}.radar-axis.vertical[_ngcontent-%COMP%]{left:50%;top:0;bottom:0;width:1px;transform:translate(-50%)}.risk-zone-label[_ngcontent-%COMP%]{position:absolute;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;opacity:.6}.risk-zone-label.safe[_ngcontent-%COMP%]{top:45%;left:45%;color:var(--success-400)}.risk-zone-label.warning[_ngcontent-%COMP%]{top:25%;left:35%;color:var(--accent-amber-400)}.risk-zone-label.danger[_ngcontent-%COMP%]{top:15%;left:25%;color:var(--warning-500)}.risk-zone-label.critical[_ngcontent-%COMP%]{top:8%;left:15%;color:var(--error-500)}.client-dot[_ngcontent-%COMP%]{position:absolute;width:32px;height:32px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transform:translate(-50%,-50%);transition:all .3s ease;border:2px solid rgba(255,255,255,.2)}.client-dot[_ngcontent-%COMP%]:hover{transform:translate(-50%,-50%) scale(1.2);z-index:10}.client-pulse[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;border-radius:50%;animation:_ngcontent-%COMP%_pulse-radar 2s infinite}.pulse-critical[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--error-500) 0%,transparent 70%)}.pulse-high[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--warning-500) 0%,transparent 70%)}.pulse-medium[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--accent-amber-500) 0%,transparent 70%)}.pulse-low[_ngcontent-%COMP%]{background:radial-gradient(circle,var(--success-500) 0%,transparent 70%)}@keyframes _ngcontent-%COMP%_pulse-radar{0%{opacity:1;transform:scale(1)}50%{opacity:.5;transform:scale(1.3)}to{opacity:1;transform:scale(1)}}.client-initials[_ngcontent-%COMP%]{color:#fff;font-size:.7rem;font-weight:700;z-index:2}.client-info-panel[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);border-radius:16px;padding:20px;max-height:400px;overflow-y:auto}.client-info-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,.1)}.client-info-name[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.2rem;font-weight:700;margin:0}.close-info[_ngcontent-%COMP%]{background:none;border:none;color:var(--bg-gray-400);font-size:1.5rem;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s ease}.close-info[_ngcontent-%COMP%]:hover{background:#ffffff1a;color:var(--bg-gray-200)}.health-score-display[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:12px;background:#ffffff0d;border-radius:8px}.health-label[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-weight:600}.health-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:800}.health-excellent[_ngcontent-%COMP%]{color:var(--success-500)}.health-good[_ngcontent-%COMP%]{color:var(--primary-cyan-400)}.health-warning[_ngcontent-%COMP%]{color:var(--accent-amber-500)}.health-critical[_ngcontent-%COMP%]{color:var(--error-500)}.client-metrics[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:16px}.metric[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:var(--bg-gray-300);font-size:.9rem}.metric-icon[_ngcontent-%COMP%]{font-size:1rem}.client-issues[_ngcontent-%COMP%]{margin-bottom:16px}.issues-title[_ngcontent-%COMP%]{color:var(--accent-amber-400);font-size:.9rem;font-weight:600;margin:0 0 8px;text-transform:uppercase;letter-spacing:.5px}.issues-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.issues-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:.85rem;padding:4px 0 4px 16px;position:relative}.issues-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:"\\2022";color:var(--error-500);position:absolute;left:0}.take-action-btn[_ngcontent-%COMP%]{width:100%;padding:12px 16px;font-size:.95rem;font-weight:600;border-radius:12px;display:flex;align-items:center;justify-content:center;gap:8px}.radar-stats[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:24px;padding-top:20px;border-top:1px solid rgba(255,255,255,.1)}.stat-item[_ngcontent-%COMP%]{text-align:center}.stat-value[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:800;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.85rem;text-transform:uppercase;letter-spacing:.5px}@media (max-width: 768px){.radar-visualization[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.radar-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.radar-legend[_ngcontent-%COMP%]{justify-content:center}.radar-stats[_ngcontent-%COMP%]{flex-wrap:wrap;gap:16px}}']})}}return i})();function Oe(i,d){i&1&&x(0,"div",26)}function we(i,d){i&1&&(n(0,"div",27)(1,"span",28),r(2,"\u{1F525}"),t()())}function Se(i,d){if(i&1&&(W(0),r(1),n(2,"span",29),r(3),t(),X()),i&2){let e=d.ngIf,a=p().$implicit;o(),f(" ",(a.description==null?null:a.description.replace(e,""))||a.description," "),o(2),l(e)}}function De(i,d){if(i&1&&r(0),i&2){let e=p().$implicit;l(e.description)}}function Ie(i,d){if(i&1&&(n(0,"div",32)(1,"span",33),r(2,"\u{1F4B0}"),t(),n(3,"span",34),r(4),t()()),i&2){let e=p(2).$implicit,a=p();o(4),f("$",a.formatCurrency((e.metadata==null?null:e.metadata.amount)||0),"")}}function Ee(i,d){if(i&1&&(n(0,"div",32)(1,"span",33),r(2,"\u{1F4C4}"),t(),n(3,"span",34),r(4),t()()),i&2){let e=p(2).$implicit;o(4),l(e.metadata==null?null:e.metadata.documentType)}}function Ae(i,d){if(i&1&&(n(0,"div",32)(1,"span",33),r(2,"\u{1F4F1}"),t(),n(3,"span",34),r(4),t()()),i&2){let e=p(2).$implicit;o(4),l(e.metadata==null?null:e.metadata.channel)}}function Fe(i,d){if(i&1&&(n(0,"div",30),m(1,Ie,5,1,"div",31)(2,Ee,5,1,"div",31)(3,Ae,5,1,"div",31),t()),i&2){let e=p().$implicit;o(),s("ngIf",e.metadata==null?null:e.metadata.amount),o(),s("ngIf",e.metadata==null?null:e.metadata.documentType),o(),s("ngIf",e.metadata==null?null:e.metadata.channel)}}function ze(i,d){if(i&1){let e=k();n(0,"button",35),u("click",function(){b(e);let c=p().$implicit,g=p();return _(g.executeSuggestedAction(c))}),n(1,"span",36),r(2),t(),n(3,"span",37),r(4),t()()}if(i&2){let e=p().$implicit,a=p();o(2),l(a.getSuggestedActionIcon(e.category)),o(2),l(e.suggestedAction.label)}}function Te(i,d){if(i&1&&(n(0,"div",10)(1,"div",11)(2,"div",12),r(3),t(),m(4,Oe,1,0,"div",13),t(),n(5,"div",14)(6,"div",15)(7,"div",16)(8,"span",17),r(9),t(),n(10,"span",18),r(11),t()(),m(12,we,3,0,"div",19),t(),n(13,"div",20)(14,"h4",21),r(15),t(),n(16,"p",22),m(17,Se,4,2,"ng-container",23)(18,De,1,1,"ng-template",null,0,Z),t(),m(20,Fe,4,3,"div",24)(21,ze,5,2,"button",25),t()()()),i&2){let e=d.$implicit,a=J(19),c=p();v("priority-"+e.priority),o(2),v("category-"+e.category),o(),f(" ",c.getCategoryIcon(e.category)," "),o(),s("ngIf",!c.isLastItem(e)),o(4),v("type-"+e.type),o(),f(" ",c.getTypeLabel(e.type)," "),o(2),l(c.formatTime(e.timestamp)),o(),s("ngIf",e.priority==="high"),o(3),l(e.title),o(2),s("ngIf",e.client==null?null:e.client.name)("ngIfElse",a),o(3),s("ngIf",c.hasMetadata(e)),o(),s("ngIf",e.suggestedAction)}}function Re(i,d){i&1&&(n(0,"div",38)(1,"div",39),r(2,"\u{1F4ED}"),t(),n(3,"h4",40),r(4,"Sin actividad reciente"),t(),n(5,"p",41),r(6," Las nuevas actividades aparecer\xE1n aqu\xED en tiempo real "),t()())}function Ne(i,d){if(i&1){let e=k();n(0,"div",42)(1,"button",43),u("click",function(){b(e);let c=p();return _(c.loadMoreActivities())}),n(2,"span"),r(3,"\u2B07\uFE0F"),t(),r(4," Cargar m\xE1s actividades "),t()()}}var oe=(()=>{class i{constructor(){this.activities=[],this.maxItems=10,this.showSuggestedActions=!1,this.selectedFilter="all",this.filteredActivities=[]}ngOnInit(){this.updateFilteredActivities()}ngOnChanges(){this.updateFilteredActivities()}trackByActivity(e,a){return a.id}setFilter(e){this.selectedFilter=e,this.updateFilteredActivities()}updateFilteredActivities(){let e=[...this.activities];switch(this.maxItems>0&&(e=e.slice(0,this.maxItems)),this.selectedFilter){case"actions":this.filteredActivities=e.filter(a=>this.showSuggestedActions&&a.suggestedAction||a.priority==="high");break;case"achievements":this.filteredActivities=e.filter(a=>a.category==="achievement"||a.category==="payment");break;default:this.filteredActivities=e}}getCategoryIcon(e){return{payment:"\u{1F4B0}",document:"\u{1F4C4}",communication:"\u{1F4AC}",opportunity:"\u{1F4A1}",renewal:"\u{1F504}",achievement:"\u{1F3C6}"}[e]||"\u{1F4CB}"}getTypeLabel(e){return{system:"Sistema",advisor:"Asesor",client:"Cliente",automated:"Auto"}[e]||e}getSuggestedActionIcon(e){return{payment:"\u{1F44F}",document:"\u{1F4CE}",communication:"\u{1F4DE}",opportunity:"\u{1F3AF}",renewal:"\u23F0",achievement:"\u{1F389}"}[e]||"\u27A1\uFE0F"}formatTime(e){let c=new Date().getTime()-e.getTime(),g=Math.floor(c/(1e3*60)),O=Math.floor(c/(1e3*60*60)),V=Math.floor(c/(1e3*60*60*24));return g<1?"hace un momento":g<60?`hace ${g} min`:O<24?`hace ${O}h`:V===1?"ayer":`hace ${V} d\xEDas`}formatDescription(e){let a=e.description;return e.client?.name&&(a=a.replace(e.client.name,`<span class="client-name">${e.client.name}</span>`)),e.suggestedAction&&["\xA1Felic\xEDtalo!","\xA1Ll\xE1malo!","\xA1Revisalo!","\xA1Contactalo!"].forEach(g=>{a=a.replace(g,`<span class="action-suggestion">${g}</span>`)}),a}formatCurrency(e){return new Intl.NumberFormat("es-MX",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}hasMetadata(e){return!!(e.metadata?.amount||e.metadata?.documentType||e.metadata?.channel)}isLastItem(e){return this.filteredActivities.indexOf(e)===this.filteredActivities.length-1}executeSuggestedAction(e){e.suggestedAction&&console.log("Executing suggested action:",e.suggestedAction)}loadMoreActivities(){console.log("Loading more activities...")}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-human-activity-feed"]],inputs:{activities:"activities",maxItems:"maxItems",showSuggestedActions:"showSuggestedActions"},standalone:!0,features:[G,y],decls:15,vars:10,consts:[["plainDesc",""],[1,"activity-feed-container"],[1,"feed-header"],[1,"feed-title"],[1,"feed-controls"],[1,"filter-btn",3,"click"],[1,"activity-stream"],["class","activity-item",3,"class",4,"ngFor","ngForOf","ngForTrackBy"],["class","feed-empty",4,"ngIf"],["class","feed-footer",4,"ngIf"],[1,"activity-item"],[1,"activity-timeline"],[1,"activity-dot"],["class","timeline-line",4,"ngIf"],[1,"activity-content"],[1,"activity-header"],[1,"activity-meta"],[1,"activity-type"],[1,"activity-time"],["class","activity-priority",4,"ngIf"],[1,"activity-body"],[1,"activity-title"],[1,"activity-description"],[4,"ngIf","ngIfElse"],["class","activity-metadata",4,"ngIf"],["class","suggested-action-btn",3,"click",4,"ngIf"],[1,"timeline-line"],[1,"activity-priority"],[1,"priority-indicator"],[1,"client-name"],[1,"activity-metadata"],["class","metadata-item",4,"ngIf"],[1,"metadata-item"],[1,"metadata-icon"],[1,"metadata-text"],[1,"suggested-action-btn",3,"click"],[1,"action-icon"],[1,"action-text"],[1,"feed-empty"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-description"],[1,"feed-footer"],[1,"load-more-btn",3,"click"]],template:function(a,c){a&1&&(n(0,"div",1)(1,"div",2)(2,"h3",3),r(3,"\u{1F6F0}\uFE0F Feed de Actividad en Tiempo Real"),t(),n(4,"div",4)(5,"button",5),u("click",function(){return c.setFilter("all")}),r(6," Todos "),t(),n(7,"button",5),u("click",function(){return c.setFilter("actions")}),r(8," Acciones "),t(),n(9,"button",5),u("click",function(){return c.setFilter("achievements")}),r(10," Logros "),t()()(),n(11,"div",6),m(12,Te,22,16,"div",7)(13,Re,7,0,"div",8),t(),m(14,Ne,5,0,"div",9),t()),a&2&&(o(5),P("active",c.selectedFilter==="all"),o(2),P("active",c.selectedFilter==="actions"),o(2),P("active",c.selectedFilter==="achievements"),o(3),s("ngForOf",c.filteredActivities)("ngForTrackBy",c.trackByActivity),o(),s("ngIf",c.filteredActivities.length===0),o(),s("ngIf",c.activities.length>0))},dependencies:[M,S,C],styles:[".activity-feed-container[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:var(--glass-backdrop);-webkit-backdrop-filter:var(--glass-backdrop);border-radius:20px;padding:28px;margin-bottom:32px}.feed-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.feed-title[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.5rem;font-weight:700;margin:0}.feed-controls[_ngcontent-%COMP%]{display:flex;gap:8px}.filter-btn[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:var(--bg-gray-300);padding:8px 16px;border-radius:20px;font-size:.85rem;font-weight:500;cursor:pointer;transition:all .2s ease}.filter-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a}.filter-btn.active[_ngcontent-%COMP%]{background:var(--primary-cyan-400);border-color:var(--primary-cyan-400);color:#fff}.activity-stream[_ngcontent-%COMP%]{max-height:500px;overflow-y:auto;padding-right:8px}.activity-stream[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.activity-stream[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff0d;border-radius:2px}.activity-stream[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--primary-cyan-600);border-radius:2px}.activity-item[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;opacity:0;animation:fadeInUp .6s ease-out forwards}.activity-item.priority-high[_ngcontent-%COMP%]{background:#f59e0b0d;border-left:3px solid var(--accent-amber-500);padding-left:16px;border-radius:0 8px 8px 0}.activity-timeline[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;align-items:center;flex-shrink:0}.activity-dot[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.1rem;border:2px solid var(--glass-border);z-index:2}.category-payment[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--success-500),var(--success-600));color:#fff}.category-document[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--info-500),var(--info-600));color:#fff}.category-communication[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--primary-cyan-400),var(--primary-cyan-600));color:#fff}.category-opportunity[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-amber-400),var(--accent-amber-600));color:var(--bg-gray-950)}.category-renewal[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--warning-500),var(--warning-600));color:#fff}.category-achievement[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--success-400),var(--success-500));color:#fff}.timeline-line[_ngcontent-%COMP%]{width:2px;height:40px;background:linear-gradient(to bottom,var(--glass-border),transparent);margin-top:8px}.activity-content[_ngcontent-%COMP%]{flex:1;min-width:0}.activity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.activity-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.activity-type[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;padding:4px 8px;border-radius:12px}.type-system[_ngcontent-%COMP%]{background:#3b82f633;color:var(--info-400)}.type-advisor[_ngcontent-%COMP%]{background:#22d3ee33;color:var(--primary-cyan-400)}.type-client[_ngcontent-%COMP%]{background:#f59e0b33;color:var(--accent-amber-400)}.type-automated[_ngcontent-%COMP%]{background:#9ca3af33;color:var(--bg-gray-400)}.activity-time[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.8rem}.priority-indicator[_ngcontent-%COMP%]{font-size:1rem}.activity-title[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1rem;font-weight:600;margin:0 0 6px;line-height:1.3}.activity-description[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:.9rem;line-height:1.5;margin:0 0 12px}.activity-metadata[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:12px}.metadata-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;background:#ffffff0d;padding:4px 10px;border-radius:8px;font-size:.8rem}.metadata-icon[_ngcontent-%COMP%]{font-size:.9rem}.metadata-text[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-weight:500}.suggested-action-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-amber-500),var(--accent-amber-600));color:var(--bg-gray-950);border:none;padding:8px 16px;border-radius:10px;font-size:.85rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .2s ease}.suggested-action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #f59e0b4d}.action-icon[_ngcontent-%COMP%]{font-size:.9rem}.feed-empty[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:16px}.empty-title[_ngcontent-%COMP%]{color:var(--bg-gray-200);font-size:1.2rem;font-weight:600;margin:0 0 8px}.empty-description[_ngcontent-%COMP%]{color:var(--bg-gray-400);font-size:.9rem;margin:0}.feed-footer[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,.1)}.load-more-btn[_ngcontent-%COMP%]{background:#ffffff0d;border:1px solid rgba(255,255,255,.1);color:var(--bg-gray-300);padding:12px 24px;border-radius:12px;font-size:.9rem;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:8px;margin:0 auto;transition:all .2s ease}.load-more-btn[_ngcontent-%COMP%]:hover{background:#ffffff1a;transform:translateY(-1px)}.activity-description[_ngcontent-%COMP%]     .highlight{color:var(--accent-amber-400);font-weight:600}.activity-description[_ngcontent-%COMP%]     .client-name{color:var(--primary-cyan-300);font-weight:600}.activity-description[_ngcontent-%COMP%]     .action-suggestion{color:var(--accent-amber-400);font-weight:600}@media (max-width: 768px){.feed-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.activity-item[_ngcontent-%COMP%]{gap:12px}.activity-dot[_ngcontent-%COMP%]{width:32px;height:32px;font-size:1rem}.activity-metadata[_ngcontent-%COMP%]{flex-direction:column;gap:8px}}"]})}}return i})();function Ve(i,d){i&1&&(n(0,"p"),r(1," Vista completa con herramientas de poder para an\xE1lisis y gesti\xF3n avanzada "),t())}function $e(i,d){i&1&&(n(0,"p"),r(1," Vista simplificada y amigable para mostrar informaci\xF3n al cliente "),t())}var re=(()=>{class i{constructor(){this.currentMode="advisor",this.modeChanged=new D,this.isTransitioning=!1,this.transitionIcon="",this.transitionTitle="",this.transitionDescription=""}ngOnInit(){}toggleMode(){return $(this,null,function*(){if(this.isTransitioning)return;let e=this.currentMode==="advisor"?"client":"advisor";this.startTransition(e),yield this.delay(2e3),this.currentMode=e,this.modeChanged.emit(e),this.endTransition()})}startTransition(e){this.isTransitioning=!0,e==="client"?(this.transitionIcon="\u{1F69A}",this.transitionTitle="Activando Modo Cliente",this.transitionDescription="Transformando la interfaz a una vista amigable y simplificada para mostrar al cliente"):(this.transitionIcon="\u{1F454}",this.transitionTitle="Regresando a Modo Asesor",this.transitionDescription="Restaurando todas las herramientas de poder y an\xE1lisis avanzado")}endTransition(){this.isTransitioning=!1}delay(e){return new Promise(a=>setTimeout(a,e))}static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275cmp=h({type:i,selectors:[["app-client-mode-toggle"]],inputs:{currentMode:"currentMode"},outputs:{modeChanged:"modeChanged"},standalone:!0,features:[y],decls:30,vars:18,consts:[[1,"client-mode-toggle"],[1,"toggle-container"],[1,"mode-indicator"],[1,"mode-label"],[1,"mode-icon"],[1,"mode-text"],[1,"toggle-button",3,"click"],[1,"toggle-slider"],[1,"slider-handle"],[1,"handle-icon"],[1,"toggle-text"],[1,"mode-description"],[4,"ngIf"],[1,"transition-overlay"],[1,"transition-content"],[1,"transition-icon"],[1,"transition-title"],[1,"transition-description"],[1,"loading-dots"]],template:function(a,c){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),r(5),t(),n(6,"span",5),r(7),t()(),n(8,"button",6),u("click",function(){return c.toggleMode()}),n(9,"div",7)(10,"div",8)(11,"span",9),r(12),t()()(),n(13,"span",10),r(14),t()()(),n(15,"div",11),m(16,Ve,2,0,"p",12)(17,$e,2,0,"p",12),t()(),n(18,"div",13)(19,"div",14)(20,"div",15),r(21),t(),n(22,"h3",16),r(23),t(),n(24,"p",17),r(25),t(),n(26,"div",18),x(27,"span")(28,"span")(29,"span"),t()()()()),a&2&&(o(2),P("client-mode",c.currentMode==="client"),o(3),l(c.currentMode==="advisor"?"\u{1F464}":"\u{1F69A}"),o(2),l(c.currentMode==="advisor"?"Modo Asesor":"Modo Cliente"),o(),K("aria-label","Cambiar a "+(c.currentMode==="advisor"?"Modo Cliente":"Modo Asesor")),o(),P("slider-client",c.currentMode==="client"),o(3),l(c.currentMode==="advisor"?"\u{1F454}":"\u{1F465}"),o(2),f(" ",c.currentMode==="advisor"?"Cambiar a Cliente":"Volver a Asesor"," "),o(),P("client-description",c.currentMode==="client"),o(),s("ngIf",c.currentMode==="advisor"),o(),s("ngIf",c.currentMode==="client"),o(),P("show-overlay",c.isTransitioning),o(3),l(c.transitionIcon),o(2),l(c.transitionTitle),o(2),l(c.transitionDescription))},dependencies:[M,C],styles:[".client-mode-toggle[_ngcontent-%COMP%]{position:relative}.toggle-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;background:var(--glass-bg);border:1px solid var(--glass-border);backdrop-filter:var(--glass-backdrop);-webkit-backdrop-filter:var(--glass-backdrop);padding:12px 20px;border-radius:16px;transition:all .3s ease}.toggle-container[_ngcontent-%COMP%]:hover{border-color:var(--primary-cyan-400);box-shadow:0 0 0 1px #22d3ee1a}.mode-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;transition:all .3s ease}.mode-indicator.client-mode[_ngcontent-%COMP%]{transform:scale(1.02)}.mode-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;min-width:140px}.mode-icon[_ngcontent-%COMP%]{font-size:1.3rem;transition:all .3s ease}.client-mode[_ngcontent-%COMP%]   .mode-icon[_ngcontent-%COMP%]{filter:drop-shadow(0 0 8px var(--accent-amber-400))}.mode-text[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-weight:600;font-size:1rem}.client-mode[_ngcontent-%COMP%]   .mode-text[_ngcontent-%COMP%]{color:var(--accent-amber-400)}.toggle-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;background:none;border:none;cursor:pointer;padding:0;transition:all .2s ease}.toggle-button[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.toggle-slider[_ngcontent-%COMP%]{width:60px;height:32px;background:#ffffff1a;border:1px solid var(--glass-border);border-radius:20px;position:relative;transition:all .3s ease}.toggle-slider.slider-client[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-amber-500),var(--accent-amber-600));border-color:var(--accent-amber-400);box-shadow:0 0 0 2px #f59e0b33}.slider-handle[_ngcontent-%COMP%]{position:absolute;top:2px;left:2px;width:26px;height:26px;background:linear-gradient(135deg,var(--primary-cyan-400),var(--primary-cyan-500));border-radius:50%;transition:all .3s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;justify-content:center;box-shadow:0 2px 6px #0003}.slider-client[_ngcontent-%COMP%]   .slider-handle[_ngcontent-%COMP%]{transform:translate(28px);background:linear-gradient(135deg,var(--bg-gray-950),var(--bg-gray-800));box-shadow:0 2px 8px #f59e0b4d}.handle-icon[_ngcontent-%COMP%]{font-size:.8rem;transition:all .3s ease}.toggle-text[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:.9rem;font-weight:500;transition:all .3s ease}.toggle-button[_ngcontent-%COMP%]:hover   .toggle-text[_ngcontent-%COMP%]{color:var(--primary-cyan-300)}.client-mode[_ngcontent-%COMP%]   .toggle-button[_ngcontent-%COMP%]:hover   .toggle-text[_ngcontent-%COMP%]{color:var(--accent-amber-300)}.mode-description[_ngcontent-%COMP%]{flex:1;min-width:200px}.mode-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--bg-gray-400);font-size:.85rem;line-height:1.4;transition:all .3s ease}.client-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--accent-amber-300)}.transition-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#030712f2;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:9999;opacity:0;pointer-events:none;transition:all .4s ease}.transition-overlay.show-overlay[_ngcontent-%COMP%]{opacity:1;pointer-events:all}.transition-content[_ngcontent-%COMP%]{text-align:center;padding:40px;max-width:400px}.transition-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:24px;animation:_ngcontent-%COMP%_bounce-in .8s ease-out}@keyframes _ngcontent-%COMP%_bounce-in{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.1)}to{opacity:1;transform:scale(1)}}.transition-title[_ngcontent-%COMP%]{color:var(--bg-gray-100);font-size:1.8rem;font-weight:700;margin:0 0 12px}.transition-description[_ngcontent-%COMP%]{color:var(--bg-gray-300);font-size:1rem;line-height:1.5;margin:0 0 32px}.loading-dots[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:6px}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:8px;height:8px;background:var(--primary-cyan-400);border-radius:50%;animation:_ngcontent-%COMP%_loading-pulse 1.4s infinite ease-in-out both}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(1){animation-delay:-.32s}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:-.16s}.loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:0s}@keyframes _ngcontent-%COMP%_loading-pulse{0%,80%,to{transform:scale(.8);opacity:.5}40%{transform:scale(1);opacity:1}}@media (max-width: 768px){.toggle-container[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px;padding:16px}.mode-indicator[_ngcontent-%COMP%]{justify-content:space-between}.mode-label[_ngcontent-%COMP%]{min-width:auto}.mode-description[_ngcontent-%COMP%]{min-width:auto;text-align:center}.toggle-button[_ngcontent-%COMP%]{justify-content:center}.transition-content[_ngcontent-%COMP%]{padding:20px;margin:0 20px}.transition-icon[_ngcontent-%COMP%]{font-size:3rem}.transition-title[_ngcontent-%COMP%]{font-size:1.5rem}}.toggle-button[_ngcontent-%COMP%]:focus{outline:2px solid var(--primary-cyan-400);outline-offset:2px;border-radius:8px}@media (prefers-reduced-motion: reduce){.toggle-slider[_ngcontent-%COMP%], .slider-handle[_ngcontent-%COMP%], .transition-overlay[_ngcontent-%COMP%], .mode-indicator[_ngcontent-%COMP%]{transition:none}.transition-icon[_ngcontent-%COMP%], .loading-dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{animation:none}}"]})}}return i})();var ce=(()=>{class i{constructor(e){this.http=e,this.baseUrl=A.apiUrl,this.activityFeedSubject=new j([]),this.activityFeed$=this.activityFeedSubject.asObservable(),this.initializeActivityFeed(),this.simulateRealTimeActivity()}getDashboardStats(e){let a=e&&e!=="all"?new Q().set("market",e):void 0;return A.features.enableMockData?I(this.getMockDashboardStats(e)):this.http.get(`${this.baseUrl}/dashboard/stats`,{params:a})}getActivityFeed(e=15){return A.features.enableMockData?I(this.getMockActivityFeed().slice(0,e)):this.http.get(`${this.baseUrl}/dashboard/activity`,{params:{limit:e.toString()}})}addActivity(e){let a=this.activityFeedSubject.value,c=[e,...a].slice(0,50);this.activityFeedSubject.next(c)}getOpportunityStages(e){return I([{name:"Nuevas Oportunidades",clientIds:["c1","c2","c3","c4","c5","c6","c7","c8","c9","c10"],count:10},{name:"Expediente en Proceso",clientIds:["c11","c12","c13","c14","c15","c16"],count:6},{name:"Aprobado",clientIds:["c17","c18","c19","c20"],count:4}])}getActionableGroups(e){return I([{title:"Clientes con documentos faltantes",description:"Priorizar recolecci\xF3n de documentos",clients:[{id:"c1",name:"Juan P\xE9rez",avatarUrl:"",status:"Pendiente"},{id:"c2",name:"Mar\xEDa L\xF3pez",avatarUrl:"",status:"Pendiente"}]}])}getAllClients(e){return I([{id:"c1",name:"Juan P\xE9rez",avatarUrl:"",status:"Activo",healthScore:82},{id:"c2",name:"Mar\xEDa L\xF3pez",avatarUrl:"",status:"Expediente",healthScore:68},{id:"c3",name:"Carlos Ruiz",avatarUrl:"",status:"Pendiente",healthScore:45}])}updateMarket(e){}getMockDashboardStats(e){let a={opportunitiesInPipeline:{nuevas:12,expediente:8,aprobado:5},pendingActions:{clientsWithMissingDocs:7,clientsWithGoalsReached:3},activeContracts:28,monthlyRevenue:{collected:125e4,projected:18e5}};return e==="aguascalientes"?R(T({},a),{opportunitiesInPipeline:{nuevas:8,expediente:5,aprobado:3},activeContracts:18}):e==="edomex"?R(T({},a),{opportunitiesInPipeline:{nuevas:4,expediente:3,aprobado:2},activeContracts:10}):a}getMockActivityFeed(){let e=new Date;return[{id:"activity-1",type:"payment_received",timestamp:new Date(e.getTime()-5*6e4),message:"Pago de enganche recibido",clientName:"Carlos Mendoza",amount:15e4,icon:"\u{1F4B0}"},{id:"activity-2",type:"doc_approved",timestamp:new Date(e.getTime()-15*6e4),message:"INE Aprobado por el sistema",clientName:"Mar\xEDa Gonz\xE1lez",icon:"\u2705"},{id:"activity-3",type:"new_client",timestamp:new Date(e.getTime()-30*6e4),message:"Nuevo cliente registrado",clientName:"Roberto Silva",icon:"\u{1F464}"},{id:"activity-4",type:"goal_reached",timestamp:new Date(e.getTime()-45*6e4),message:"Meta de ahorro alcanzada",clientName:"Ana Ruiz",amount:2e5,icon:"\u{1F3AF}"},{id:"activity-5",type:"contract_signed",timestamp:new Date(e.getTime()-60*6e4),message:"Contrato firmado digitalmente",clientName:"Luis Herrera",icon:"\u{1F4DD}"}]}initializeActivityFeed(){this.getActivityFeed().subscribe(e=>{this.activityFeedSubject.next(e)})}simulateRealTimeActivity(){A.features.enableMockData&&setInterval(()=>{let e=[{id:`activity-${Date.now()}`,type:"payment_received",timestamp:new Date,message:"Nuevo pago recibido",clientName:"Cliente Demo",amount:Math.floor(Math.random()*1e5)+5e4,icon:"\u{1F4B0}"},{id:`activity-${Date.now()}`,type:"doc_approved",timestamp:new Date,message:"Documento aprobado autom\xE1ticamente",clientName:"Cliente Demo",icon:"\u2705"}],a=e[Math.floor(Math.random()*e.length)];this.addActivity(a)},12e4)}static{this.\u0275fac=function(a){return new(a||i)(U(ee))}}static{this.\u0275prov=L({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function je(i,d){if(i&1){let e=k();n(0,"app-next-best-action-hero",26),u("actionExecuted",function(c){b(e);let g=p();return _(g.onActionExecuted(c))}),t()}if(i&2){let e=p();s("data",e.nextBestAction)}}var wt=(()=>{class i{constructor(e,a){this.router=e,this.dashboardService=a,this.destroy$=new H,this.userName="Ricardo Montoya",this.selectedMarket="all",this.isLoading=!0,this.showProfileDropdown=!1,this.stats=null,this.activityFeed=[],this.funnelData=[],this.actionableGroups=[],this.allClients=[],this.currentViewMode="advisor",this.contextualKPIs=[],this.riskRadarClients=[],this.premiumActivityFeed=[]}ngOnInit(){this.loadDashboardData(),this.subscribeToActivityFeed()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}createNewOpportunity(){let e={market:this.selectedMarket!=="all"?this.selectedMarket:void 0,suggestedFlow:this.getSuggestedFlowFromStats(),timestamp:Date.now(),returnContext:"dashboard-filtered"};this.router.navigate(["/nueva-oportunidad"],{queryParams:e})}getSuggestedFlowFromStats(){if(!this.stats)return;let{nuevas:e,expediente:a,aprobado:c}=this.stats.opportunitiesInPipeline;if(e>a+c)return"COTIZACION";if(c>e)return"SIMULACION"}toggleProfileDropdown(){this.showProfileDropdown=!this.showProfileDropdown}onMarketFilter(e){this.selectedMarket=e,this.loadDashboardData()}onMarketChanged(e){this.selectedMarket=e,this.dashboardService.updateMarket(e)}navigateToClient(e){this.router.navigate(["/clientes",e])}navigateToOpportunities(){this.router.navigate(["/opportunities"])}loadDashboardData(){this.isLoading=!0,Promise.all([this.dashboardService.getDashboardStats(this.selectedMarket).toPromise(),this.dashboardService.getOpportunityStages(this.selectedMarket).toPromise(),this.dashboardService.getActionableGroups(this.selectedMarket).toPromise(),this.dashboardService.getAllClients(this.selectedMarket).toPromise()]).then(([e,a,c,g])=>{this.stats=e||null,e&&(this.dashboardStats=e),this.funnelData=a||[],this.actionableGroups=c||[],this.allClients=g||[],this.initializePremiumComponents(),this.isLoading=!1}).catch(e=>{console.error("Error loading dashboard data:",e),this.isLoading=!1,this.loadMockData(),this.initializePremiumComponents()})}subscribeToActivityFeed(){this.dashboardService.activityFeed$.pipe(B(this.destroy$)).subscribe(e=>{this.activityFeed=e})}formatCurrency(e){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e)}formatTimeAgo(e){let c=Math.floor((new Date().getTime()-e.getTime())/6e4);if(c<1)return"Ahora mismo";if(c<60)return`Hace ${c} minutos`;let g=Math.floor(c/60);return g<24?`Hace ${g} horas`:`Hace ${Math.floor(g/24)} d\xEDas`}onViewModeChanged(e){this.currentViewMode=e,e==="client"&&this.loadClientViewData()}onActionExecuted(e){switch(console.log("Executing action:",e.action,"for context:",e.context),e.action.action){case"call_client":break;case"send_whatsapp":break;case"view_expediente":this.router.navigate(["/clientes",e.context.client.id]);break}}onRiskClientSelected(e){console.log("Risk client selected:",e)}onRiskActionRequested(e){console.log("Risk action requested for:",e),this.convertRiskClientToNextBestAction(e)}convertRiskClientToNextBestAction(e){this.nextBestAction={id:`risk-action-${e.id}`,type:"contact",priority:e.riskLevel==="critical"?"critical":"high",client:{id:e.id,name:e.name,healthScore:e.healthScore},action:{title:`Contactar a ${e.name}`,description:`Cliente en riesgo ${e.riskLevel} requiere atenci\xF3n inmediata`,reasoning:`Health Score: ${e.healthScore}. Issues: ${e.issues.join(", ")}`,timeEstimate:"10 min"},context:{daysWaiting:Math.floor((Date.now()-new Date(e.lastContact).getTime())/(1e3*60*60*24)),amountInvolved:e.value},suggestedActions:{primary:{label:"Llamar Ahora",icon:"\u{1F4DE}",action:"call_client",params:{clientId:e.id}},secondary:[{label:"Enviar WhatsApp",icon:"\u{1F4F1}",action:"send_whatsapp",params:{clientId:e.id}},{label:"Ver Expediente",icon:"\u{1F4C4}",action:"view_expediente",params:{clientId:e.id}}]}}}loadClientViewData(){console.log("Loading client view data")}initializePremiumComponents(){this.loadNextBestAction(),this.loadContextualKPIs(),this.loadRiskRadarData(),this.loadPremiumActivityFeed()}loadNextBestAction(){if(this.actionableGroups.length>0){let e=this.actionableGroups.find(a=>a.priority==="high");if(e&&e.clients.length>0){let a=e.clients[0];this.nextBestAction={id:`action-${a.id}`,type:"document",priority:"high",client:{id:a.id,name:a.name,healthScore:78,route:"Ruta 27"},action:{title:`Contactar a ${a.name}`,description:"Su expediente est\xE1 incompleto (falta INE). Tiene un Health Score de 78.",reasoning:"Cliente con alto potencial, requiere atenci\xF3n inmediata para mantener el momentum.",timeEstimate:"5 min"},context:{daysWaiting:a.daysInStage||5,amountInvolved:15e3},suggestedActions:{primary:{label:"Ver Expediente",icon:"\u{1F4C4}",action:"view_expediente"},secondary:[{label:"Llamar Ahora",icon:"\u{1F4DE}",action:"call_client"},{label:"Enviar Recordatorio por WhatsApp",icon:"\u{1F4F1}",action:"send_whatsapp"}]}}}}this.nextBestAction||(this.nextBestAction={id:"mock-action-1",type:"contact",priority:"high",client:{id:"client-1",name:"Mar\xEDa Garc\xEDa",healthScore:78,route:"Ruta 27"},action:{title:"Contactar a Mar\xEDa Garc\xEDa (Ruta 27)",description:"Su expediente est\xE1 incompleto (falta INE). Tiene un Health Score de 78.",reasoning:"Cliente con alto potencial que necesita completar documentaci\xF3n para avanzar en el proceso.",timeEstimate:"5 min"},context:{daysWaiting:5,amountInvolved:15e3},suggestedActions:{primary:{label:"Ver Expediente",icon:"\u{1F4C4}",action:"view_expediente"},secondary:[{label:"Llamar Ahora",icon:"\u{1F4DE}",action:"call_client"},{label:"Enviar Recordatorio por WhatsApp",icon:"\u{1F4F1}",action:"send_whatsapp"}]}})}getCompletionPercentage(){if(!this.dashboardStats)return 0;let e=this.dashboardStats.monthlyRevenue.collected,a=this.dashboardStats.monthlyRevenue.projected||1;return Math.round(e/a*100)}getNextBestAction(){return{title:"Siguiente acci\xF3n sugerida"}}getHighPriorityClients(){return this.actionableGroups?.[0]?.clients||[]}loadContextualKPIs(){if(!this.stats){this.contextualKPIs=[{id:"opportunities",title:"Oportunidades",value:5,previousValue:4,trend:"up",trendPercentage:25,format:"number",icon:"\u{1F4A1}",color:"primary",subtitle:"Nuevas esta semana"},{id:"conversion",title:"Tasa de Cierre",value:28,previousValue:32,trend:"down",trendPercentage:12.5,format:"percentage",icon:"\u{1F3AF}",color:"accent"},{id:"contracts",title:"Contratos Activos",value:28,previousValue:26,trend:"stable",trendPercentage:7.7,format:"number",icon:"\u{1F4CB}",color:"success"},{id:"revenue",title:"Revenue del Mes",value:125e4,previousValue:1115e3,trend:"up",trendPercentage:12.1,format:"currency",icon:"\u{1F4B0}",color:"accent"}];return}this.contextualKPIs=[{id:"opportunities",title:"Oportunidades",value:this.stats.opportunitiesInPipeline.nuevas,previousValue:this.stats.opportunitiesInPipeline.nuevas-1,trend:this.stats.opportunitiesInPipeline.nuevas>4?"up":"down",trendPercentage:25,format:"number",icon:"\u{1F4A1}",color:"primary",subtitle:"Nuevas esta semana"},{id:"conversion",title:"Tasa de Cierre",value:28,previousValue:32,trend:"up",trendPercentage:15,format:"percentage",icon:"\u{1F3AF}",color:"accent"},{id:"contracts",title:"Contratos Activos",value:this.stats.activeContracts,previousValue:this.stats.activeContracts-2,trend:"stable",trendPercentage:0,format:"number",icon:"\u{1F4CB}",color:"success"},{id:"revenue",title:"Revenue del Mes",value:this.stats.monthlyRevenue.collected,previousValue:this.stats.monthlyRevenue.collected*.88,trend:"up",trendPercentage:12,format:"currency",icon:"\u{1F4B0}",color:"accent"}]}loadRiskRadarData(){this.riskRadarClients=[{id:"client-risk-1",name:"Mar\xEDa Gonz\xE1lez",healthScore:45,riskLevel:"critical",position:{x:20,y:80},issues:["Documentos Vencidos","Sin contacto 7 d\xEDas"],lastContact:"hace 7 d\xEDas",value:25e3,urgency:9},{id:"client-risk-2",name:"Carlos M\xE9ndez",healthScore:62,riskLevel:"medium",position:{x:65,y:45},issues:["INE Vencida"],lastContact:"hace 3 d\xEDas",value:18e3,urgency:6},{id:"client-risk-3",name:"Ana Ruiz",healthScore:85,riskLevel:"low",position:{x:80,y:20},issues:["Meta Completada"],lastContact:"hace 1 d\xEDa",value:3e4,urgency:2},{id:"client-risk-4",name:"Jos\xE9 Hern\xE1ndez",healthScore:38,riskLevel:"critical",position:{x:15,y:70},issues:["Pago Vencido","Sin respuesta"],lastContact:"hace 12 d\xEDas",value:22e3,urgency:10}]}loadPremiumActivityFeed(){this.premiumActivityFeed=[{id:"activity-1",type:"system",category:"payment",timestamp:new Date(Date.now()-2*6e4),client:{id:"client-1",name:"Juan P\xE9rez"},title:"Pago de $5,000 MXN recibido de Juan P\xE9rez.",description:"Pago de $5,000 MXN recibido de Juan P\xE9rez. \xA1Felic\xEDtalo!",metadata:{amount:5e3},suggestedAction:{label:"\xA1Felic\xEDtalo!",action:"congratulate_client",params:{clientName:"Juan P\xE9rez"}},priority:"medium"},{id:"activity-2",type:"advisor",category:"document",timestamp:new Date(Date.now()-15*6e4),client:{id:"client-2",name:"Ana L\xF3pez"},title:"Documento 'INE' de Ana L\xF3pez marcado como 'En Revisi\xF3n'.",description:"El documento ha sido recibido y est\xE1 siendo procesado por el equipo de validaci\xF3n.",priority:"low"},{id:"activity-3",type:"system",category:"opportunity",timestamp:new Date(Date.now()-60*6e4),client:{id:"client-3",name:"Carlos S\xE1nchez"},title:"Nueva oportunidad 'Carlos S\xE1nchez' asignada.",description:"Se ha creado una nueva oportunidad de negocio que requiere tu atenci\xF3n.",priority:"high"}]}loadMockData(){this.stats={opportunitiesInPipeline:{nuevas:5,expediente:3,aprobado:2},pendingActions:{clientsWithMissingDocs:7,clientsWithGoalsReached:2},activeContracts:28,monthlyRevenue:{collected:125e4,projected:145e4}},this.actionableGroups=[{title:"Documentos Vencidos",description:"Clientes con documentaci\xF3n que requiere renovaci\xF3n",clients:[{id:"1",name:"Mar\xEDa Gonz\xE1lez",status:"Documentos Vencidos",avatarUrl:"https://via.placeholder.com/40"},{id:"2",name:"Carlos M\xE9ndez",status:"INE Vencida",avatarUrl:"https://via.placeholder.com/40"}]}]}static{this.\u0275fac=function(a){return new(a||i)(N(te),N(ce))}}static{this.\u0275cmp=h({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[y],decls:38,vars:11,consts:[[1,"command-center-dashboard"],[1,"command-header"],[1,"command-title-section"],[1,"command-title"],[1,"command-icon"],[1,"command-subtitle"],[1,"command-controls"],[3,"modeChanged","currentMode"],[1,"user-info"],[1,"user-name"],[1,"client-mode-badge",3,"click"],[1,"command-dashboard-main"],[1,"next-best-action-hero"],[1,"hero-header"],[1,"hero-title"],[3,"data","actionExecuted",4,"ngIf"],[1,"intelligence-grid"],[1,"kpis-section"],[1,"section-title"],[3,"kpis","showTrends"],[1,"risk-radar-section"],[1,"section-subtitle"],[3,"clientSelected","actionRequested","clients"],[1,"human-activity-section"],[1,"activity-feed-container"],[3,"activities","maxItems","showSuggestedActions"],[3,"actionExecuted","data"]],template:function(a,c){a&1&&(n(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3)(4,"span",4),r(5,"\u2728"),t(),r(6," Centro de Comando "),t(),n(7,"p",5),r(8,"Tu plan de acci\xF3n para hoy, Ricardo."),t()(),n(9,"div",6)(10,"app-client-mode-toggle",7),u("modeChanged",function(O){return c.onViewModeChanged(O)}),t(),n(11,"div",8)(12,"span",9),r(13),t(),n(14,"button",10),u("click",function(){return c.toggleProfileDropdown()}),r(15," \u{1F69A} Modo Cliente "),t()()()(),n(16,"main",11)(17,"section",12)(18,"div",13)(19,"h2",14),r(20,"\u{1F4A1} TU PR\xD3XIMA MEJOR ACCI\xD3N"),t()(),m(21,je,1,1,"app-next-best-action-hero",15),t(),n(22,"section",16)(23,"div",17)(24,"h3",18),r(25,"\u{1F4CA} KPIs Clave (vs. Semana Pasada)"),t(),x(26,"app-contextual-kpis",19),t(),n(27,"div",20)(28,"h3",18),r(29,"\u{1F525} Radar de Riesgo"),t(),n(30,"p",21),r(31,"(Visualizaci\xF3n de clientes por Health Score)"),t(),n(32,"app-risk-radar",22),u("clientSelected",function(O){return c.onRiskClientSelected(O)})("actionRequested",function(O){return c.onRiskActionRequested(O)}),t()()(),n(33,"section",23)(34,"h2",18),r(35,"\u{1F6F0}\uFE0F Feed de Actividad en Tiempo Real"),t(),n(36,"div",24),x(37,"app-human-activity-feed",25),t()()()()),a&2&&(o(10),s("currentMode",c.currentViewMode),o(3),f("\u{1F464} ",c.userName," \u23F7"),o(),P("active",c.currentViewMode==="client"),o(7),s("ngIf",c.nextBestAction),o(5),s("kpis",c.contextualKPIs)("showTrends",!0),o(6),s("clients",c.riskRadarClients),o(5),s("activities",c.premiumActivityFeed)("maxItems",4)("showSuggestedActions",!0))},dependencies:[M,C,z,ne,ie,ae,oe,re],styles:['.command-center-dashboard[_ngcontent-%COMP%]{min-height:100vh;background:var(--bg-gray-950);background-image:radial-gradient(circle at 25% 25%,var(--primary-cyan-900) 0%,transparent 50%),radial-gradient(circle at 75% 75%,var(--accent-amber-900) 0%,transparent 50%)}.command-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:24px 32px;background:var(--glass-bg);border:1px solid var(--glass-border);-webkit-backdrop-filter:var(--glass-backdrop);backdrop-filter:var(--glass-backdrop);border-radius:0 0 24px 24px;margin-bottom:32px;box-shadow:var(--shadow-premium)}.command-title-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.command-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:2rem;font-weight:800;color:var(--primary-cyan-300);letter-spacing:-.025em}.command-icon[_ngcontent-%COMP%]{font-size:2.5rem;animation:_ngcontent-%COMP%_glow-pulse 3s ease-in-out infinite}@keyframes _ngcontent-%COMP%_glow-pulse{0%,to{filter:drop-shadow(0 0 10px var(--primary-cyan-400))}50%{filter:drop-shadow(0 0 20px var(--accent-amber-500))}}.command-subtitle[_ngcontent-%COMP%]{margin:0;color:var(--bg-gray-300);font-size:1.1rem;font-weight:500;opacity:.9}.command-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.user-name[_ngcontent-%COMP%]{color:var(--bg-gray-200);font-weight:600;font-size:1rem}.client-mode-badge[_ngcontent-%COMP%]{background:var(--accent-amber-500);color:var(--bg-gray-950);padding:8px 16px;border:none;border-radius:20px;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .2s ease;box-shadow:0 4px 12px #f59e0b4d}.client-mode-badge[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #f59e0b66}.client-mode-badge.active[_ngcontent-%COMP%]{background:var(--accent-amber-400);box-shadow:0 0 20px var(--accent-amber-500)}.command-dashboard-main[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:0 32px 32px;display:flex;flex-direction:column;gap:32px}.next-best-action-hero[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);-webkit-backdrop-filter:var(--glass-backdrop);backdrop-filter:var(--glass-backdrop);border-radius:24px;padding:32px;box-shadow:var(--shadow-premium);position:relative;overflow:hidden}.next-best-action-hero[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(135deg,var(--primary-cyan-400),transparent,var(--accent-amber-500));border-radius:24px;z-index:-1;opacity:.5}.hero-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.hero-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:800;color:var(--primary-cyan-300);margin:0;text-transform:uppercase;letter-spacing:.05em}.intelligence-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:32px}.kpis-section[_ngcontent-%COMP%], .risk-radar-section[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);-webkit-backdrop-filter:var(--glass-backdrop);backdrop-filter:var(--glass-backdrop);border-radius:24px;padding:32px;box-shadow:var(--shadow-premium)}.section-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:700;color:var(--primary-cyan-300);margin:0 0 8px}.section-subtitle[_ngcontent-%COMP%]{font-size:.95rem;color:var(--bg-gray-400);margin:0 0 24px;font-style:italic}.human-activity-section[_ngcontent-%COMP%]{background:var(--glass-bg);border:1px solid var(--glass-border);-webkit-backdrop-filter:var(--glass-backdrop);backdrop-filter:var(--glass-backdrop);border-radius:24px;padding:32px;box-shadow:var(--shadow-premium)}.activity-feed-container[_ngcontent-%COMP%]{margin-top:16px}@media (max-width: 1200px){.intelligence-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.command-header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}}@media (max-width: 768px){.command-dashboard-main[_ngcontent-%COMP%]{padding:0 16px 16px}.command-header[_ngcontent-%COMP%]{padding:20px 16px;border-radius:0}.command-title[_ngcontent-%COMP%]{font-size:1.6rem}.next-best-action-hero[_ngcontent-%COMP%], .kpis-section[_ngcontent-%COMP%], .risk-radar-section[_ngcontent-%COMP%], .human-activity-section[_ngcontent-%COMP%]{padding:24px}}']})}}return i})();export{wt as DashboardComponent};
