import{a as Q}from"./chunk-AIYREKCX.js";import"./chunk-FK6H3RFT.js";import{a as W}from"./chunk-PH3HD2HQ.js";import{a as U}from"./chunk-O54BG3VU.js";import{m as L}from"./chunk-SCHFUJ5K.js";import{a as X}from"./chunk-ULB2DFX5.js";import{a as K}from"./chunk-YYSQDTD3.js";import{b as N,c as g,d as $,e as q,h as O,i as B,l as G,m as z,r as H,t as R,v as J}from"./chunk-S2UEMBMO.js";import{Ea as o,Fa as x,Sa as s,Ua as l,Va as T,Xb as M,Ya as t,Yb as V,Za as e,_a as u,bb as j,bc as A,cb as v,db as c,ea as D,f as P,ib as n,jb as p,kb as E,ma as _,na as C,oa as S,pa as F,sb as k}from"./chunk-5IDTUAMZ.js";import"./chunk-DM275RSA.js";function Y(r,d){r&1&&(t(0,"div",27),n(1,"La meta de enganche es obligatoria"),e())}function Z(r,d){r&1&&(t(0,"div",27),n(1,"El m\xEDnimo es $50,000"),e())}function ee(r,d){r&1&&(t(0,"div",27),n(1,"El consumo de combustible es obligatorio"),e())}function te(r,d){r&1&&(t(0,"div",27),n(1,"El m\xEDnimo es 100 litros/mes"),e())}function ne(r,d){r&1&&(t(0,"div",27),n(1,"El sobreprecio por litro es obligatorio"),e())}function ie(r,d){r&1&&(t(0,"div",27),n(1,"El m\xEDnimo es $0.50/litro"),e())}function re(r,d){r&1&&(t(0,"span"),n(1,"Calcular Plan de Ahorro"),e())}function oe(r,d){r&1&&(t(0,"div",28),S(),t(1,"svg",29),u(2,"circle",30)(3,"path",31),e(),n(4," Calculando... "),e())}function ae(r,d){if(r&1&&(t(0,"div",46)(1,"span",47),n(2,"Aportaci\xF3n voluntaria:"),e(),t(3,"span",48),n(4),e()()),r&2){let i=c(2);o(4),p(i.formatCurrency(i.scenario.voluntaryContribution))}}function le(r,d){if(r&1&&(t(0,"div",65)(1,"span",66),n(2),e(),t(3,"span",48),n(4),e(),t(5,"div",28)(6,"div",67),u(7,"div",68),e()(),t(8,"span",69),n(9),e()()),r&2){let i=d.$implicit,m=d.index,a=c(2);o(2),p(m+1),o(2),p(a.formatCurrency(i)),o(3),T("width",i/a.scenario.targetAmount*100,"%"),o(2),E("",(i/a.scenario.targetAmount*100).toFixed(1),"%")}}function de(r,d){if(r&1&&(t(0,"span",76),n(1),e()),r&2){let i=c().$implicit,m=c(3);o(),E(" ",m.formatCurrency(i.amount)," ")}}function me(r,d){if(r&1&&(t(0,"div",72)(1,"div")(2,"span",73),n(3),e(),t(4,"p",74),n(5),e()(),s(6,de,2,1,"span",75),e()),r&2){let i=d.$implicit;o(3),E("Mes ",i.month,""),o(2),p(i.event),o(),l("ngIf",i.amount>0)}}function se(r,d){if(r&1&&(t(0,"div",52)(1,"h3",44),n(2,"Cronograma de Eventos:"),e(),t(3,"div",70),s(4,me,7,3,"div",71),e()()),r&2){let i=c(2);o(4),l("ngForOf",i.scenario.timeline.slice(0,6))}}function ue(r,d){if(r&1){let i=j();t(0,"div",5)(1,"h2",6)(2,"span",32),n(3,"2"),e(),n(4," Tu Plan de Enganche "),e(),t(5,"div",33)(6,"div",34)(7,"div",35),n(8,"Meta de Enganche"),e(),t(9,"div",36),n(10),e()(),t(11,"div",37)(12,"div",38),n(13,"Tiempo Estimado"),e(),t(14,"div",39),n(15),e()(),t(16,"div",40)(17,"div",41),n(18,"Aportaci\xF3n Mensual"),e(),t(19,"div",42),n(20),e()()(),t(21,"div",43)(22,"h3",44),n(23,"Desglose de Aportaci\xF3n Mensual:"),e(),t(24,"div",45)(25,"div",46)(26,"span",47),n(27,"Por recaudaci\xF3n de combustible:"),e(),t(28,"span",48),n(29),e()(),s(30,ae,5,1,"div",49),u(31,"hr",50),t(32,"div",51)(33,"span"),n(34,"Total mensual:"),e(),t(35,"span"),n(36),e()()()(),t(37,"div",52)(38,"h3",44),n(39,"Proyecci\xF3n de Ahorro:"),e(),t(40,"div",53)(41,"div",54)(42,"span"),n(43,"Mes"),e(),t(44,"span"),n(45,"Balance"),e(),t(46,"span"),n(47,"Progreso"),e(),t(48,"span"),n(49,"%"),e()(),t(50,"div",55),s(51,le,10,5,"div",56),e()()(),s(52,se,5,1,"div",57),t(53,"div",58)(54,"button",59),v("click",function(){_(i);let a=c();return C(a.generatePDF())}),S(),t(55,"svg",60),u(56,"path",61),e(),n(57," \u{1F4C4} Descargar PDF "),e(),F(),t(58,"button",62),v("click",function(){_(i);let a=c();return C(a.proceedToClientCreation())}),S(),t(59,"svg",60),u(60,"path",63),e(),n(61," Crear Cliente con este Plan "),e(),F(),t(62,"button",64),v("click",function(){_(i);let a=c();return C(a.recalculate())}),n(63," Ajustar Plan "),e()()()}if(r&2){let i=c();o(10),p(i.formatCurrency(i.scenario.targetAmount)),o(5),E("",i.scenario.monthsToTarget," meses"),o(5),p(i.formatCurrency(i.scenario.monthlyContribution)),o(9),p(i.formatCurrency(i.scenario.collectionContribution)),o(),l("ngIf",i.scenario.voluntaryContribution>0),o(6),p(i.formatCurrency(i.scenario.monthlyContribution)),o(15),l("ngForOf",i.scenario.projectedBalance.slice(0,12)),o(),l("ngIf",i.scenario.timeline.length>0)}}function ce(r,d){r&1&&(t(0,"div",5)(1,"h2",77)(2,"span",78),n(3,"\u{1F4A1}"),e(),n(4," \xBFC\xF3mo funciona? "),e(),t(5,"div",79)(6,"div",80)(7,"span",81),n(8,"1"),e(),t(9,"div")(10,"h3",73),n(11,"Define tu meta"),e(),t(12,"p",82),n(13,"\xBFCu\xE1nto necesitas para el enganche de tu unidad?"),e()()(),t(14,"div",80)(15,"span",81),n(16,"2"),e(),t(17,"div")(18,"h3",73),n(19,"Tu consumo actual"),e(),t(20,"p",82),n(21,"Basado en los litros que ya consumes mensualmente"),e()()(),t(22,"div",80)(23,"span",81),n(24,"3"),e(),t(25,"div")(26,"h3",73),n(27,"Sobreprecio estrat\xE9gico"),e(),t(28,"p",82),n(29,"Cada litro extra que pagues se destina a tu ahorro"),e()()(),t(30,"div",80)(31,"span",83),n(32,"\u2713"),e(),t(33,"div")(34,"h3",73),n(35,"Plan personalizado"),e(),t(36,"p",82),n(37,"Obt\xE9n tu cronograma detallado para alcanzar tu meta"),e()()()()())}var Ie=(()=>{class r{constructor(i,m,a,f,b,h,y){this.fb=i,this.simuladorEngine=m,this.loadingService=a,this.financialCalc=f,this.pdfExportService=b,this.toast=h,this.router=y,this.destroy$=new P,this.scenario=null,this.isCalculating=!1,this.configForm=this.fb.group({targetDownPayment:[149800,[g.required,g.min(5e4)]],currentPlateConsumption:[500,[g.required,g.min(100)]],overpricePerLiter:[2.5,[g.required,g.min(.5)]],voluntaryMonthly:[0,[g.min(0)]]})}ngOnInit(){this.configForm.patchValue({targetDownPayment:149800,currentPlateConsumption:500,overpricePerLiter:2.5,voluntaryMonthly:0})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}calculateScenario(){if(!this.configForm.valid)return;let i=this.configForm.value;this.isCalculating=!0,this.loadingService.show("Calculando tu plan de ahorro personalizado..."),setTimeout(()=>{this.scenario=this.simuladorEngine.generateEdoMexIndividualScenario(i.targetDownPayment,i.currentPlateConsumption,i.overpricePerLiter,i.voluntaryMonthly||0),this.isCalculating=!1,this.loadingService.hide()},1200)}resetForm(){this.configForm.reset({targetDownPayment:149800,currentPlateConsumption:500,overpricePerLiter:2.5,voluntaryMonthly:0}),this.scenario=null}recalculate(){this.scenario=null}proceedToClientCreation(){if(!this.scenario)return;let i={simulatorData:{type:"EDOMEX_INDIVIDUAL",scenario:this.scenario,configParams:this.configForm.value}};sessionStorage.setItem("pendingClientData",JSON.stringify(i)),this.router.navigate(["/clientes/nuevo"],{queryParams:{fromSimulator:"edomex-individual",hasScenario:"true"}})}formatCurrency(i){return this.financialCalc.formatCurrency(i)}generatePDF(){if(!this.scenario){this.toast.error("No hay simulaci\xF3n disponible para generar PDF");return}let i={targetDownPayment:this.scenario.targetAmount,monthsToTarget:this.scenario.monthsToTarget,monthlyCollection:this.scenario.collectionContribution,voluntaryMonthly:this.scenario.voluntaryContribution,plateConsumption:this.configForm.value.currentPlateConsumption,overpricePerLiter:this.configForm.value.overpricePerLiter,projectedBalance:this.scenario.projectedBalance};this.pdfExportService.generateIndividualPlanningPDF(i).then(()=>{this.toast.success("PDF generado exitosamente")}).catch(()=>{this.toast.error("Error al generar PDF")})}static{this.\u0275fac=function(m){return new(m||r)(x(R),x(W),x(U),x(X),x(Q),x(K),x(L))}}static{this.\u0275cmp=D({type:r,selectors:[["app-edomex-individual"]],standalone:!0,features:[k],decls:66,vars:12,consts:[[1,"container","mx-auto","p-6","space-y-6"],[1,"bg-gradient-to-r","from-blue-600","to-blue-800","text-white","rounded-xl","p-6","shadow-lg"],[1,"text-3xl","font-bold","mb-2"],[1,"text-blue-100","text-lg"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"bg-white","rounded-xl","shadow-lg","p-6"],[1,"text-xl","font-semibold","text-gray-800","mb-6","flex","items-center"],[1,"bg-blue-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"space-y-6",3,"formGroup"],[1,"space-y-2"],[1,"block","text-sm","font-medium","text-gray-700"],[1,"relative"],[1,"absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-500"],["type","number","formControlName","targetDownPayment","placeholder","150000","min","50000","step","1000",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"flex","justify-between","text-xs","text-gray-500"],["class","text-red-500 text-sm",4,"ngIf"],["type","number","formControlName","currentPlateConsumption","placeholder","500","min","100","step","50",1,"w-full","pr-16","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"absolute","right-3","top-1/2","transform","-translate-y-1/2","text-gray-500"],[1,"text-xs","text-gray-500"],["type","number","formControlName","overpricePerLiter","placeholder","2.50","min","0.5","step","0.1",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],["type","number","formControlName","voluntaryMonthly","placeholder","0","min","0","step","100",1,"w-full","pl-8","pr-4","py-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent"],[1,"flex","gap-4","pt-4"],["type","button",1,"flex-1","bg-blue-600","hover:bg-blue-700","disabled:bg-gray-400","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center",3,"click","disabled"],[4,"ngIf"],["class","flex items-center",4,"ngIf"],["type","button",1,"px-6","py-3","border","border-gray-300","text-gray-700","font-medium","rounded-lg","hover:bg-gray-50","transition-colors","duration-200",3,"click"],["class","bg-white rounded-xl shadow-lg p-6",4,"ngIf"],[1,"text-red-500","text-sm"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"bg-green-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4","mb-6"],[1,"bg-gradient-to-br","from-blue-50","to-blue-100","p-4","rounded-lg","border","border-blue-200"],[1,"text-blue-600","text-sm","font-medium"],[1,"text-2xl","font-bold","text-blue-800"],[1,"bg-gradient-to-br","from-green-50","to-green-100","p-4","rounded-lg","border","border-green-200"],[1,"text-green-600","text-sm","font-medium"],[1,"text-2xl","font-bold","text-green-800"],[1,"bg-gradient-to-br","from-purple-50","to-purple-100","p-4","rounded-lg","border","border-purple-200"],[1,"text-purple-600","text-sm","font-medium"],[1,"text-2xl","font-bold","text-purple-800"],[1,"bg-gray-50","rounded-lg","p-4","mb-6"],[1,"font-semibold","text-gray-800","mb-3"],[1,"space-y-2","text-sm"],[1,"flex","justify-between"],[1,"text-gray-600"],[1,"font-medium"],["class","flex justify-between",4,"ngIf"],[1,"my-2"],[1,"flex","justify-between","font-semibold"],[1,"mb-6"],[1,"bg-gray-100","rounded-lg","p-4"],[1,"grid","grid-cols-4","gap-2","text-xs","text-gray-600","mb-2"],[1,"space-y-2","max-h-48","overflow-y-auto"],["class","grid grid-cols-4 gap-2 text-sm",4,"ngFor","ngForOf"],["class","mb-6",4,"ngIf"],[1,"flex","gap-4","flex-col","sm:flex-row"],[1,"bg-red-600","hover:bg-red-700","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"flex-1","bg-green-600","hover:bg-green-700","text-white","font-semibold","py-3","px-6","rounded-lg","transition-colors","duration-200","flex","items-center","justify-center",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"px-6","py-3","border","border-blue-600","text-blue-600","font-medium","rounded-lg","hover:bg-blue-50","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-4","gap-2","text-sm"],[1,"text-gray-800"],[1,"w-16","bg-gray-200","rounded-full","h-2"],[1,"bg-blue-500","h-2","rounded-full"],[1,"text-xs","text-gray-600"],[1,"bg-gray-50","rounded-lg","p-4","max-h-48","overflow-y-auto"],["class","flex justify-between items-center py-2 border-b border-gray-200 last:border-b-0",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","py-2","border-b","border-gray-200","last:border-b-0"],[1,"font-medium","text-gray-800"],[1,"text-sm","text-gray-600"],["class","text-sm font-medium text-green-600",4,"ngIf"],[1,"text-sm","font-medium","text-green-600"],[1,"text-xl","font-semibold","text-gray-800","mb-4","flex","items-center"],[1,"bg-amber-500","text-white","rounded-full","w-8","h-8","flex","items-center","justify-center","text-sm","font-bold","mr-3"],[1,"space-y-4","text-gray-600"],[1,"flex","items-start","space-x-3"],[1,"bg-blue-100","text-blue-600","rounded-full","w-6","h-6","flex","items-center","justify-center","text-sm","font-bold","flex-shrink-0"],[1,"text-sm"],[1,"bg-green-100","text-green-600","rounded-full","w-6","h-6","flex","items-center","justify-center","text-sm","font-bold","flex-shrink-0"]],template:function(m,a){if(m&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),n(3,"Planificador de Enganche Individual"),e(),t(4,"p",3),n(5,"Calcula cu\xE1nto tiempo necesitas para ahorrar tu enganche"),e()(),t(6,"div",4)(7,"div",5)(8,"h2",6)(9,"span",7),n(10,"1"),e(),n(11," Configuraci\xF3n de tu Enganche "),e(),t(12,"form",8)(13,"div",9)(14,"label",10),n(15," Meta de Enganche * "),e(),t(16,"div",11)(17,"span",12),n(18,"$"),e(),u(19,"input",13),e(),t(20,"div",14)(21,"span"),n(22,"M\xEDnimo: $50,000"),e(),t(23,"span"),n(24,"Para unidad de $749K: $149,800 (20%)"),e()(),s(25,Y,2,0,"div",15)(26,Z,2,0,"div",15),e(),t(27,"div",9)(28,"label",10),n(29," Consumo Actual de Combustible * "),e(),t(30,"div",11),u(31,"input",16),t(32,"span",17),n(33,"litros/mes"),e()(),t(34,"p",18),n(35,"Promedio de litros que consumes mensualmente"),e(),s(36,ee,2,0,"div",15)(37,te,2,0,"div",15),e(),t(38,"div",9)(39,"label",10),n(40," Sobreprecio por Litro * "),e(),t(41,"div",11)(42,"span",12),n(43,"$"),e(),u(44,"input",19),e(),t(45,"p",18),n(46,"Cantidad extra por litro que destinar\xE1s al ahorro"),e(),s(47,ne,2,0,"div",15)(48,ie,2,0,"div",15),e(),t(49,"div",9)(50,"label",10),n(51," Aportaci\xF3n Voluntaria Mensual (Opcional) "),e(),t(52,"div",11)(53,"span",12),n(54,"$"),e(),u(55,"input",20),e(),t(56,"p",18),n(57,"Dinero adicional que puedes aportar mensualmente"),e()(),t(58,"div",21)(59,"button",22),v("click",function(){return a.calculateScenario()}),s(60,re,2,0,"span",23)(61,oe,5,0,"div",24),e(),t(62,"button",25),v("click",function(){return a.resetForm()}),n(63," Limpiar "),e()()()(),s(64,ue,64,8,"div",26)(65,ce,38,0,"div",26),e()()),m&2){let f,b,h,y,I,w;o(12),l("formGroup",a.configForm),o(13),l("ngIf",(f=a.configForm.get("targetDownPayment"))==null||f.errors==null?null:f.errors.required),o(),l("ngIf",(b=a.configForm.get("targetDownPayment"))==null||b.errors==null?null:b.errors.min),o(10),l("ngIf",(h=a.configForm.get("currentPlateConsumption"))==null||h.errors==null?null:h.errors.required),o(),l("ngIf",(y=a.configForm.get("currentPlateConsumption"))==null||y.errors==null?null:y.errors.min),o(10),l("ngIf",(I=a.configForm.get("overpricePerLiter"))==null||I.errors==null?null:I.errors.required),o(),l("ngIf",(w=a.configForm.get("overpricePerLiter"))==null||w.errors==null?null:w.errors.min),o(11),l("disabled",!a.configForm.valid||a.isCalculating),o(),l("ngIf",!a.isCalculating),o(),l("ngIf",a.isCalculating),o(3),l("ngIf",a.scenario),o(),l("ngIf",!a.scenario)}},dependencies:[A,M,V,J,O,N,B,$,q,H,G,z],encapsulation:2})}}return r})();export{Ie as EdomexIndividualComponent};
