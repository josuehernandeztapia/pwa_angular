import{a as ne}from"./chunk-FMSL7TFC.js";import"./chunk-4M7CYCOE.js";import{m as Q}from"./chunk-SCHFUJ5K.js";import{a as M}from"./chunk-QCEAPM7G.js";import{d as X,g as Y,n as Z,o as ee,p as te,u as ie}from"./chunk-S2UEMBMO.js";import{$ as A,$b as J,A as H,Ea as r,Kb as U,Ma as b,Q as P,R as D,Sa as h,Ua as m,Va as z,Wa as L,Xa as x,Xb as W,Ya as e,Yb as G,Za as i,_a as g,_b as q,bb as C,bc as K,cb as f,db as c,ea as $,f as B,ib as n,j,jb as u,kb as d,ma as w,na as T,oa as _,ob as I,pa as S,pb as k,qb as F,sb as N,vb as E,w as R,xb as y}from"./chunk-5IDTUAMZ.js";import"./chunk-DM275RSA.js";function re(l,s){if(l&1){let t=C();e(0,"button",71),f("click",function(){w(t);let a=c().$implicit,p=c(2);return T(p.viewDeliveryOrder(a.deliveryOrderId))}),n(1," Ver Orden "),i()}}function ae(l,s){if(l&1){let t=C();e(0,"button",72),f("click",function(){w(t);let a=c().$implicit,p=c(2);return T(p.viewError(a))}),n(1," Ver Error "),i()}}function le(l,s){if(l&1&&(e(0,"div",14)(1,"div",60)(2,"div",61)(3,"div",62),g(4,"div"),e(5,"h3",63),n(6),i(),e(7,"span",64),n(8),i()(),e(9,"div",65)(10,"div")(11,"p",66),n(12,"Umbral Objetivo"),i(),e(13,"p",67),n(14),E(15,"number"),i()(),e(16,"div")(17,"p",66),n(18,"Monto Actual"),i(),e(19,"p",67),n(20),E(21,"number"),i()(),e(22,"div")(23,"p",66),n(24,"Porcentaje"),i(),e(25,"p",67),n(26),i()()(),e(27,"div",15)(28,"div",68)(29,"span",9),n(30),E(31,"date"),i(),e(32,"span",9),n(33),i()(),e(34,"div",7),h(35,re,2,0,"button",69)(36,ae,2,0,"button",70),i()()()()()),l&2){let t=s.$implicit,o=c(2);r(4),x(o.getEventStatusClass(t)),r(2),d(" ",o.getEventTitle(t)," "),r(),x(o.getFlowBadgeClass(o.getEventFlow(t))),r(),d(" ",o.getEventFlow(t)," "),r(6),d("$",y(15,13,t.thresholdAmount,"1.2-2"),""),r(6),d("$",y(21,16,t.actualAmount,"1.2-2"),""),r(6),d("",t.triggerPercentage.toFixed(1),"%"),r(4),d(" ",y(31,19,t.triggerDate,"dd/MM/yyyy HH:mm")," "),r(3),d(" Procesado: ",t.processedBy==="system"?"Autom\xE1tico":"Manual"," "),r(2),m("ngIf",t.deliveryOrderId),r(),m("ngIf",t.errorMessage)}}function oe(l,s){l&1&&(e(0,"div",73),_(),e(1,"svg",74),g(2,"path",75),i(),S(),e(3,"p",76),n(4,"No hay triggers recientes con los filtros seleccionados"),i()())}function de(l,s){if(l&1&&(e(0,"div",57),h(1,le,37,22,"div",58)(2,oe,5,0,"div",59),i()),l&2){let t=c();r(),m("ngForOf",t.filteredEvents()),r(),m("ngIf",t.filteredEvents().length===0)}}function se(l,s){if(l&1&&(e(0,"div",79)(1,"div",80),g(2,"div",81),e(3,"h3",63),n(4),i(),e(5,"span",64),n(6),i(),e(7,"span",82),n(8),i()(),e(9,"div",83)(10,"div")(11,"p",66),n(12,"Umbral Requerido"),i(),e(13,"p",67),n(14),E(15,"number"),i()(),e(16,"div")(17,"p",66),n(18,"Pagado Actualmente"),i(),e(19,"p",67),n(20),E(21,"number"),i()(),e(22,"div")(23,"p",66),n(24,"Progreso"),i(),e(25,"div",7)(26,"div",84),g(27,"div",85),i(),e(28,"span",8),n(29),i()()(),e(30,"div")(31,"p",66),n(32,"Estado"),i(),e(33,"p",86),n(34),i()()()()),l&2){let t=s.$implicit,o=c(2);r(4),u(t.clientName),r(),x(o.getFlowBadgeClass(t.flow)),r(),d(" ",t.flow," "),r(2),d(" ",t.market," "),r(6),d("$",y(15,11,t.thresholdAmount,"1.2-2"),""),r(6),d("$",y(21,14,t.currentPaidAmount,"1.2-2"),""),r(7),z("width",t.thresholdPercentage,"%"),r(2),d("",t.thresholdPercentage.toFixed(1),"%"),r(5),d(" ",t.thresholdReached?"Listo para Trigger":"Esperando Pagos"," ")}}function me(l,s){if(l&1&&(e(0,"div",87)(1,"div",80),g(2,"div",88),e(3,"h3",63),n(4),i(),e(5,"span",89),n(6," Tanda Colectiva "),i()(),e(7,"div",83)(8,"div")(9,"p",66),n(10,"Miembros Activos"),i(),e(11,"p",67),n(12),i()(),e(13,"div")(14,"p",66),n(15,"Meses Colectando"),i(),e(16,"p",67),n(17),i()(),e(18,"div")(19,"p",66),n(20,"Total Colectado"),i(),e(21,"p",67),n(22),E(23,"number"),i()(),e(24,"div")(25,"p",66),n(26,"Confianza"),i(),e(27,"p",67),n(28),i()()(),e(29,"div",90)(30,"div",91)(31,"div",7),g(32,"div"),e(33,"span"),n(34),i()(),e(35,"div",7),g(36,"div"),e(37,"span"),n(38),i()(),e(39,"div",7),g(40,"div"),e(41,"span"),n(42),i()()()()()),l&2){let t=s.$implicit;r(4),u(t.groupName),r(8),u(t.activeMembersCount),r(5),u(t.monthsCollecting),r(5),d("$",y(23,14,t.totalCollected,"1.2-2"),""),r(6),d("",(t.confidenceLevel*100).toFixed(1),"%"),r(4),x(t.meetsMinimumMembers?"w-2 h-2 bg-green-500 rounded-full":"w-2 h-2 bg-red-500 rounded-full"),r(2),d("",t.meetsMinimumMembers?"\u2713":"\u2717"," M\xEDn. 5 miembros"),r(2),x(t.meetsMinimumDuration?"w-2 h-2 bg-green-500 rounded-full":"w-2 h-2 bg-red-500 rounded-full"),r(2),d("",t.meetsMinimumDuration?"\u2713":"\u2717"," M\xEDn. 1 mes"),r(2),x(t.meetsThreshold?"w-2 h-2 bg-green-500 rounded-full":"w-2 h-2 bg-red-500 rounded-full"),r(2),d("",t.meetsThreshold?"\u2713":"\u2717"," Umbral 50%")}}function ge(l,s){l&1&&(e(0,"div",73),_(),e(1,"svg",74),g(2,"path",24),i(),S(),e(3,"p",76),n(4,"No hay an\xE1lisis pendientes"),i()())}function pe(l,s){if(l&1&&(e(0,"div",57),h(1,se,35,17,"div",77)(2,me,43,17,"div",78)(3,ge,5,0,"div",59),i()),l&2){let t=c();r(),m("ngForOf",t.pendingContracts()),r(),m("ngForOf",t.pendingTandas()),r(),m("ngIf",t.pendingContracts().length===0&&t.pendingTandas().length===0)}}function ce(l,s){if(l&1&&(e(0,"li"),n(1),i()),l&2){let t=c(2).$implicit;r(),d("\u2022 M\xEDnimo ",t.additionalCriteria.minimumMembers," miembros")}}function ue(l,s){if(l&1&&(e(0,"li"),n(1),i()),l&2){let t=c(2).$implicit;r(),d("\u2022 M\xEDnimo ",t.additionalCriteria.minimumDuration," mes(es) de duraci\xF3n")}}function ve(l,s){l&1&&(e(0,"li"),n(1,"\u2022 An\xE1lisis predictivo activado"),i())}function xe(l,s){if(l&1&&(e(0,"div",100)(1,"p",101),n(2,"Criterios Adicionales:"),i(),e(3,"ul",102),h(4,ce,2,1,"li",103)(5,ue,2,1,"li",103)(6,ve,2,0,"li",103),i()()),l&2){let t=c().$implicit;r(4),m("ngIf",t.additionalCriteria.minimumMembers),r(),m("ngIf",t.additionalCriteria.minimumDuration),r(),m("ngIf",t.additionalCriteria.predictiveAnalysis)}}function fe(l,s){if(l&1&&(e(0,"div",14)(1,"div",92)(2,"div")(3,"h3",93),n(4),i(),e(5,"div",94)(6,"span",64),n(7),i(),e(8,"span",82),n(9),i(),e(10,"span",95),n(11),i()(),e(12,"p",66),n(13),i()(),e(14,"div",96),g(15,"div",97),e(16,"span",98),n(17,"Activo"),i()()(),h(18,xe,7,3,"div",99),i()),l&2){let t=s.$implicit,o=c(2);r(4),u(t.description),r(2),x(o.getFlowBadgeClass(t.flow)),r(),d(" ",t.flow," "),r(2),d(" ",t.market," "),r(2),d(" ",t.thresholdPercentage*100,"% umbral "),r(2),u(t.triggerLogic),r(5),m("ngIf",t.additionalCriteria)}}function be(l,s){if(l&1&&(e(0,"div",57),h(1,fe,19,8,"div",58),i()),l&2){let t=c();r(),m("ngForOf",t.triggerRules())}}function he(l,s){if(l&1){let t=C();e(0,"div",104)(1,"div",105)(2,"h3",106),n(3,"Error en Trigger"),i(),e(4,"p",107),n(5),i(),e(6,"div",108)(7,"button",109),f("click",function(){w(t);let a=c();return T(a.showErrorModal=!1)}),n(8," Cerrar "),i()()()()}if(l&2){let t=c();r(5),u(t.selectedErrorMessage)}}var Pe=(()=>{class l{constructor(){this.destroy$=new B,this.contractTriggersService=A(ne),this.router=A(Q),this.loading=b(!1),this.lastUpdate=b(new Date),this.monitoringStatus=b("active"),this.triggerEvents=b([]),this.pendingContracts=b([]),this.pendingTandas=b([]),this.triggerRules=b([]),this.metrics=b(null),this.selectedMarket="",this.selectedFlow="",this.selectedStatus="",this.activeTab="recent",this.showErrorModal=!1,this.selectedErrorMessage="",this.filteredEvents=U(()=>{let t=this.triggerEvents();return this.selectedMarket&&(t=t.filter(o=>this.getEventMarket(o)===this.selectedMarket)),this.selectedFlow&&(t=t.filter(o=>this.getEventFlow(o)===this.selectedFlow)),this.selectedStatus&&(this.selectedStatus==="success"?t=t.filter(o=>o.deliveryOrderCreated&&!o.errorMessage):this.selectedStatus==="error"?t=t.filter(o=>!o.deliveryOrderCreated||o.errorMessage):this.selectedStatus==="pending"&&(t=t.filter(o=>!o.deliveryOrderCreated&&!o.errorMessage))),t.sort((o,a)=>new Date(a.triggerDate).getTime()-new Date(o.triggerDate).getTime())})}ngOnInit(){this.loadInitialData(),this.startAutoRefresh()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadInitialData(){this.loading.set(!0),Promise.all([this.contractTriggersService.getTriggerHistory(100).toPromise(),this.contractTriggersService.getTriggerMetrics().toPromise()]).then(([t,o])=>{this.triggerEvents.set(t||[]),this.metrics.set(o),this.triggerRules.set(this.contractTriggersService.getTriggerRules()),this.lastUpdate.set(new Date)}).catch(t=>{console.error("Error loading initial data:",t)}).finally(()=>{this.loading.set(!1)}),this.loadPendingAnalysis()}loadPendingAnalysis(){this.pendingContracts.set([]),this.pendingTandas.set([])}startAutoRefresh(){R(3e4).pipe(D(this.destroy$),P(()=>this.contractTriggersService.getTriggerHistory(50)),H(t=>(console.error("Error in auto-refresh:",t),j([])))).subscribe(t=>{this.triggerEvents.set(t),this.lastUpdate.set(new Date)})}forceRefresh(){this.loading.set(!0),this.contractTriggersService.forceProcessTriggers().pipe(D(this.destroy$),P(()=>this.contractTriggersService.getTriggerHistory(100))).subscribe({next:t=>{this.triggerEvents.set(t),this.lastUpdate.set(new Date),this.loading.set(!1)},error:t=>{console.error("Error in force refresh:",t),this.loading.set(!1)}})}applyFilters(){}viewDeliveryOrder(t){this.router.navigate(["/ops/deliveries",t])}viewError(t){this.selectedErrorMessage=t.errorMessage||"Error desconocido",this.showErrorModal=!0}getEventStatusClass(t){return t.deliveryOrderCreated&&!t.errorMessage?"w-3 h-3 bg-green-400 rounded-full":t.errorMessage?"w-3 h-3 bg-red-400 rounded-full":"w-3 h-3 bg-orange-400 rounded-full"}getEventTitle(t){return t.contractId?`Contrato ${t.contractId.substring(0,8)}...`:t.tandaId?`Tanda ${t.tandaId.substring(0,8)}...`:"Trigger Desconocido"}getEventFlow(t){return this.triggerRules().find(a=>a.id===t.triggerRuleId)?.flow||M.VentaDirecta}getEventMarket(t){return this.triggerRules().find(a=>a.id===t.triggerRuleId)?.market||"aguascalientes"}getFlowBadgeClass(t){switch(t){case M.VentaDirecta:return"bg-blue-100 text-blue-800";case M.VentaPlazo:return"bg-green-100 text-green-800";case M.AhorroProgramado:return"bg-purple-100 text-purple-800";case M.CreditoColectivo:return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}}static{this.\u0275fac=function(o){return new(o||l)}}static{this.\u0275cmp=$({type:l,selectors:[["app-triggers-monitor"]],standalone:!0,features:[N],decls:120,vars:31,consts:[[1,"min-h-screen","bg-gray-50","p-6"],[1,"mb-8"],[1,"flex","flex-col","lg:flex-row","lg:items-center","lg:justify-between"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"flex","items-center","gap-4","mt-4","lg:mt-0"],[1,"flex","items-center","gap-2","px-4","py-2","bg-white","rounded-lg","shadow-sm","border"],[1,"flex","items-center","gap-2"],[1,"text-sm","font-medium"],[1,"text-sm","text-gray-500"],[1,"px-4","py-2","bg-blue-600","text-white","rounded-lg","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6","mb-8"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-gray-600","mb-1"],[1,"text-2xl","font-bold","text-gray-900"],[1,"p-3","bg-blue-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"text-2xl","font-bold","text-green-600"],[1,"p-3","bg-green-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-2xl","font-bold","text-red-600"],[1,"p-3","bg-red-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-2xl","font-bold","text-orange-600"],[1,"p-3","bg-orange-100","rounded-lg"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-orange-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","mb-8"],[1,"flex","flex-wrap","gap-4"],[1,"text-sm","font-medium","text-gray-700"],[1,"px-3","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["value",""],["value","aguascalientes"],["value","edomex"],["value","Venta Directa"],["value","Venta a Plazo"],["value","Plan de Ahorro"],["value","Cr\xE9dito Colectivo"],["value","success"],["value","error"],["value","pending"],[1,"mb-6"],[1,"border-b","border-gray-200"],[1,"-mb-px","flex","space-x-8"],[3,"click"],[1,"ml-2","py-0.5","px-2","bg-gray-100","rounded-full","text-xs"],[1,"ml-2","py-0.5","px-2","bg-orange-100","rounded-full","text-xs"],[1,"ml-2","py-0.5","px-2","bg-blue-100","rounded-full","text-xs"],[1,"space-y-6"],["class","space-y-4",4,"ngIf"],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",4,"ngIf"],[1,"space-y-4"],["class","bg-white p-6 rounded-xl shadow-sm border",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","gap-3","mb-3"],[1,"font-semibold","text-gray-900"],[1,"px-2","py-1","text-xs","font-medium","rounded-full"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-4"],[1,"text-sm","text-gray-600"],[1,"font-medium"],[1,"flex","items-center","gap-4"],["class","px-3 py-1 text-sm bg-blue-100 text-blue-700 hover:bg-blue-200 rounded-lg",3,"click",4,"ngIf"],["class","px-3 py-1 text-sm bg-red-100 text-red-700 hover:bg-red-200 rounded-lg",3,"click",4,"ngIf"],[1,"px-3","py-1","text-sm","bg-blue-100","text-blue-700","hover:bg-blue-200","rounded-lg",3,"click"],[1,"px-3","py-1","text-sm","bg-red-100","text-red-700","hover:bg-red-200","rounded-lg",3,"click"],[1,"text-center","py-12"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400","mx-auto","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"],[1,"text-gray-500"],["class","bg-white p-6 rounded-xl shadow-sm border border-orange-200",4,"ngFor","ngForOf"],["class","bg-white p-6 rounded-xl shadow-sm border border-purple-200",4,"ngFor","ngForOf"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","border-orange-200"],[1,"flex","items-center","gap-3","mb-4"],[1,"w-3","h-3","bg-orange-400","rounded-full","animate-pulse"],[1,"px-2","py-1","text-xs","font-medium","bg-gray-100","text-gray-700","rounded-full"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4"],[1,"flex-1","bg-gray-200","rounded-full","h-2"],[1,"bg-orange-500","h-2","rounded-full"],[1,"font-medium","text-orange-600"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","border-purple-200"],[1,"w-3","h-3","bg-purple-400","rounded-full","animate-pulse"],[1,"px-2","py-1","text-xs","font-medium","bg-purple-100","text-purple-700","rounded-full"],[1,"mt-4","p-4","bg-purple-50","rounded-lg"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","text-sm"],[1,"flex","items-start","justify-between","mb-4"],[1,"font-semibold","text-gray-900","mb-2"],[1,"flex","items-center","gap-4","mb-2"],[1,"px-2","py-1","text-xs","font-medium","bg-green-100","text-green-700","rounded-full"],[1,"text-right"],[1,"w-3","h-3","bg-green-400","rounded-full"],[1,"text-xs","text-gray-500"],["class","mt-4 p-3 bg-blue-50 rounded-lg",4,"ngIf"],[1,"mt-4","p-3","bg-blue-50","rounded-lg"],[1,"text-sm","font-medium","text-blue-900","mb-1"],[1,"text-sm","text-blue-800","space-y-1"],[4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50"],[1,"bg-white","p-6","rounded-xl","max-w-md","w-full","mx-4"],[1,"text-lg","font-semibold","text-red-900","mb-4"],[1,"text-gray-700","mb-4"],[1,"flex","justify-end"],[1,"px-4","py-2","bg-gray-200","text-gray-800","rounded-lg","hover:bg-gray-300",3,"click"]],template:function(o,a){if(o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),n(5," \u{1F3AF} Monitor de Triggers Autom\xE1ticos "),i(),e(6,"p",4),n(7," Sistema de monitoreo en tiempo real para triggers de \xF3rdenes de entrega "),i()(),e(8,"div",5)(9,"div",6)(10,"div",7),g(11,"div"),e(12,"span",8),n(13),i()()(),e(14,"div",9),n(15),E(16,"date"),i(),e(17,"button",10),f("click",function(){return a.forceRefresh()}),_(),e(18,"svg",11),g(19,"path",12),i(),n(20),i()()()(),S(),e(21,"div",13)(22,"div",14)(23,"div",15)(24,"div")(25,"p",16),n(26,"Total Triggers"),i(),e(27,"p",17),n(28),i()(),e(29,"div",18),_(),e(30,"svg",19),g(31,"path",20),i()()()(),S(),e(32,"div",14)(33,"div",15)(34,"div")(35,"p",16),n(36,"Exitosos"),i(),e(37,"p",21),n(38),i()(),e(39,"div",22),_(),e(40,"svg",23),g(41,"path",24),i()()()(),S(),e(42,"div",14)(43,"div",15)(44,"div")(45,"p",16),n(46,"Fallidos"),i(),e(47,"p",25),n(48),i()(),e(49,"div",26),_(),e(50,"svg",27),g(51,"path",28),i()()()(),S(),e(52,"div",14)(53,"div",15)(54,"div")(55,"p",16),n(56,"Pendientes"),i(),e(57,"p",29),n(58),i()(),e(59,"div",30),_(),e(60,"svg",31),g(61,"path",32),i()()()()(),S(),e(62,"div",33)(63,"div",34)(64,"div",7)(65,"label",35),n(66,"Mercado:"),i(),e(67,"select",36),F("ngModelChange",function(v){return k(a.selectedMarket,v)||(a.selectedMarket=v),v}),f("ngModelChange",function(){return a.applyFilters()}),e(68,"option",37),n(69,"Todos"),i(),e(70,"option",38),n(71,"Aguascalientes"),i(),e(72,"option",39),n(73,"Estado de M\xE9xico"),i()()(),e(74,"div",7)(75,"label",35),n(76,"Flujo:"),i(),e(77,"select",36),F("ngModelChange",function(v){return k(a.selectedFlow,v)||(a.selectedFlow=v),v}),f("ngModelChange",function(){return a.applyFilters()}),e(78,"option",37),n(79,"Todos"),i(),e(80,"option",40),n(81,"Venta Directa"),i(),e(82,"option",41),n(83,"Venta a Plazo"),i(),e(84,"option",42),n(85,"Plan de Ahorro"),i(),e(86,"option",43),n(87,"Cr\xE9dito Colectivo"),i()()(),e(88,"div",7)(89,"label",35),n(90,"Estado:"),i(),e(91,"select",36),F("ngModelChange",function(v){return k(a.selectedStatus,v)||(a.selectedStatus=v),v}),f("ngModelChange",function(){return a.applyFilters()}),e(92,"option",37),n(93,"Todos"),i(),e(94,"option",44),n(95,"Exitoso"),i(),e(96,"option",45),n(97,"Error"),i(),e(98,"option",46),n(99,"Pendiente"),i()()()()(),e(100,"div",47)(101,"div",48)(102,"nav",49)(103,"button",50),f("click",function(){return a.activeTab="recent"}),n(104," Triggers Recientes "),e(105,"span",51),n(106),i()(),e(107,"button",50),f("click",function(){return a.activeTab="pending"}),n(108," An\xE1lisis Pendientes "),e(109,"span",52),n(110),i()(),e(111,"button",50),f("click",function(){return a.activeTab="rules"}),n(112," Reglas de Trigger "),e(113,"span",53),n(114),i()()()()(),e(115,"div",54),h(116,de,3,2,"div",55)(117,pe,4,3,"div",55)(118,be,2,1,"div",55),i()(),h(119,he,9,1,"div",56)),o&2){let p,v,V,O;r(11),x(a.monitoringStatus()==="active"?"w-3 h-3 bg-green-400 rounded-full animate-pulse":"w-3 h-3 bg-red-400 rounded-full"),r(2),d(" ",a.monitoringStatus()==="active"?"Monitoreo Activo":"Monitoreo Inactivo"," "),r(2),d(" \xDAltima actualizaci\xF3n: ",y(16,28,a.lastUpdate(),"HH:mm:ss")," "),r(2),m("disabled",a.loading()),r(),L("animate-spin",a.loading()),r(2),d(" ",a.loading()?"Actualizando...":"Actualizar"," "),r(8),u(((p=a.metrics())==null?null:p.totalTriggers)||0),r(10),u(((v=a.metrics())==null?null:v.successfulTriggers)||0),r(10),u(((V=a.metrics())==null?null:V.failedTriggers)||0),r(10),u(((O=a.metrics())==null?null:O.pendingAnalysis)||0),r(9),I("ngModel",a.selectedMarket),r(10),I("ngModel",a.selectedFlow),r(14),I("ngModel",a.selectedStatus),r(12),x(a.activeTab==="recent"?"border-blue-500 text-blue-600 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),r(3),u(a.filteredEvents().length),r(),x(a.activeTab==="pending"?"border-blue-500 text-blue-600 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),r(3),u(a.pendingContracts().length+a.pendingTandas().length),r(),x(a.activeTab==="rules"?"border-blue-500 text-blue-600 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"),r(3),u(a.triggerRules().length),r(2),m("ngIf",a.activeTab==="recent"),r(),m("ngIf",a.activeTab==="pending"),r(),m("ngIf",a.activeTab==="rules"),r(),m("ngIf",a.showErrorModal)}},dependencies:[K,W,G,J,q,ie,ee,te,Z,X,Y],styles:[".animate-pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}"]})}}return l})();export{Pe as TriggersMonitorComponent};
